
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>算法模板 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="算法题.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Chapter1/">
            
                <a href="../Chapter1/">
            
                    
                    安装软件章节
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Chapter1/Gitbook简明安装.html">
            
                <a href="../Chapter1/Gitbook简明安装.html">
            
                    
                    Gitbook简明安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Chapter2/">
            
                <a href="../Chapter2/">
            
                    
                    Java有关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Chapter3/">
            
                <a href="../Chapter3/">
            
                    
                    大数据有关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    面试有关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="算法学习.html">
            
                <a href="算法学习.html">
            
                    
                    算法模板
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="算法题.html">
            
                <a href="算法题.html">
            
                    
                    面试算法题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="面试题.html">
            
                <a href="面试题.html">
            
                    
                    面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >算法模板</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>[TOC]</p>
<h1 id="&#x57FA;&#x7840;&#x7B97;&#x6CD5;">&#x57FA;&#x7840;&#x7B97;&#x6CD5;</h1>
<h2 id="&#x8FDB;&#x5236;&#x8F6C;&#x5316;">&#x8FDB;&#x5236;&#x8F6C;&#x5316;</h2>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-built_in">string</span> s, <span class="hljs-keyword">int</span> b)</span>  <span class="hljs-comment">// &#x5C06;b&#x8FDB;&#x5236;&#x7684;&#x6570;&#x8F6C;&#x5316;&#x6210;&#x5341;&#x8FDB;&#x5236;</span>
</span>{
    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// &#x79E6;&#x4E5D;&#x97F6;&#x7B97;&#x6CD5;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> c: s)
        res = res * b + c - <span class="hljs-string">&apos;0&apos;</span>;
    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h2 id="&#x6392;&#x5E8F;">&#x6392;&#x5E8F;</h2>
<h3 id="&#x5FEB;&#x901F;&#x6392;&#x5E8F;">&#x5FEB;&#x901F;&#x6392;&#x5E8F;</h3>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[], <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span>
</span>{
    <span class="hljs-keyword">if</span> (l &gt;= r) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">int</span> i = l - <span class="hljs-number">1</span>, j = r + <span class="hljs-number">1</span>, x = q[ l + r &gt;&gt; <span class="hljs-number">1</span>];
    <span class="hljs-keyword">while</span> (i &lt; j)
    {
        <span class="hljs-keyword">do</span> i ++ ; <span class="hljs-keyword">while</span> (q[i] &lt; x);
        <span class="hljs-keyword">do</span> j -- ; <span class="hljs-keyword">while</span> (q[j] &gt; x);
        <span class="hljs-keyword">if</span> (i &lt; j) swap(q[i], q[j]);
    }
    quick_sort(q, l, j), quick_sort(q, j + <span class="hljs-number">1</span>, r);
}
</code></pre>
<h3 id="&#x5F52;&#x5E76;&#x6392;&#x5E8F;">&#x5F52;&#x5E76;&#x6392;&#x5E8F;</h3>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">merge_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[], <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span>
</span>{
    <span class="hljs-keyword">if</span> (l &gt;= r) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;
    merge_sort(q, l, mid);
    merge_sort(q, mid + <span class="hljs-number">1</span>, r);

    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>, i = l, j = mid + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= r)
        <span class="hljs-keyword">if</span> (q[i] &lt;= q[j]) tmp[k ++ ] = q[i ++ ];
        <span class="hljs-keyword">else</span> tmp[k ++ ] = q[j ++ ];

    <span class="hljs-keyword">while</span> (i &lt;= mid) tmp[k ++ ] = q[i ++ ];
    <span class="hljs-keyword">while</span> (j &lt;= r) tmp[k ++ ] = q[j ++ ];

    <span class="hljs-keyword">for</span> (i = l, j = <span class="hljs-number">0</span>; i &lt;= r; i ++, j ++ ) q[i] = tmp[j];
}
</code></pre>
<h2 id="&#x4E8C;&#x5206;">&#x4E8C;&#x5206;</h2>
<h3 id="&#x6574;&#x6570;&#x4E8C;&#x5206;">&#x6574;&#x6570;&#x4E8C;&#x5206;</h3>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{<span class="hljs-comment">/* ... */</span>} <span class="hljs-comment">// &#x68C0;&#x67E5;x&#x662F;&#x5426;&#x6EE1;&#x8DB3;&#x67D0;&#x79CD;&#x6027;&#x8D28;</span>
<span class="hljs-comment">// &#x533A;&#x95F4;[l, r]&#x88AB;&#x5212;&#x5206;&#x6210;[l, mid - 1]&#x548C;[mid, r]&#x65F6;&#x4F7F;&#x7528;&#xFF1A;</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bsearch_2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span>
</span>{
    <span class="hljs-keyword">while</span> (l &lt; r)
    {
        <span class="hljs-keyword">int</span> mid = l + r + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (check(mid)) l = mid;
        <span class="hljs-keyword">else</span> r = mid - <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> l;
}
<span class="hljs-comment">// &#x533A;&#x95F4;[l, r]&#x88AB;&#x5212;&#x5206;&#x6210;[l, mid]&#x548C;[mid + 1, r]&#x65F6;&#x4F7F;&#x7528;&#xFF1A;</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bsearch_1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span>
</span>{
    <span class="hljs-keyword">while</span> (l &lt; r)
    {
        <span class="hljs-keyword">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (check(mid)) r = mid;    <span class="hljs-comment">// check()&#x5224;&#x65AD;mid&#x662F;&#x5426;&#x6EE1;&#x8DB3;&#x6027;&#x8D28;</span>
        <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> l;
}
</code></pre>
<h3 id="&#x6D6E;&#x70B9;&#x6570;&#x4E8C;&#x5206;">&#x6D6E;&#x70B9;&#x6570;&#x4E8C;&#x5206;</h3>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-keyword">double</span> x)</span> </span>{<span class="hljs-comment">/* ... */</span>} <span class="hljs-comment">// &#x68C0;&#x67E5;x&#x662F;&#x5426;&#x6EE1;&#x8DB3;&#x67D0;&#x79CD;&#x6027;&#x8D28;</span>
<span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">bsearch_3</span><span class="hljs-params">(<span class="hljs-keyword">double</span> l, <span class="hljs-keyword">double</span> r)</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> eps = <span class="hljs-number">1e-6</span>;   <span class="hljs-comment">// eps &#x8868;&#x793A;&#x7CBE;&#x5EA6;&#xFF0C;&#x4E00;&#x822C;&#x9898;&#x76EE;&#x8981;&#x6C42;&#x662F;1e-6&#x65F6;&#xFF0C;eps&#x662F;1e-8</span>
    <span class="hljs-keyword">while</span> (r - l &gt; eps)
    {
        <span class="hljs-keyword">double</span> mid = (l + r) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">if</span> (check(mid)) r = mid;
        <span class="hljs-keyword">else</span> l = mid;
    }
    <span class="hljs-keyword">return</span> l;
}
</code></pre>
<h2 id="&#x524D;&#x7F00;&#x548C;&#x4E0E;&#x5DEE;&#x5206;">&#x524D;&#x7F00;&#x548C;&#x4E0E;&#x5DEE;&#x5206;</h2>
<h3 id="&#x4E00;&#x7EF4;&#x524D;&#x7F00;&#x548C;">&#x4E00;&#x7EF4;&#x524D;&#x7F00;&#x548C;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100060</span>;
<span class="hljs-keyword">int</span> n, m, l, r, a[N], b[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
        b[i] = b[i - <span class="hljs-number">1</span>] + a[i];
    }
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r;
        <span class="hljs-built_in">cout</span> &lt;&lt; b[r] - b[l - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
}
</code></pre>
<h3 id="&#x4E8C;&#x7EF4;&#x524D;&#x7F00;&#x548C;">&#x4E8C;&#x7EF4;&#x524D;&#x7F00;&#x548C;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1005</span>;
<span class="hljs-keyword">int</span> a[N][N], b[N][N];
<span class="hljs-keyword">int</span> n, m, q;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++) {
            <span class="hljs-built_in">cin</span> &gt;&gt; a[i][j];
            b[i][j] = b[i][j - <span class="hljs-number">1</span>] + b[i - <span class="hljs-number">1</span>][j] - b[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + a[i][j];
        }
    }
    <span class="hljs-keyword">while</span> (q--) {
        <span class="hljs-keyword">int</span> x1, y1, x2, y2;
        <span class="hljs-built_in">cin</span> &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;
        <span class="hljs-built_in">cout</span> &lt;&lt; b[x2][y2] - b[x2][y1 - <span class="hljs-number">1</span>] - b[x1 - <span class="hljs-number">1</span>][y2] + b[x1 - <span class="hljs-number">1</span>][y1 - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
}
</code></pre>
<h3 id="&#x4E00;&#x7EF4;&#x5DEE;&#x5206;">&#x4E00;&#x7EF4;&#x5DEE;&#x5206;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;
<span class="hljs-keyword">int</span> n, m, a[N], b[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
        b[i] = a[i] - a[i - <span class="hljs-number">1</span>];
    }
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-keyword">int</span> l, r, x;
        <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;
        b[l] += x, b[r + <span class="hljs-number">1</span>] -= x;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        a[i] = a[i - <span class="hljs-number">1</span>] + b[i];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cout</span> &lt;&lt; a[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }
}
</code></pre>
<h3 id="&#x4E8C;&#x7EF4;&#x5DEE;&#x5206;">&#x4E8C;&#x7EF4;&#x5DEE;&#x5206;</h3>
<pre><code class="lang-c++"><span class="hljs-comment">/*
a[][]&#x662F;&#x5DEE;&#x5206;&#x77E9;&#x9635;&#xFF0C;&#x5BF9;&#x5DEE;&#x5206;&#x77E9;&#x9635;&#x6C42;&#x524D;&#x7F00;&#x548C;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x539F;&#x6570;&#x7EC4;&#xFF0C;&#x8FD9;&#x548C;&#x4E00;&#x7EF4;&#x662F;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x7684;
&#x4E0D;&#x540C;&#x4E8E;&#x4E00;&#x7EF4;&#x5DEE;&#x5206;&#x7684;&#x662F;&#xFF0C;&#x4E8C;&#x7EF4;&#x5DEE;&#x5206;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x56DB;&#x4E2A;&#x70B9;
a[x1][y1]+=d;&#x8FDB;&#x884C;&#x6C42;&#x524D;&#x7F00;&#x548C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x4F1A;&#x8BA9;&#x6240;&#x6709;x1,y1&#x4E4B;&#x540E;&#x6C42;&#x7684;&#x70B9;&#x90FD;&#x6539;&#x53D8;
&#x6240;&#x4EE5;&#x8981;&#x8FDB;&#x884C;&#x4E09;&#x4E2A;&#x64CD;&#x4F5C;&#x62B5;&#x6D88;
a[x2+1][y1]-=d,a[x1][y2+1]-=d,a[x2+1][y2+1]+=d;
insert&#x51FD;&#x6570;&#x4FBF;&#x8BDE;&#x751F;&#x4E86;
&#x6700;&#x7EC8;&#x7684;&#x6570;&#x7EC4;&#x5BF9;&#x5DEE;&#x5206;&#x6570;&#x7EC4;&#x6C42;&#x4E8C;&#x7EF4;&#x524D;&#x7F00;&#x548C;&#x5C31;&#x884C;
*/</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1005</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> n, m, q;
<span class="hljs-keyword">int</span> a[N][N], b[N][N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x1, <span class="hljs-keyword">int</span> y1, <span class="hljs-keyword">int</span> x2, <span class="hljs-keyword">int</span> y2, <span class="hljs-keyword">int</span> d)</span> </span>{
    a[x1][y1] += d;
    a[x2 + <span class="hljs-number">1</span>][y1] -= d;
    a[x1][y2 + <span class="hljs-number">1</span>] -= d;
    a[x2 + <span class="hljs-number">1</span>][y2 + <span class="hljs-number">1</span>] += d;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++) {
            <span class="hljs-keyword">int</span> x;
            <span class="hljs-built_in">cin</span> &gt;&gt; x;
            insert(i, j, i, j, x);<span class="hljs-comment">//&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x5728;&#x4E00;&#x4E2A;&#x5C0F;&#x533A;&#x95F4;&#x8FDB;&#x884C;insert</span>
        }
    }
    <span class="hljs-keyword">while</span> (q--) {
        <span class="hljs-keyword">int</span> x1, y1, x2, y2, d;
        <span class="hljs-built_in">cin</span> &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2 &gt;&gt; d;
        insert(x1, y1, x2, y2, d);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++) {
            b[i][j] = b[i - <span class="hljs-number">1</span>][j] + b[i][j - <span class="hljs-number">1</span>] - b[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + a[i][j];<span class="hljs-comment">//&#x4E8C;&#x7EF4;&#x524D;&#x7F00;&#x548C;</span>
        }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j++) {
            <span class="hljs-built_in">cout</span> &lt;&lt; b[i][j] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
        }
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x9AD8;&#x7CBE;&#x5EA6;">&#x9AD8;&#x7CBE;&#x5EA6;</h2>
<h3 id="&#x52A0;&#x6CD5;">&#x52A0;&#x6CD5;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; add(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; B) {
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; C;
    <span class="hljs-keyword">int</span> t = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x8FDB;&#x4F4D;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; A.size() || i &lt; B.size(); i++) {
        <span class="hljs-keyword">if</span> (i &lt; A.size()) t += A[i];
        <span class="hljs-keyword">if</span> (i &lt; B.size()) t += B[i];
        C.push_back(t % <span class="hljs-number">10</span>);
        t /= <span class="hljs-number">10</span>;
    }
    <span class="hljs-keyword">if</span> (t) C.push_back(t);
    <span class="hljs-keyword">return</span> C;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">string</span> a, b;
    <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A, B;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) A.push_back(a[i] - <span class="hljs-string">&apos;0&apos;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) B.push_back(b[i] - <span class="hljs-string">&apos;0&apos;</span>);
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; C = add(A, B);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) <span class="hljs-built_in">cout</span> &lt;&lt; C[i];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x51CF;&#x6CD5;">&#x51CF;&#x6CD5;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; a, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; b)</span><span class="hljs-comment">//&#x6BD4;&#x8F83;&#x5927;&#x5C0F;</span>
</span>{
    <span class="hljs-keyword">if</span> (a.size() != b.size()) <span class="hljs-keyword">return</span> a.size() &gt; b.size();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">if</span> (a[i] != b[i]) <span class="hljs-keyword">return</span> a[i] &gt; b[i];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; sub(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; a, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; b) {
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; c;
    <span class="hljs-keyword">int</span> t = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x501F;&#x4F4D;1</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; a.size(); i++) {
        t = a[i] - t;
        <span class="hljs-keyword">if</span> (i &lt; b.size()) t -= b[i];
        c.push_back((t + <span class="hljs-number">10</span>) % <span class="hljs-number">10</span>);<span class="hljs-comment">//&#x6709;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x8D1F;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x501F;1&#x5F53;10</span>
        <span class="hljs-keyword">if</span> (t &lt; <span class="hljs-number">0</span>) t = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">else</span> t = <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">while</span> (c.size() &gt; <span class="hljs-number">1</span> &amp;&amp; c.back() == <span class="hljs-number">0</span>) c.pop_back();<span class="hljs-comment">//&#x53BB;&#x9664;&#x524D;&#x5BFC;0</span>
    <span class="hljs-keyword">return</span> c;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A, B, C;
    <span class="hljs-built_in">string</span> a, b;
    <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) A.push_back(a[i] - <span class="hljs-string">&apos;0&apos;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) B.push_back(b[i] - <span class="hljs-string">&apos;0&apos;</span>);
    <span class="hljs-keyword">if</span> (cmp(A, B)) C = sub(A, B);
    <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;-&quot;</span>;
        C = sub(B, A);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) <span class="hljs-built_in">cout</span> &lt;&lt; C[i];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x4E58;&#x6CD5;">&#x4E58;&#x6CD5;</h3>
<p>&#x5927;&#x6570;&#x4E58;&#x5C0F;&#x6570;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; mul(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A, <span class="hljs-keyword">int</span> b) {
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; c;
    <span class="hljs-keyword">int</span> t = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x8FDB;&#x4F4D;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; A.size(); i++) {
        t = A[i] * b + t;
        c.push_back(t % <span class="hljs-number">10</span>);
        t /= <span class="hljs-number">10</span>;
    }
    <span class="hljs-keyword">while</span> (t) {
        c.push_back(t % <span class="hljs-number">10</span>);
        t /= <span class="hljs-number">10</span>;
    }
    <span class="hljs-keyword">while</span> (c.size() &gt; <span class="hljs-number">1</span> &amp;&amp; c.back() == <span class="hljs-number">0</span>) c.pop_back();
    <span class="hljs-keyword">return</span> c;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">string</span> a;
    <span class="hljs-keyword">int</span> b;
    <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) A.push_back(a[i] - <span class="hljs-string">&apos;0&apos;</span>);
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; c = mul(A, b);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = c.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) <span class="hljs-built_in">cout</span> &lt;&lt; c[i];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x9664;&#x6CD5;">&#x9664;&#x6CD5;</h3>
<p>&#x5927;&#x6570;&#x9664;&#x5C0F;&#x6570;&#xFF0C;&#x5148;&#x8F93;&#x51FA;&#x5546;&#xFF0C;&#x5728;&#x8F93;&#x51FA;&#x4F59;&#x6570;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; div(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, <span class="hljs-keyword">int</span> B, <span class="hljs-keyword">int</span> &amp;r) {<span class="hljs-comment">//r&#x4F20;&#x5165;r&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4FBF;&#x4E8E;&#x76F4;&#x63A5;&#x5BF9;&#x4F59;&#x6570;r&#x8FDB;&#x884C;&#x4FEE;&#x6539;</span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; C;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; A.size(); i++) {<span class="hljs-comment">//&#x5BF9;A&#x4ECE;&#x6700;&#x9AD8;&#x4F4D;&#x5F00;&#x59CB;&#x5904;&#x7406;</span>
        r = r * <span class="hljs-number">10</span> + A[i];<span class="hljs-comment">//&#x5C06;&#x4E0A;&#x6B21;&#x7684;&#x4F59;&#x6570;*10&#x5728;&#x52A0;&#x4E0A;&#x5F53;&#x524D;&#x4F4D;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x4FBF;&#x662F;&#x8BE5;&#x4F4D;&#x9700;&#x8981;&#x9664;&#x7684;&#x88AB;&#x9664;&#x6570;</span>
        C.push_back(r / B);<span class="hljs-comment">//&#x6240;&#x5F97;&#x5373;&#x4E3A;&#x5546;&#x5728;&#x8FD9;&#x4E00;&#x4F4D;&#x7684;&#x6570;&#x5B57;</span>
        r = r % B;
    }
    <span class="hljs-comment">//&#x7531;&#x4E8E;&#x5728;&#x9664;&#x6CD5;&#x8FD0;&#x7B97;&#x4E2D;&#xFF0C;&#x9AD8;&#x4F4D;&#x5230;&#x4F4E;&#x4F4D;&#x8FD0;&#x7B97;&#xFF0C;&#x56E0;&#x6B64;C&#x7684;&#x524D;&#x5BFC;&#x96F6;&#x90FD;&#x5728;vector&#x7684;&#x524D;&#x9762;&#x800C;&#x4E0D;&#x662F;&#x5C3E;&#x90E8;</span>
    <span class="hljs-comment">//vector&#x53EA;&#x6709;&#x5220;&#x9664;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6570;&#x5B57;pop_back&#x662F;&#x5E38;&#x6570;&#x590D;&#x6742;&#x5EA6;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;&#x5220;&#x9664;&#x7B2C;&#x4E00;&#x4F4D;&#x6CA1;&#x6709;&#x76F8;&#x5E94;</span>
    <span class="hljs-comment">//&#x7684;&#x5E93;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF0C;&#x800C;&#x4E14;&#x5220;&#x9664;&#x7B2C;&#x4E00;&#x4F4D;&#xFF0C;&#x5176;&#x4F59;&#x4F4D;&#x4E5F;&#x8981;&#x524D;&#x79FB;&#xFF0C;</span>
    <span class="hljs-comment">//&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5C06;C&#x7FFB;&#x8F6C;&#xFF0C;&#x8FD9;&#x6837;0&#x5C31;&#x4F4D;&#x4E8E;&#x6570;&#x7EC4;&#x5C3E;&#x90E8;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;pop&#x51FD;&#x6570;&#x5220;&#x9664;&#x524D;&#x5BFC;0</span>
    reverse(C.begin(), C.end());
    <span class="hljs-keyword">while</span> (C.size() &gt; <span class="hljs-number">1</span> &amp;&amp; C.back() == <span class="hljs-number">0</span>) C.pop_back();
    <span class="hljs-keyword">return</span> C;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">string</span> a;
    <span class="hljs-keyword">int</span> B, r = <span class="hljs-number">0</span>; <span class="hljs-comment">//&#x4EE3;&#x8868;&#x4F59;&#x6570;</span>
    <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; B;
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; A;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; a.size(); i++) A.push_back(a[i] - <span class="hljs-string">&apos;0&apos;</span>);<span class="hljs-comment">//&#x6CE8;&#x610F;&#x8FD9;&#x6B21;&#x7684;A&#x662F;&#x7531;&#x9AD8;&#x4E3A;&#x4F20;&#x8F93;&#x81F3;&#x4F4E;&#x4F4D;&#xFF0C;</span>
    <span class="hljs-comment">//&#x7531;&#x4E8E;&#x5728;&#x9664;&#x6CD5;&#x7684;&#x624B;&#x7B97;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x73B0;&#x4ECE;&#x9AD8;&#x4F4D;&#x8FDB;&#x884C;&#x5904;&#x7406;</span>
    <span class="hljs-comment">//for(int i=0;i&lt;A.size();i++) cout&lt;&lt;A[i];</span>
    <span class="hljs-comment">//cout&lt;&lt;B;</span>
    <span class="hljs-keyword">auto</span> C = div(A, B, r);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.size() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) <span class="hljs-built_in">cout</span> &lt;&lt; C[i];<span class="hljs-comment">//&#x5C06;C&#x4ECE;&#x6700;&#x9AD8;&#x4F4D;&#x4F20;&#x7ED9;&#x6700;&#x4F4E;&#x4F4D;</span>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span> &lt;&lt; r;<span class="hljs-comment">//&#x8F93;&#x51FA;&#x4F59;&#x6570;</span>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x79BB;&#x6563;&#x5316;">&#x79BB;&#x6563;&#x5316;</h2>
<p>&#x79BB;&#x6563;&#x5316;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6392;&#x5E8F;+&#x53BB;&#x91CD;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x503C;&#x6620;&#x5C04;&#x6210;[0,n-1]&#x6216;&#x8005;[1,n]&#xFF0C;&#x6CE8;&#x610F;&#x6B64;&#x65F6;&#x7684;n&#x662F;&#x53BB;&#x91CD;&#x540E;&#x7684;n&#x3002;</p>
<p>&#x6620;&#x5C04;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x628A;&#x503C;&#x653E;&#x5165;&#x6570;&#x7EC4;&#xFF08;vector&#xFF09;&#x4E2D;&#xFF0C;&#x4E0B;&#x6807;&#x5C31;&#x662F;&#x6570;&#x7EC4;&#x4E0B;&#x6807;&#x3002;</p>
<p>alls&#x8868;&#x793A;&#x6240;&#x6709;&#x5F85;&#x79BB;&#x6563;&#x5316;&#x7684;&#x6570;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x5904;&#x7406;&#x79BB;&#x6563;&#x5316;&#x95EE;&#x9898;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5F80;&#x5F80;&#x9700;&#x8981;&#x5148;&#x628A;&#x6240;&#x6709;&#x7528;&#x5230;&#x7684;&#x5750;&#x6807;&#x5B58;&#x8D77;&#x6765;&#x5E76;&#x4E14;&#x79BB;&#x6563;&#x5316;&#xFF0C;&#x4E4B;&#x540E;&#x5728;&#x8FDB;&#x884C;&#x5404;&#x79CD;&#x64CD;&#x4F5C;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; PII;
<span class="hljs-built_in">vector</span>&lt;PII&gt; add, query;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; alls;
<span class="hljs-keyword">int</span> a[<span class="hljs-number">300010</span>], b[<span class="hljs-number">300010</span>];<span class="hljs-comment">//&#x6700;&#x591A;&#x8FD9;&#x4E48;&#x591A;&#x4E0B;&#x6807;</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>, r = alls.size() - <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x56E0;&#x4E3A;&#x5C31;&#x662F;&#x5B58;&#x5728;vector&#x91CC;&#x9762;</span>
    <span class="hljs-keyword">while</span> (l &lt; r) {
        <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (alls[mid] &gt;= x) r = mid;
        <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> l + <span class="hljs-number">1</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-keyword">int</span> n, m;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x, c;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; c;
        add.push_back({x, c});
        alls.push_back(x);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> l, r;
        <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r;
        query.push_back({l, r});
        alls.push_back(l), alls.push_back(r);
    }
    sort(alls.begin(), alls.end());
    alls.erase(unique(alls.begin(), alls.end()), alls.end());
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; add.size(); i++) {
        <span class="hljs-keyword">int</span> x = find(add[i].first), c = add[i].second;
        a[x] += c;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= alls.size(); i++) {
        b[i] = b[i - <span class="hljs-number">1</span>] + a[i];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; query.size(); i++) {
        <span class="hljs-keyword">int</span> l = find(query[i].first), r = find(query[i].second);
        <span class="hljs-built_in">cout</span> &lt;&lt; b[r] - b[l - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x8BFB;&#x5165;">&#x8BFB;&#x5165;</h2>
<pre><code class="lang-c++"><span class="hljs-built_in">string</span> s;
getline(<span class="hljs-built_in">cin</span>,s);<span class="hljs-comment">//&#x7A7A;&#x683C;&#x4E0D;&#x65AD;&#x884C;&#x8F93;&#x5165;</span>
<span class="hljs-function"><span class="hljs-built_in">stringstream</span> <span class="hljs-title">ss</span><span class="hljs-params">(s)</span></span>;
<span class="hljs-keyword">int</span> x;<span class="hljs-comment">//&#x4E5F;&#x53EF;&#x4EE5;&#x6539;&#x4E3A;string,double,char;</span>
<span class="hljs-keyword">while</span>(ss &gt;&gt; x) <span class="hljs-built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="hljs-built_in">endl</span>;

<span class="hljs-comment">//&#x6CE8;&#x610F;&#x4F7F;&#x7528;getline()&#x4E4B;&#x524D;&#xFF0C;&#x82E5;&#x4F7F;&#x7528;&#x4E86;cin/scanf,&#x5FC5;&#x987B;&#x8981;getchar()&#x4E00;&#x6B21;&#xFF0C;&#x8FC7;&#x6EE4;&#x6389;&#x6362;&#x884C;&#x7B26;&#xFF0C;&#x4E00;&#x6B21;&#x5C31;&#x884C;&#xFF0C;&#x591A;&#x6B21;getline()&#x4E4B;&#x95F4;&#x4E0D;&#x9700;&#x8981;getchar()</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> a;
    <span class="hljs-built_in">cin</span> &gt;&gt; a;
    getchar();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
        <span class="hljs-built_in">string</span> s;
        getline(<span class="hljs-built_in">cin</span>, s);
        <span class="hljs-built_in">cout</span> &lt;&lt; s &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">//cin.get()&#x4E0D;&#x540C;&#x4E8E;getline()&#x5E94;&#x8BE5;&#x5728;&#x6BCF;&#x6B21;&#x8BFB;&#x5165;&#x540E;&#x90FD;getchar()&#x4E00;&#x6B21;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> a;
    <span class="hljs-built_in">cin</span> &gt;&gt; a;
    getchar();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
        <span class="hljs-keyword">char</span> s[<span class="hljs-number">105</span>];
        <span class="hljs-built_in">cin</span>.get(s, <span class="hljs-number">105</span>);
        getchar();
        <span class="hljs-built_in">cout</span> &lt;&lt; s &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x77E9;&#x9635;">&#x77E9;&#x9635;</h2>
<pre><code class="lang-c++">#include &lt;bits/stdc++.h&gt;
#define CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)
#define endl &quot;\n&quot;
typedef long long LL;
const int N = 1e5 + 10, M = N, mod = 1e9 + 7;
using namespace std;
struct Mat{
    int a[105][105];
    int r, c;
    Mat(int _r, int _c){
        r = _r, c = _c;
        memset(a, 0, sizeof a);
    }
    //&#x5355;&#x4F4D;&#x77E9;&#x9635;
    void unit(){
        memset(a, 0, sizeof a);
        for(int i = 1; i &lt;= r; i ++){
            a[i][i] = 1;
        }
    }
    Mat operator+(const Mat t) const{
        Mat ans = *this;
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                ans.a[i][j] += t.a[i][j];
            }
        }
        return ans;
    }
    Mat operator-(const Mat t) const{
        Mat ans = *this;
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                ans.a[i][j] -= t.a[i][j];
            }
        }
        return ans;
    }
    Mat operator*(const Mat t) const{
        Mat ans(r, t.c);
        int n = r, m = t.c;
        for(int i = 1; i &lt;= n; i ++){
            for(int j = 1; j &lt;= m; j ++){
                for(int k = 1; k &lt;= c; k ++){
                    ans.a[i][j] += a[i][k] * t.a[k][j];
                    ans.a[i][j] %= mod;
                }
            }
        }
        return ans;
    }
    Mat pow(LL b){
        Mat ans(r, c), _a = *this;
        ans.unit();
        while(b){
            if(b &amp; 1) ans = ans * _a;
            _a = _a * _a;
            b &gt;&gt;= 1;
        }
        return ans;
    }
    void output(){
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                cout &lt;&lt; a[i][j] &lt;&lt; &quot; &quot;;
            }
            cout &lt;&lt; endl;
        }
    }
};
int main()
{
    int n1, m1, n2, m2;
    cin &gt;&gt; m1 &gt;&gt; n1 &gt;&gt; m2 &gt;&gt; n2;
    Mat A(n1, m1), B(n2, m2);
    for(int i = 1; i &lt;= n1; i ++){
        for(int j = 1; j &lt;= m1; j ++){
            cin &gt;&gt; A.a[i][j];
        }
    }
    for(int i = 1; i &lt;= n2; i ++){
        for(int j = 1; j &lt;= m2; j ++){
            cin &gt;&gt; B.a[i][j];
        }
    }
    Mat ans = A * B;
    ans.output();
    return 0;
}
</code></pre>
<h2 id="stl">STL</h2>
<h3 id="setmultiset">Set/multiset</h3>
<p>set&#x548C;multiset&#x4F1A;&#x6839;&#x636E;&#x7279;&#x5B9A;&#x7684;&#x6392;&#x5E8F;&#x539F;&#x5219;&#x5C06;&#x5143;&#x7D20;&#x6392;&#x5E8F;&#x3002;&#x4E24;&#x8005;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF0C;multisets&#x5141;&#x8BB8;&#x5143;&#x7D20;&#x91CD;&#x590D;&#xFF0C;&#x800C;set&#x4E0D;&#x5141;&#x8BB8;&#x91CD;&#x590D;&#x3002;</p>
<pre><code class="lang-c++">s.insert() <span class="hljs-comment">//log(n)</span>
s.erase() <span class="hljs-comment">//log(n)</span>
s.begin() <span class="hljs-comment">//&#x8FD4;&#x56DE;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x5730;&#x5740;</span>
s.end() <span class="hljs-comment">//&#x8FD4;&#x56DE;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E0B;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x5730;&#x5740;</span>
s.find(x) <span class="hljs-comment">//log(n) &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF08;&#x8FED;&#x4EE3;&#x5668;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5F53;&#x524D;&#x5143;&#x7D20;x&#x8FD4;&#x56DE;s.end()</span>
s.lower_bound(x)<span class="hljs-comment">// log(n) &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&gt;=x&#x7684;&#x5730;&#x5740;&#xFF08;&#x8FED;&#x4EE3;&#x5668;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5F53;&#x524D;&#x5143;&#x7D20;x&#x8FD4;&#x56DE;s.end()</span>
s.upper_bound(x)<span class="hljs-comment">// log(n) &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&gt;x&#x7684;&#x5730;&#x5740;&#xFF08;&#x8FED;&#x4EE3;&#x5668;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5F53;&#x524D;&#x5143;&#x7D20;x&#x8FD4;&#x56DE;s.end()</span>
</code></pre>
<h3 id="&#x4E8C;&#x5206;&#x51FD;&#x6570;">&#x4E8C;&#x5206;&#x51FD;&#x6570;</h3>
<pre><code class="lang-c++">lower_bound(&#x9996;&#x5730;&#x5740;,&#x5C3E;&#x5730;&#x5740;,x)  <span class="hljs-comment">//&#x5DE6;&#x95ED;&#x53F3;&#x5F00;&#xFF0C;&#x67E5;&#x627E;&gt;=x&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x82E5;&#x67E5;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x8FD4;&#x56DE;&#x5C3E;&#x5730;&#x5740;</span>
upper_bound(&#x9996;&#x5730;&#x5740;,&#x5C3E;&#x5730;&#x5740;,x)  <span class="hljs-comment">//&#x5DE6;&#x95ED;&#x53F3;&#x5F00;&#xFF0C;&#x67E5;&#x627E;&gt;x&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6570; &#xFF0C;&#x82E5;&#x67E5;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x8FD4;&#x56DE;&#x5C3E;&#x5730;&#x5740; </span>
<span class="hljs-comment">//&#x6CE8;&#x610F;&#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x5730;&#x5740;&#xFF0C;&#x82E5;&#x8981;&#x53D8;&#x6210;&#x4E0B;&#x6807;&#xFF0C;&#x82E5;&#x662F;&#x6570;&#x7EC4;a&#x53EA;&#x9700;&#x8981;-a,&#x82E5;&#x662F;vector&#x53EA;&#x9700;&#x8981;-v.begin()</span>
</code></pre>
<h1 id="&#x6570;&#x636E;&#x7ED3;&#x6784;">&#x6570;&#x636E;&#x7ED3;&#x6784;</h1>
<h2 id="&#x5B57;&#x7B26;&#x4E32;&#x54C8;&#x5E0C;">&#x5B57;&#x7B26;&#x4E32;&#x54C8;&#x5E0C;</h2>
<p>&#x4E0D;&#x80FD;&#x628A;&#x5B57;&#x7B26;&#x6620;&#x5C04;&#x6210;0&#xFF0C;&#x5426;&#x5219;$A,AA,AAA$&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#x7ECF;&#x9A8C;&#x503C;$P=131$&#xFF0C;&#x6216;&#x8005;$P=13331$&#xFF0C;Q&#x53D6;&#x6210;$2^{64}$,&#x8FD9;&#x6837;&#x51B2;&#x7A81;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x5F88;&#x5C0F;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-comment">/* 
&#x5168;&#x79F0;&#x5B57;&#x7B26;&#x4E32;&#x524D;&#x7F00;&#x54C8;&#x5E0C;&#x6CD5;&#xFF0C;&#x628A;&#x5B57;&#x7B26;&#x4E32;&#x53D8;&#x6210;&#x4E00;&#x4E2A;p&#x8FDB;&#x5236;&#x6570;&#x5B57;&#xFF08;&#x54C8;&#x5E0C;&#x503C;&#xFF09;&#xFF0C;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6620;&#x5C04;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x6570;&#x5B57;&#x3002;
&#x5BF9;&#x5F62;&#x5982; X1X2X3&#x22EF;Xn&#x2212;1XnX1X2X3&#x22EF;Xn&#x2212;1Xn &#x7684;&#x5B57;&#x7B26;&#x4E32;,&#x91C7;&#x7528;&#x5B57;&#x7B26;&#x7684;ascii &#x7801;&#x4E58;&#x4E0A; P &#x7684;&#x6B21;&#x65B9;&#x6765;&#x8BA1;&#x7B97;&#x54C8;&#x5E0C;&#x503C;&#x3002;
&#x6620;&#x5C04;&#x516C;&#x5F0F; (X1&#xD7;Pn&#x2212;1+X2&#xD7;Pn&#x2212;2+&#x22EF;+Xn&#x2212;1&#xD7;P1+Xn&#xD7;P0)modQ  Q&#x4E00;&#x822C;qu&#x516C;&#x5F0F; (X1&#xD7;Pn&#x2212;1+X2&#xD7;Pn&#x2212;2+&#x22EF;+Xn&#x2212;1&#xD7;P1+Xn&#xD7;P0)modQ  Q&#x4E00;&#x822C;
&#x6CE8;&#x610F;
1. &#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x4E0D;&#x53EF;&#x4EE5;&#x6620;&#x5C04;&#x6210;0&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x90FD;&#x6620;&#x5C04;&#x6210;0&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6BD4;&#x5982;A,AA,AAA&#x7686;&#x4E3A;0
2. &#x51B2;&#x7A81;&#x95EE;&#x9898;&#xFF1A;&#x901A;&#x8FC7;&#x5DE7;&#x5999;&#x8BBE;&#x7F6E;P (131 &#x6216; 13331) , Q (2&#x7684;64&#x6B21;&#x65B9;)&#x7684;&#x503C;&#xFF0C;&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E0D;&#x4EA7;&#x751F;&#x51B2;&#x7A81;&#x3002;

&#x516C;&#x5F0F;&#xFF1A;&#x524D;&#x7F00;hash  h[i]=h[i-1]*P+str[i];
      &#x533A;&#x95F4;hash  h[l,r]=h[r]&#x2212;h[l&#x2212;1]&#xD7;P(r&#x2212;l+1)&#x6B21;&#x65B9;
*/</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ULL;<span class="hljs-comment">//&#x4EE3;&#x66FF;&#x5BF9;2&#x7684;64&#x6B21;&#x65B9;&#x53D6;&#x6A21;</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>, P = <span class="hljs-number">131</span>;<span class="hljs-comment">//P&#x4E00;&#x822C;&#x53D6;131&#x6216;&#x8005;13331&#xFF0C;</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
ULL h[N], p[N];<span class="hljs-comment">//h&#x653E;&#x7684;&#x662F;&#x524D;&#x7F00;hash&#x503C;&#xFF0C;p&#x653E;&#x7684;&#x662F;P&#x7684;&#x591A;&#x5C11;&#x6B21;&#x65B9;&#xFF1B;</span>
<span class="hljs-keyword">int</span> l1, r1, l2, r2, n, m;
<span class="hljs-keyword">char</span> str[N];
<span class="hljs-function">ULL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span><span class="hljs-comment">//&#x7C7B;&#x4F3C;&#x4E8E;&#x524D;&#x7F00;&#x548C;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x504F;&#x79FB;&#x91CF;</span>
</span>{
    <span class="hljs-keyword">return</span> h[r] - h[l - <span class="hljs-number">1</span>] * p[r - l + <span class="hljs-number">1</span>];<span class="hljs-comment">//&#x516C;&#x5F0F;</span>
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%s&quot;</span>, &amp;n, &amp;m, str + <span class="hljs-number">1</span>);<span class="hljs-comment">//&#x6CE8;&#x610F;s&#x4ECE;&#x6570;&#x7EC4;&#x7684;&#x7B2C;&#x4E00;&#x4F4D;&#x5F00;&#x59CB;&#x5B58;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x524D;&#x7F00;&#x548C;</span>
    h[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>, p[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x521D;&#x59CB;&#x5316;&#xFF0C;P&#x7684;0&#x6B21;&#x65B9;&#x4E3A;1</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        h[i] = h[i - <span class="hljs-number">1</span>] * P + str[i];<span class="hljs-comment">//&#x8BA1;&#x7B97;&#x524D;&#x7F00;&#x54C8;&#x5E0C;&#xFF0C;&#x7C7B;&#x4F3C;P&#x8FDB;&#x5236;,&#x53EA;&#x8981;&#x4FDD;&#x8BC1;str[i]&#x4E0D;&#x662F;0&#x5C31;&#x884C;</span>
        p[i] = P * p[i - <span class="hljs-number">1</span>];<span class="hljs-comment">//&#x8BA1;&#x7B97;p&#x7684;i&#x6B21;&#x65B9;&#xFF0C;&#x56E0;&#x4E3A;&#x4F1A;&#x7528;&#x5230;&#x4E00;&#x4E2A;P&#x7684;(r&#x2212;l+1)&#x6B21;&#x65B9;</span>
    }
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>, &amp;l1, &amp;r1, &amp;l2, &amp;r2);
        <span class="hljs-keyword">if</span> (query(l1, r1) == query(l2, r2)) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Yes\n&quot;</span>);
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No\n&quot;</span>);
    }
}
</code></pre>
<h2 id="kmp">KMP</h2>
<p>&#x590D;&#x6742;&#x5EA6;&#xFF1A;$O(n)$</p>
<p>$p$&#x662F;&#x6A21;&#x677F;&#x4E32;&#xFF0C;&#x957F;&#x5EA6;&#x4E3A;$m$&#xFF0C;$s$&#x662F;&#x8981;&#x5339;&#x914D;&#x7684;&#x4E32;&#xFF0C;&#x957F;&#x5EA6;&#x4E3A;$n$</p>
<p>$next[j]$&#x7684;&#x542B;&#x4E49;&#xFF0C;&#x4EE5;$p[j]$&#x4E3A;&#x7ED3;&#x5C3E;&#xFF0C;&#x6700;&#x5927;&#x7684;&#x540E;&#x7F00;&#x548C;&#x524D;&#x7F00;&#x76F8;&#x7B49;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5F53;&#x7136;&#x957F;&#x5EA6;&#x8981;&#x5C0F;&#x4E8E;$j$&#xFF0C;&#x5426;&#x5219;&#x80AF;&#x5B9A;&#x662F;$k$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;
<span class="hljs-keyword">int</span> ne[N], n, m;
<span class="hljs-keyword">char</span> s[N], p[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; m &gt;&gt; (p + <span class="hljs-number">1</span>) &gt;&gt; n &gt;&gt; (s + <span class="hljs-number">1</span>);
    ne[<span class="hljs-number">0</span>] = ne[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>, j = <span class="hljs-number">0</span>; i &lt;= m; i++)<span class="hljs-comment">//&#x548C;&#x81EA;&#x5DF1;&#x5339;&#x914D;</span>
    {
        <span class="hljs-keyword">while</span> (j &amp;&amp; p[i] != p[j + <span class="hljs-number">1</span>]) j = ne[j]; 
        <span class="hljs-keyword">if</span> (p[i] == p[j + <span class="hljs-number">1</span>]) j++;
        ne[i] = j;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, j = <span class="hljs-number">0</span>; i &lt;= n; i++)<span class="hljs-comment">//&#x5339;&#x914D;</span>
    {
        <span class="hljs-keyword">while</span> (j &amp;&amp; s[i] != p[j + <span class="hljs-number">1</span>]) j = ne[j];<span class="hljs-comment">//&#x6211;&#x4EEC;&#x662F;&#x7528;s[i]&#x548C;p[j+1]&#x6BD4;&#x8F83;&#xFF0C;&#x4E0D;&#x76F8;&#x7B49;&#x5C31;&#x56DE;&#x9000;</span>
        <span class="hljs-keyword">if</span> (s[i] == p[j + <span class="hljs-number">1</span>]) j++;<span class="hljs-comment">//&#x5982;&#x679C;&#x76F8;&#x7B49;&#xFF0C;&#x5219;i++&#xFF0C;j++&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B21;&#x5339;&#x914D;</span>
        <span class="hljs-keyword">if</span> (j == m)<span class="hljs-comment">//&#x5339;&#x914D;&#x5B8C;&#x6210;,&#x4E0D;&#x5B8C;&#x6210;&#x7684;&#x8BDD;&#x5C31;&#x5339;&#x914D;p[j+1]&#x4E86;</span>
        {
            <span class="hljs-built_in">cout</span> &lt;&lt; i - m &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
            j = ne[j];<span class="hljs-comment">//&#x4E0D;&#x8981;&#x5FD8;&#x4E86;</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x5355;&#x8C03;&#x6808;&#x548C;&#x961F;&#x5217;">&#x5355;&#x8C03;&#x6808;&#x548C;&#x961F;&#x5217;</h2>
<p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A; N &#x7684;&#x6574;&#x6570;&#x6570;&#x5217;&#xFF0C;&#x8F93;&#x51FA;&#x6BCF;&#x4E2A;&#x6570;&#x5DE6;&#x8FB9;&#x7B2C;&#x4E00;&#x4E2A;&#x6BD4;&#x5B83;&#x5C0F;&#x7684;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x8F93;&#x51FA; &#x2212;1&#x3002;</p>
<pre><code class="lang-C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">1e6</span>;
<span class="hljs-built_in">stack</span> &lt;<span class="hljs-keyword">int</span>&gt; stk;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    CLOSE;
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span>&gt;&gt;n;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
    {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span>&gt;&gt;x;
        <span class="hljs-keyword">while</span>(!stk.empty()&amp;&amp;stk.top()&gt;=x) stk.pop();<span class="hljs-comment">//&#x5F53;&#x524D;&#x8FD9;&#x4E2A;&#x70B9;&#x4E00;&#x5B9A;&#x4E0D;&#x4F1A;&#x88AB;&#x7528;&#x5230;&#xFF0C;&#x56E0;&#x4E3A;x&#x66F4;&#x4F18;</span>
        <span class="hljs-keyword">if</span>(!stk.empty()) <span class="hljs-built_in">cout</span>&lt;&lt;stk.top()&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-number">-1</span>&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;
        stk.push(x);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x5355;&#x8C03;&#x961F;&#x5217;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-built_in">deque</span>&lt;<span class="hljs-keyword">int</span>&gt; q;<span class="hljs-comment">//&#x53CC;&#x7AEF;&#x961F;&#x5217;</span>
<span class="hljs-keyword">int</span> a[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n, k;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; k;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">while</span> (!q.empty() &amp;&amp; a[q.back()] &gt;= a[i]) q.pop_back();<span class="hljs-comment">//&#x5236;&#x4F5C;&#x961F;&#x5217;</span>
        q.push_back(i);
        <span class="hljs-keyword">while</span> (!q.empty() &amp;&amp; i - q.front() + <span class="hljs-number">1</span> &gt; k) q.pop_front();<span class="hljs-comment">//&#x56E0;&#x4E3A;&#x8981;&#x6C42;&#x957F;&#x5EA6;&#x662F;k</span>
        <span class="hljs-keyword">if</span> (i &gt;= k) <span class="hljs-built_in">cout</span> &lt;&lt; a[q.front()] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    q.clear();<span class="hljs-comment">//&#x522B;&#x5FD8;&#x4E86;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">while</span> (!q.empty() &amp;&amp; a[q.back()] &lt;= a[i]) q.pop_back();
        q.push_back(i);
        <span class="hljs-keyword">while</span> (!q.empty() &amp;&amp; i - q.front() + <span class="hljs-number">1</span> &gt; k) q.pop_front();
        <span class="hljs-keyword">if</span> (i &gt;= k) <span class="hljs-built_in">cout</span> &lt;&lt; a[q.front()] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x5E76;&#x67E5;&#x96C6;">&#x5E76;&#x67E5;&#x96C6;</h2>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-keyword">int</span> p[N], siz[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">if</span> (p[x] != x) p[x] = find(p[x]);
    <span class="hljs-keyword">return</span> p[x];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    <span class="hljs-keyword">int</span> fx = find(x);
    <span class="hljs-keyword">int</span> fy = find(y);
    <span class="hljs-keyword">if</span> (fx != fy) {
        p[fx] = fy;
        siz[fy] += siz[fx];
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n, m;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        p[i] = i;
        siz[i] = <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-built_in">string</span> op;
        <span class="hljs-keyword">int</span> a, b;
        <span class="hljs-built_in">cin</span> &gt;&gt; op;
        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;C&quot;</span>) {
            <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
            merge(a, b);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;Q1&quot;</span>) {
            <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
            <span class="hljs-keyword">if</span> (find(a) == find(b)) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">cin</span> &gt;&gt; a;
            <span class="hljs-built_in">cout</span> &lt;&lt; siz[find(a)] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="dfs&#x5E8F;">DFS&#x5E8F;</h2>
<p>&#x6811;&#x4E0A;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#xFF0C;&#x5B50;&#x6811;&#x6C42;&#x548C;&#x95EE;&#x9898;&#x3002;</p>
<p>dfs&#x628A;&#x5B50;&#x6811;&#x8F6C;&#x6362;&#x6210;&#x533A;&#x95F4;&#xFF0C;&#x5B50;&#x6811;&#x5BF9;&#x5E94;&#x7684;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x662F;&#x8FDE;&#x7EED;&#x7684;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2</span> * N, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> n, m, k, a[N], t[N];
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;
<span class="hljs-keyword">int</span> l[N], r[N], timestamp;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx ++;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{<span class="hljs-keyword">return</span> x &amp; -x;}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addT</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> c)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i &lt;= n; i += lowbit(i)){
        t[i] += c;
    }
}
<span class="hljs-function">LL <span class="hljs-title">getSum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    LL ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i; i -= lowbit(i)){
        ans += t[i];
    }
    <span class="hljs-keyword">return</span> ans;
}
<span class="hljs-comment">//u&#x5B50;&#x6811;&#x5BF9;&#x5E94;&#x7684;&#x533A;&#x95F4;&#x5C31;&#x662F;l[u],r[u]</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> fa)</span></span>{
    l[u] = ++ timestamp;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[u]; ~ i; i = ne[i]){
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span>(j == fa) <span class="hljs-keyword">continue</span>;
        dfs(j, u);
    }
    r[u] = timestamp;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    CLOSE;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i ++){
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(x, y), add(y, x);
    }
    dfs(k, <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        addT(l[i], a[i]);
    }
    <span class="hljs-keyword">while</span>(m --){
        <span class="hljs-keyword">int</span> op, x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; op &gt;&gt; x;
        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>){
            <span class="hljs-built_in">cin</span> &gt;&gt; y;
            addT(l[x], y);
        } <span class="hljs-keyword">else</span>{
            <span class="hljs-built_in">cout</span> &lt;&lt; getSum(r[x]) - getSum(l[x] - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-built_in">endl</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="st&#x8868;">ST&#x8868;</h2>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">19</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> f[N][M], a[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
    <span class="hljs-keyword">int</span> x = log2(n);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= x; j ++){
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + (<span class="hljs-number">1</span> &lt;&lt; j) - <span class="hljs-number">1</span> &lt;= n; i ++){
            <span class="hljs-keyword">if</span>(!j) f[i][j] = a[i];
            <span class="hljs-keyword">else</span> f[i][j] = max(f[i][j - <span class="hljs-number">1</span>], f[i + (<span class="hljs-number">1</span> &lt;&lt; (j - <span class="hljs-number">1</span>))][j - <span class="hljs-number">1</span>]);
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span>{
    <span class="hljs-keyword">int</span> k = log2(r - l + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> max(f[l][k], f[r - (<span class="hljs-number">1</span> &lt;&lt; k) + <span class="hljs-number">1</span>][k]);
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> n, m;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    init(n);
    <span class="hljs-built_in">cin</span> &gt;&gt; m;
    <span class="hljs-keyword">while</span>(m --){
        <span class="hljs-keyword">int</span> l, r;
        <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r;
        <span class="hljs-built_in">cout</span> &lt;&lt; query(l, r) &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6811;&#x72B6;&#x6570;&#x7EC4;">&#x6811;&#x72B6;&#x6570;&#x7EC4;</h2>
<p>&#x5355;&#x70B9;&#x4FEE;&#x6539;&#xFF0C;&#x533A;&#x95F4;&#x6C42;&#x548C;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>, M = N;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> a[N], n, m;
LL t[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{<span class="hljs-keyword">return</span> x &amp; -x;}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> c)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i &lt;= n; i += lowbit(i)){
        t[i] += c;
    }
}
<span class="hljs-function">LL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    LL sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i; i -= lowbit(i)){
        sum += t[i];
    }
    <span class="hljs-keyword">return</span> sum;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
        add(i, a[i]);
    }
    <span class="hljs-keyword">while</span>(m --){
        <span class="hljs-keyword">int</span> op, x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; op &gt;&gt; x &gt;&gt; y;
        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>) add(x, y);
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; query(y) - query(x - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x533A;&#x95F4;&#x4FEE;&#x6539;&#xFF0C;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF0C;&#x5373;&#x7EF4;&#x62A4;&#x5DEE;&#x5206;&#x6570;&#x7EC4;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>, M = N;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> a[N], n, m;
LL t[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{<span class="hljs-keyword">return</span> x &amp; -x;}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> c)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i &lt;= n; i += lowbit(i)){
        t[i] += c;
    }
}
<span class="hljs-function">LL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    LL sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i; i -= lowbit(i)){
        sum += t[i];
    }
    <span class="hljs-keyword">return</span> sum;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
        add(i, a[i] - a[i - <span class="hljs-number">1</span>]);
    }
    <span class="hljs-keyword">while</span>(m --){
        <span class="hljs-keyword">int</span> op;
        <span class="hljs-built_in">cin</span> &gt;&gt; op;
        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">int</span> l, r, k;
            <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; k;
            add(l, k), add(r + <span class="hljs-number">1</span>, -k);
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">int</span> x;
            <span class="hljs-built_in">cin</span> &gt;&gt; x;
            <span class="hljs-built_in">cout</span> &lt;&lt; query(x) &lt;&lt; <span class="hljs-built_in">endl</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><img src="https://cdn.acwing.com/media/article/image/2021/04/13/55909_2458a3c69c-%E5%A4%87%E6%B3%A8-2020%E5%B9%B47%E6%9C%8825%E6%97%A5.png" alt="&#x5907;&#x6CE8; 2020&#x5E74;7&#x6708;25&#x65E5;.png"></p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, M = N, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> n, q;
LL  t1[N], t2[N], a[N], b[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{<span class="hljs-keyword">return</span> x &amp; -x;}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, LL c, LL t[])</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i &lt;= n; i += lowbit(i)){
        t[i] += c;
    }
}
<span class="hljs-function">LL <span class="hljs-title">getsum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, LL t[])</span></span>{
    LL sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = x; i; i -= lowbit(i)){
        sum += t[i];
    }
    <span class="hljs-keyword">return</span> sum;
}
<span class="hljs-function">LL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">return</span> getsum(x, t1) * (x + <span class="hljs-number">1</span>) - getsum(x, t2); 
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    CLOSE;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; q;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    }
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        b[i] = a[i] - a[i - <span class="hljs-number">1</span>];
        add(i, b[i], t1);
        add(i, b[i] * i, t2);
    }
    <span class="hljs-keyword">while</span>(q --){
        <span class="hljs-keyword">int</span> op;
        <span class="hljs-built_in">cin</span> &gt;&gt; op;
        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>){
            <span class="hljs-keyword">int</span> l, r;
            LL k;
            <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; k;
            add(r + <span class="hljs-number">1</span>, -k, t1), add(l, k, t1);<span class="hljs-comment">//&#x6539;&#x5DEE;&#x5206;&#x6570;&#x7EC4;</span>
            add(r + <span class="hljs-number">1</span>, -k * (r + <span class="hljs-number">1</span>), t2), add(l, k * l, t2);<span class="hljs-comment">//&#x6539;i*&#x5DEE;&#x5206;&#x6570;&#x7EC4;</span>
        } <span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">int</span> l, r;
            <span class="hljs-built_in">cin</span> &gt;&gt; l &gt;&gt; r;
            <span class="hljs-built_in">cout</span> &lt;&lt; query(r) - query(l - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-built_in">endl</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x7EBF;&#x6BB5;&#x6811;">&#x7EBF;&#x6BB5;&#x6811;</h2>
<p>&#x5EFA;&#x6811;&#x590D;&#x6742;&#x5EA6; $O(n)$,&#x5176;&#x4ED6;&#x64CD;&#x4F5C;$O(log(n))$</p>
<p>&#x7236;&#x8282;&#x70B9;&#xFF1A;x/2 int&#x4F1A;&#x81EA;&#x52A8;&#x4E0B;&#x53D6;&#x6574;   x&gt;&gt;1; &#x5DE6;&#x513F;&#x5B50;&#xFF1A;2x     x&lt;&lt;1; &#x53F3;&#x513F;&#x5B50;&#xFF1A;2x+1  x&lt;&lt;1|1</p>
<p>&#x51E1;&#x662F;&#x53EA;&#x4FEE;&#x6539;&#x5355;&#x70B9;&#x7684;&#xFF0C;&#x662F;&#x4E0D;&#x9700;&#x8981;&#x61D2;&#x6807;&#x8BB0;&#x7684;&#xFF0C;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x7684;&#x9700;&#x8981;&#x61D2;&#x6807;&#x8BB0;&#x3002;</p>
<p>pushup&#xFF08;&#xFF09;&#x653E;&#x5728;build&#x548C;modify&#x7684;&#x4E0B;&#x9762;</p>
<p>pushdown&#x653E;&#x5728;query&#x548C;modify&#x7684;&#x4E0A;&#x9762;&#xFF0C;&#x5E76;&#x4E14;pushdown&#x653E;&#x5728;&#x7684;&#x662F;&#x8981;&#x5206;&#x88C2;&#x7684;&#x5730;&#x65B9;&#xFF1B;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">100</span>;
<span class="hljs-keyword">struct</span> node {
    LL l, r, sum, add;
} t[N * <span class="hljs-number">4</span>];<span class="hljs-comment">//&#x5F00;&#x56DB;&#x500D;&#x7A7A;&#x95F4;</span>
LL a[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(LL u)</span><span class="hljs-comment">//&#x7528;&#x5B50;&#x8282;&#x70B9;&#x7684;&#x4FE1;&#x606F;&#x66F4;&#x65B0;&#x7236;&#x4EB2;&#x8282;&#x70B9;</span>
</span>{
    t[u].sum = t[u &lt;&lt; <span class="hljs-number">1</span>].sum + t[u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>].sum;
};
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(LL u)</span><span class="hljs-comment">//&#x7528;&#x7236;&#x8282;&#x70B9;&#x53BB;&#x66F4;&#x65B0;&#x5B50;&#x8282;&#x70B9;</span>
</span>{
    <span class="hljs-comment">//&#x66F4;&#x65B0;&#x7684;&#x4FE1;&#x606F;&#x5305;&#x62EC;&#x503C;&#x548C;&#x61D2;&#x6807;&#x8BB0;&#xFF0C;&#x4E0D;&#x8981;&#x5FD8;&#x4E86;&#x6E05;&#x7A7A;&#x7236;&#x8282;&#x70B9;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x66F4;&#x50CF;&#x4F20;&#x9012;&#xFF01;&#xFF01;&#xFF01;</span>
    t[u &lt;&lt; <span class="hljs-number">1</span>].sum += (t[u &lt;&lt; <span class="hljs-number">1</span>].r - t[u &lt;&lt; <span class="hljs-number">1</span>].l + <span class="hljs-number">1</span>) * t[u].add;<span class="hljs-comment">//&#x66F4;&#x65B0;&#x5DE6;&#x513F;&#x5B50;&#x7684;&#x503C;</span>
    t[u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>].sum += (t[u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>].r - t[u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>].l + <span class="hljs-number">1</span>) * t[u].add;<span class="hljs-comment">//&#x66F4;&#x65B0;&#x53F3;&#x513F;&#x5B50;&#x7684;&#x503C;</span>
    t[u &lt;&lt; <span class="hljs-number">1</span>].add += t[u].add;<span class="hljs-comment">//&#x66F4;&#x65B0;&#x5DE6;&#x513F;&#x5B50;&#x7684;&#x61D2;&#x6807;&#x8BB0;</span>
    t[u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>].add += t[u].add;<span class="hljs-comment">//&#x66F4;&#x65B0;&#x53F3;&#x513F;&#x5B50;&#x7684;&#x503C;</span>
    t[u].add = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x6E05;&#x7A7A;&#x7236;&#x8282;&#x70B9;&#x7684;&#x61D2;&#x6807;&#x8BB0;</span>
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>{
    t[u].l = l, t[u].r = r;<span class="hljs-comment">//&#x8FD9;&#x4E2A;&#x4E00;&#x5B9A;&#x4E0D;&#x8981;&#x5FD8;&#x4E86;</span>
    <span class="hljs-keyword">if</span> (l == r)<span class="hljs-comment">//&#x521D;&#x59CB;&#x5316;</span>
    {
        t[u].sum = a[l];
        t[u].add = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> {
        t[u].add = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x6700;&#x597D;&#x4E5F;&#x52A0;&#x4E0A;</span>
        <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;
        build(u &lt;&lt; <span class="hljs-number">1</span>, l, mid), build(u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>, mid + <span class="hljs-number">1</span>, r);
        pushup(u);<span class="hljs-comment">//&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x4E86;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x7236;&#x8282;&#x70B9;&#x7684;&#x503C;&#x5FC5;&#x987B;&#x66F4;&#x65B0;</span>
    }
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, LL d)</span><span class="hljs-comment">//l,r&#x662F;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x533A;&#x95F4;</span>
</span>{
    <span class="hljs-keyword">if</span> (l &lt;= t[u].l &amp;&amp; t[u].r &lt;= r)<span class="hljs-comment">//&#x5F53;&#x524D;&#x533A;&#x95F4;&#x662F;&#x4FEE;&#x6539;&#x533A;&#x95F4;&#x7684;&#x5B50;&#x533A;&#x95F4;</span>
    {
        t[u].sum += (t[u].r - t[u].l + <span class="hljs-number">1</span>) * d;<span class="hljs-comment">//&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x533A;&#x95F4;&#xFF0C;&#x4E0D;&#x5728;&#x9012;&#x5F52;&#x4FEE;&#x6539;&#x540E;&#x9762;&#x533A;&#x95F4;&#x4E86;</span>
        t[u].add += d;<span class="hljs-comment">//&#x66F4;&#x65B0;&#x61D2;&#x6807;&#x8BB0;</span>
    } <span class="hljs-keyword">else</span><span class="hljs-comment">//&#x4FEE;&#x6539;&#x90E8;&#x5206;&#x533A;&#x95F4;&#x7684;&#x60C5;&#x51B5;</span>
    {
        pushdown(u);<span class="hljs-comment">//&#x8981;&#x4FEE;&#x6539;&#x90E8;&#x5206;&#x533A;&#x95F4;&#x4E86;&#xFF0C;&#x5206;&#x88C2;&#x4E86;&#xFF0C;&#x8981;pushdown&#xFF08;&#xFF09;</span>
        <span class="hljs-keyword">int</span> mid = (t[u].r + t[u].l) &gt;&gt; <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x8FD9;&#x91CC;&#x4E00;&#x5B9A;&#x4E0D;&#x8981;&#x9519;&#x4E86;&#xFF0C;l,r&#x662F;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x533A;&#x95F4;</span>
        <span class="hljs-keyword">if</span> (l &lt;= mid) modify(u &lt;&lt; <span class="hljs-number">1</span>, l, r, d);<span class="hljs-comment">//&#x5DE6;&#x513F;&#x5B50;&#x6709;&#x4EA4;&#x96C6;&#xFF0C;&#x9012;&#x5F52;&#x4FEE;&#x6539;&#x5DE6;&#x534A;&#x8FB9;</span>
        <span class="hljs-keyword">if</span> (r &gt; mid) modify(u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>, l, r, d);<span class="hljs-comment">//&#x53F3;&#x513F;&#x5B50;&#x6709;&#x4EA4;&#x96C6;&#xFF0C;&#x9012;&#x5F52;&#x4FEE;&#x6539;&#x53F3;&#x534A;&#x8FB9;</span>
        pushup(u);<span class="hljs-comment">//&#x4FEE;&#x6539;&#x4E86;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x5FC5;&#x7136;&#x8981;&#x66F4;&#x65B0;&#x7236;&#x8282;&#x70B9;</span>
    }
}
<span class="hljs-function">LL <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>{
    <span class="hljs-keyword">if</span> (l &lt;= t[u].l &amp;&amp; t[u].r &lt;= r) {
        <span class="hljs-keyword">return</span> t[u].sum;<span class="hljs-comment">//&#x76F4;&#x63A5;&#x8FD4;&#x56DE;</span>
    } <span class="hljs-keyword">else</span><span class="hljs-comment">//&#x67E5;&#x8BE2;&#x90E8;&#x5206;&#x533A;&#x95F4;&#x60C5;&#x51B5;</span>
    {
        pushdown(u);<span class="hljs-comment">//&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x8981;&#x5FD8;&#x4E86;pushdown()</span>
        <span class="hljs-keyword">int</span> mid = (t[u].l + t[u].r) &gt;&gt; <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x4E0D;&#x8981;&#x7528;l,r, l,r&#x662F;&#x8981;&#x67E5;&#x8BE2;&#x7684;&#x533A;&#x95F4;&#x5DE6;&#x53F3;&#x7AEF;&#x70B9;</span>
        LL ans = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (l &lt;= mid) ans += query(u &lt;&lt; <span class="hljs-number">1</span>, l, r);<span class="hljs-comment">//&#x5DE6;&#x513F;&#x5B50;&#x6709;&#x4EA4;&#x96C6;&#xFF0C;&#x9012;&#x5F52;&#x67E5;&#x8BE2;&#x5DE6;&#x534A;&#x8FB9;</span>
        <span class="hljs-keyword">if</span> (r &gt; mid) ans += query(u &lt;&lt; <span class="hljs-number">1</span> | <span class="hljs-number">1</span>, l, r);<span class="hljs-comment">//&#x53F3;&#x513F;&#x5B50;&#x6709;&#x4EA4;&#x96C6;&#xFF0C;&#x9012;&#x5F52;&#x67E5;&#x8BE2;&#x53F3;&#x534A;&#x8FB9;</span>
        <span class="hljs-keyword">return</span> ans;
    }
}
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld&quot;</span>, &amp;a[i]);
    build(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n);
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-keyword">char</span> op;
        LL l, r, d;
        <span class="hljs-built_in">cin</span> &gt;&gt; op &gt;&gt; l &gt;&gt; r;
        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&apos;Q&apos;</span>) {
            <span class="hljs-built_in">cout</span> &lt;&lt; query(<span class="hljs-number">1</span>, l, r) &lt;&lt; <span class="hljs-built_in">endl</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">cin</span> &gt;&gt; d;
            modify(<span class="hljs-number">1</span>, l, r, d);
        }
    }
}
</code></pre>
<h2 id="&#x5B57;&#x5178;&#x6811;">&#x5B57;&#x5178;&#x6811;</h2>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-built_in">string</span> s)</span></span>{
    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.size(); i ++){
        <span class="hljs-keyword">int</span> u = s[i] - <span class="hljs-string">&apos;0&apos;</span>;
        <span class="hljs-keyword">if</span>(!son[p][u]) son[p][u] = ++ idx;
        p = son[p][u];
    }
    cnt[p] ++;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-built_in">string</span> s)</span></span>{
    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.size(); i ++){
        <span class="hljs-keyword">int</span> u = s[i] - <span class="hljs-string">&apos;0&apos;</span>;
        <span class="hljs-keyword">if</span>(!son[p][u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        p = son[p][u];
    }
    <span class="hljs-keyword">return</span> cnt[p];
}
</code></pre>
<p>01&#x5B57;&#x5178;&#x6811;</p>
<p>cnt[p] ++&#xFF0C;&#x4FDD;&#x8BC1;&#x53EA;&#x7528;&#x4E00;&#x6B21;&#xFF0C;&#x7528;&#x5B8C;&#x4E86;&#x5C31;&#x4E0D;&#x4F1A;&#x8DF3;&#x5230;x&#xFF01;&#xFF01;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>, M = N, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> son[N][<span class="hljs-number">2</span>], cnt[N], idx;
<span class="hljs-keyword">int</span> a[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">30</span>; i &gt;= <span class="hljs-number">0</span>; i --){
        <span class="hljs-keyword">int</span> u = (x &gt;&gt; i) &amp; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span>(!son[p][u]) son[p][u] = ++ idx;
        p = son[p][u];
        cnt[p] ++;
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>, ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">30</span>; i &gt;= <span class="hljs-number">0</span>; i --){
        <span class="hljs-keyword">int</span> u = (x &gt;&gt; i) &amp; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span>(cnt[son[p][u]]){
            p = son[p][u];
        } <span class="hljs-keyword">else</span> {
            p = son[p][u ^ <span class="hljs-number">1</span>];
            ans += <span class="hljs-number">1</span> &lt;&lt; i;
        }
        cnt[p] --;
    }
    <span class="hljs-keyword">return</span> ans;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    }
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        insert(x);
    }
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-built_in">cout</span> &lt;&lt; query(a[i]) &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h1 id="&#x641C;&#x7D22;">&#x641C;&#x7D22;</h1>
<h2 id="bfs">BFS</h2>
<p>bfs&#x4E2D;&#x7684;&#x961F;&#x5217;&#x6709;&#x4E24;&#x4E2A;&#x6027;&#x8D28;</p>
<p>1&#xFF1A;&#x4E24;&#x6BB5;&#x6027;   &#x8DDD;&#x79BB;&#xFF1A;  x x x x (x+1) (x+1) (x+1)</p>
<p>2&#xFF1A;&#x5355;&#x8C03;&#x6027;   bfs&#x6BCF;&#x6B21;&#x53D6;&#x51FA;&#x7684;&#x961F;&#x5934;&#x90FD;&#x662F;&#x8DDD;&#x79BB;&#x6700;&#x8FD1;&#x7684;&#x70B9;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;Dijisitla&#xFF0C;</p>
<p>3&#xFF1A;&#x53EA;&#x8981;&#x80FD;&#x65F6;&#x65F6;&#x523B;&#x523B;&#x6EE1;&#x8DB3;&#x4E24;&#x6BB5;&#x6027;&#x548C;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x5462;&#x4E48;bfs&#x5C31;&#x76F8;&#x5F53;&#x4E8E;Dijisitla&#xFF0C;&#x6240;&#x4EE5;bfs&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF1B;</p>
<h2 id="&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x5E7F;&#x641C;">&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x5E7F;&#x641C;</h2>
<p>1&#xFF1A;&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x5E7F;&#x641C;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x662F;&#x8FB9;&#x6743;&#x662F;0&#x548C;&#x8FB9;&#x6743;&#x662F;1&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x666E;&#x901A;&#x7684;BFS&#x662F;&#x89E3;&#x51B3;&#x8FB9;&#x6743;&#x90FD;&#x662F;1&#xFF08;&#x8FB9;&#x6743;&#x76F8;&#x7B49;&#xFF09;&#x7684;&#x95EE;&#x9898;&#xFF1B;</p>
<p>2&#xFF1A;&#x53CC;&#x7AEF;&#x961F;&#x5217;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x7B80;&#x5316;&#x7248;&#x7684;&#x5806;&#x4F18;&#x5316;Dijisitla&#xFF0C;&#x4F46;&#x662F;&#x590D;&#x6742;&#x5EA6;&#x66F4;&#x4F18;&#x4E3A;O(n)&#xFF1B;</p>
<p>3&#xFF1A;&#x56E0;&#x4E3A;&#x6709;&#x4E24;&#x79CD;&#x6743;&#x91CD;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x641C;&#x5230;&#x7684;&#x70B9;&#x4E0D;&#x4E00;&#x5B9A;&#x5C31;&#x662F;&#x6700;&#x77ED;&#x8DDD;&#x79BB;&#xFF0C;&#x4E0E;&#x5806;&#x4F18;&#x5316;Dijkstra &#x4E00;&#x6837;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x51FA;&#x961F;&#x65F6;&#x624D;&#x77E5;&#x9053;&#x6BCF;&#x4E2A;&#x70B9;&#x6700;&#x7EC8;&#x7684;&#x6700;&#x5C0F;&#x503C;&#xFF0C;&#x800C;&#x548C;&#x4E00;&#x822C;&#x7684;bfs&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;</p>
<p>4.&#x4E0E;Dijisitla&#x4E0D;&#x540C;&#x662F;&#xFF0C;&#x4ED6;&#x662F;&#x641C;&#x7D22;&#x7684;&#x65F6;&#x5019;&#x7528;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5EFA;&#x8FB9;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5EFA;&#x56FE;&#xFF0C;&#x4E0E;&#x666E;&#x901A;&#x7684;bfs&#x9898;&#x7684;&#x4E0D;&#x540C;&#x662F;&#x6709;&#x4E24;&#x79CD;&#x8FB9;&#x3002;</p>
<p><img src="https://cdn.acwing.com/media/article/image/2020/10/02/7416_a0f1354804-2b9afb6b5c690928a81e855d477ed37.png" alt="2b9afb6b5c690928a81e855d477ed37.png"></p>
<pre><code class="lang-C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>

<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1006</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">struct</span> node {
    <span class="hljs-keyword">int</span> x, y;
};
<span class="hljs-keyword">int</span> a[N][N], dist[N][N], st[N][N];
<span class="hljs-keyword">int</span> wy[<span class="hljs-number">4</span>][<span class="hljs-number">2</span>] = {<span class="hljs-number">1</span>, <span class="hljs-number">0</span>},{<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">1</span>},{<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>};
<span class="hljs-keyword">int</span> qdx, qdy;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);
    <span class="hljs-built_in">deque</span>&lt;node&gt; q;
    q.push_front({qdx, qdy});
    dist[qdx][qdy] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (!q.empty()) {
        node one = q.front();
        q.pop_front();
        <span class="hljs-keyword">if</span> (st[one.x][one.y]) <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">else</span> st[one.x][one.y] = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
            <span class="hljs-keyword">int</span> xx = one.x + wy[i][<span class="hljs-number">0</span>];
            <span class="hljs-keyword">int</span> yy = one.y + wy[i][<span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> (xx &gt;= <span class="hljs-number">0</span> &amp;&amp; xx &lt; N &amp;&amp; yy &gt;= <span class="hljs-number">0</span> &amp;&amp; yy &lt;= N) {
                <span class="hljs-keyword">if</span> (dist[xx][yy] &gt; dist[one.x][one.y] + a[xx][yy]) {
                    dist[xx][yy] = dist[one.x][one.y] + a[xx][yy];
                    <span class="hljs-keyword">if</span> (a[xx][yy] == <span class="hljs-number">1</span>)q.push_back({xx, yy});
                    <span class="hljs-keyword">else</span> q.push_front({xx, yy});
                }
            }
        }
    }
    <span class="hljs-keyword">return</span> dist[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; qdx &gt;&gt; qdy;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        a[x][y] = <span class="hljs-number">1</span>;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; bfs();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x53CC;&#x5411;&#x5E7F;&#x641C;">&#x53CC;&#x5411;&#x5E7F;&#x641C;</h2>
<p>&#x4E00;&#x822C;&#x7528;&#x4E8E;&#x6700;&#x5C0F;&#x6B65;&#x6570;&#x6A21;&#x578B;&#xFF0C;&#x6700;&#x77ED;&#x8DEF;&#x6A21;&#x578B;&#x4E00;&#x822C;&#x7528;&#x4E0D;&#x5230;&#xFF0C;&#x56E0;&#x4E3A;&#x672C;&#x6765;&#x5C31;&#x4E0D;&#x4F1A;&#x8D85;&#x65F6;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x8981;&#x770B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5341;&#x6B65;&#x4E4B;&#x5185;&#x662F;&#x4E0D;&#x662F;&#x80FD;&#x53D8;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x516D;&#x4E2A;&#x53D8;&#x5316;&#x65B9;&#x5F0F;&#xFF0C;&#x76F4;&#x63A5;BFS&#x662F;6^10,&#x5982;&#x679C;&#x662F;&#x53CC;&#x5411;&#x5E7F;&#x641C;&#x7684;&#x8BDD;&#xFF0C;&#x53EA;&#x6709;3*6&#x7684;&#x4E94;&#x6B21;&#x65B9;&#xFF0C;&#x663E;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;/2&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-comment">//&#x5B57;&#x7B26;&#x4E32;&#x51FD;&#x6570;  s.substr(qd,len);</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-built_in">string</span> A, B, x, y;
<span class="hljs-built_in">string</span> a[<span class="hljs-number">7</span>], b[<span class="hljs-number">7</span>];
<span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span>&gt; da, db;
<span class="hljs-built_in">queue</span>&lt;<span class="hljs-built_in">string</span>&gt; qa, qb;
<span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">extend</span><span class="hljs-params">(<span class="hljs-built_in">queue</span>&lt;<span class="hljs-built_in">string</span>&gt; &amp;q, <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span>&gt; &amp;da, <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-keyword">int</span>&gt; &amp;db, <span class="hljs-built_in">string</span> a[],
           <span class="hljs-built_in">string</span> b[])</span><span class="hljs-comment">//&#x522B;&#x5FD8;&#x4E86;&#x52A0;&#x5F15;&#x7528;&#x7B26;&#x53F7;</span>
</span>{
    <span class="hljs-built_in">string</span> s = q.front();
    q.pop();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.size(); i++)<span class="hljs-comment">//&#x904D;&#x5386;&#x8D77;&#x70B9;</span>
    {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= idx; j++)<span class="hljs-comment">//&#x904D;&#x5386;&#x89C4;&#x5219;</span>
        {
            <span class="hljs-keyword">if</span> (s.substr(i, a[j].size()) == a[j])<span class="hljs-comment">//&#x51FD;&#x6570;</span>
            {
                <span class="hljs-built_in">string</span> ss = s.substr(<span class="hljs-number">0</span>, i) + b[j] + s.substr(i + a[j].size());<span class="hljs-comment">//&#x53D8;&#x6362;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;</span>
                <span class="hljs-keyword">if</span> (db.count(ss))<span class="hljs-comment">//&#x5982;&#x679C;&#x53E6;&#x4E00;&#x4E2A;&#x904D;&#x5386;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#xFF0C;&#x5C31;&#x8981;&#x6C47;&#x5408;</span>
                {
                    <span class="hljs-keyword">return</span> da[s] + db[ss] + <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x8FD4;&#x56DE;&#x8DDD;&#x79BB;</span>
                }
                <span class="hljs-keyword">if</span> (da.count(ss)) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">//&#x5982;&#x679C;a&#x641C;&#x8FC7;&#x4E86;&#xFF0C;&#x5C31;&#x4E0D;&#x5165;&#x961F;&#x4E86;</span>
                q.push(ss);
                da[ss] = da[s] + <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">11</span>;<span class="hljs-comment">//&#x641C;&#x7D20;&#x4E00;&#x5C42;&#x90FD;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;11</span>
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (A == B) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x7279;&#x5224;</span>
    da[A] = <span class="hljs-number">0</span>, db[B] = <span class="hljs-number">0</span>;
    qa.push(A), qb.push(B);
    <span class="hljs-keyword">while</span> (!qa.empty() &amp;&amp; !qb.empty())<span class="hljs-comment">//&#x5982;&#x679C;&#x6709;&#x4E00;&#x4E2A;&#x4E3A;&#x7A7A;&#x4E86;&#xFF0C;&#x8BF4;&#x660E;&#x662F;&#x4E0D;&#x8FDE;&#x901A;&#x7684;&#xFF0C;&#x65E0;&#x6CD5;&#x4ECE;A-&gt;B</span>
    {
        <span class="hljs-keyword">int</span> bs;
        <span class="hljs-keyword">if</span> (qa.size() &lt;= qb.size())<span class="hljs-comment">//&#x4F18;&#x5316;&#xFF0C;&#x4F18;&#x5148;&#x641C;&#x7D22;&#x961F;&#x5217;&#x957F;&#x5EA6;&#x77ED;&#x7684;</span>
        {
            bs = extend(qa, da, db, a, b);<span class="hljs-comment">//&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x6269;&#x5C55;&#x770B;&#x770B;&#x53CC;&#x5411;&#x641C;&#x7D22;&#x662F;&#x5426;&#x80FD;&#x63A5;&#x5728;&#x4E00;&#x8D77;</span>
        } <span class="hljs-keyword">else</span> bs = extend(qb, db, da, b, a);<span class="hljs-comment">//&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x6269;&#x5C55;&#x770B;&#x770B;&#x53CC;&#x5411;&#x641C;&#x7D22;&#x662F;&#x5426;&#x80FD;&#x63A5;&#x5728;&#x4E00;&#x8D77;</span>
        <span class="hljs-keyword">if</span> (bs &lt;= <span class="hljs-number">10</span>) <span class="hljs-keyword">return</span> bs;<span class="hljs-comment">//&#x5982;&#x679C;&#x8DDD;&#x79BB;&#x5C0F;&#x4E8E;10&#xFF0C;&#x5C31;&#x627E;&#x5230;&#x4E86;&#xFF0C;&#x4E0D;&#x7528;&#x7EE7;&#x7EED;&#x641C;&#x7D22;&#x4E86;</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<span class="hljs-comment">//&#x5168;&#x90E8;&#x60C5;&#x51B5;&#x90FD;&#x641C;&#x7D22;&#x4E86;&#xFF0C;&#x6CA1;&#x6709;&lt;10&#x7684;&#xFF0C;&#x5462;&#x4E48;&#x65E0;&#x89E3;</span>
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; A &gt;&gt; B;
    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y) {
        idx++;
        a[idx] = x, b[idx] = y;
    }
    <span class="hljs-keyword">int</span> ans = bfs();
    <span class="hljs-keyword">if</span> (ans == <span class="hljs-number">-1</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;NO ANSWER!&quot;</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h1 id="&#x56FE;&#x548C;&#x6811;">&#x56FE;&#x548C;&#x6811;</h1>
<h2 id="&#x4E8C;&#x53C9;&#x6811;">&#x4E8C;&#x53C9;&#x6811;</h2>
<p>&#x5148;&#x5E8F;+&#x4E2D;&#x5E8F;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e3</span>;
<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, PII&gt; node;
<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; mp;
<span class="hljs-keyword">int</span> n;
<span class="hljs-keyword">int</span> a[N], b[N];
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; v;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l1, <span class="hljs-keyword">int</span> r1, <span class="hljs-keyword">int</span> l2, <span class="hljs-keyword">int</span> r2)</span><span class="hljs-comment">//&#x5148;&#x5E8F;+&#x4E2D;&#x5E8F;</span>
</span>{
    <span class="hljs-keyword">if</span> (l1 &gt; r1 || l2 &gt; r2) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">int</span> root = a[l1];
    <span class="hljs-keyword">int</span> k = mp[root];
    <span class="hljs-keyword">int</span> sum = k - l2;
    node[root].first = dfs(l1 + <span class="hljs-number">1</span>, l1 + sum, l2, k - <span class="hljs-number">1</span>);
    node[root].second = dfs(l1 + sum + <span class="hljs-number">1</span>, r1, k + <span class="hljs-number">1</span>, r2);
    <span class="hljs-keyword">return</span> root;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l1, <span class="hljs-keyword">int</span> r1, <span class="hljs-keyword">int</span> l2, <span class="hljs-keyword">int</span> r2)</span><span class="hljs-comment">//&#x540E;&#x5E8F;+&#x4E2D;&#x5E8F;</span>
</span>{
    <span class="hljs-keyword">if</span> (l1 &gt; r1 || l2 &gt; r2) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">int</span> root = a[r1];
    <span class="hljs-keyword">int</span> k = mp[root];
    <span class="hljs-keyword">int</span> sum = k - l2;
    node[root].first = dfs(l1, l1 + sum - <span class="hljs-number">1</span>, l2, k - <span class="hljs-number">1</span>);
    node[root].second = dfs(l1 + sum, r1 - <span class="hljs-number">1</span>, k + <span class="hljs-number">1</span>, r2);
    <span class="hljs-keyword">return</span> root;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span><span class="hljs-comment">//&#x5C42;&#x6B21;</span>
</span>{
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    q.push(a[<span class="hljs-number">1</span>]);
    <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        cnt++;
        <span class="hljs-keyword">if</span> (cnt != n) <span class="hljs-built_in">cout</span> &lt;&lt; t &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; t &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">if</span> (node[t].first) {
            q.push(node[t].first);
        }
        <span class="hljs-keyword">if</span> (node[t].second) {
            q.push(node[t].second);
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; b[i];
        mp[b[i]] = i;
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    }
    dfs(<span class="hljs-number">1</span>, n, <span class="hljs-number">1</span>, n);
    bfs();
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6811;&#x7684;&#x76F4;&#x5F84;&#x548C;&#x91CD;&#x5FC3;">&#x6811;&#x7684;&#x76F4;&#x5F84;&#x548C;&#x91CD;&#x5FC3;</h2>
<p>&#x76F4;&#x5F84;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10010</span>, M = <span class="hljs-number">20010</span>;
<span class="hljs-keyword">int</span> h[N], ne[M], w[M], e[M], idx;
<span class="hljs-keyword">int</span> ans; <span class="hljs-comment">// &#x4FDD;&#x5B58;&#x6700;&#x957F;&#x8DEF;&#x5F84;</span>
<span class="hljs-keyword">int</span> t;  <span class="hljs-comment">// &#x4FDD;&#x5B58;&#x627E;&#x5230;&#x7684;&#x6700;&#x8FDC;&#x70B9;</span>
<span class="hljs-keyword">int</span> n;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c)</span> </span>{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> father, <span class="hljs-keyword">int</span> dist)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (j == father) <span class="hljs-keyword">continue</span>;
        dfs(j, u, dist + w[i]);
    }
    <span class="hljs-comment">// &#x627E;&#x5230;&#x6700;&#x5927;&#x7684;dist&#x7528;&#x6765;&#x66F4;&#x65B0;&#x7B54;&#x6848;ans&#x548C;&#x70B9;t</span>
    <span class="hljs-keyword">if</span> (dist &gt; ans) {
        ans = dist;
        t = u;
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; ++i) {
        <span class="hljs-keyword">int</span> a, b, c;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);
        add(a, b, c);
        add(b, a, c);
    }
    dfs(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);  <span class="hljs-comment">// &#x5148;&#x627E;&#x5230;&#x70B9;t</span>
    dfs(t, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);  <span class="hljs-comment">// &#x6839;&#x636E;t&#x627E;&#x5230;&#x7ED3;&#x679C;ans</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x91CD;&#x5FC3;&#x5B9A;&#x4E49;&#xFF1A;&#x91CD;&#x5FC3;&#x662F;&#x6307;&#x6811;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x8FD9;&#x4E2A;&#x70B9;&#x5220;&#x9664;&#x540E;&#xFF0C;&#x5269;&#x4F59;&#x5404;&#x4E2A;&#x8FDE;&#x901A;&#x5757;&#x4E2D;&#x70B9;&#x6570;&#x7684;&#x6700;&#x5927;&#x503C;&#x6700;&#x5C0F;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x88AB;&#x79F0;&#x4E3A;&#x6811;&#x7684;&#x91CD;&#x5FC3;&#x3002;&#x6811;&#x7684;&#x91CD;&#x5FC3;&#x4E0D;&#x552F;&#x4E00;&#x3002;</p>
<p><img src="https://kdyfiles.oss-cn-hangzhou.aliyuncs.com/kdyb60d5214d84c40bc9fc22546b18d0255.png" alt="https://kdyfiles.oss-cn-hangzhou.aliyuncs.com/kdyb60d5214d84c40bc9fc22546b18d0255.png"></p>
<p>&#x5B9A;&#x4E49;&#x51FD;&#x6570;$dfs(u)$&#xFF0C;&#x8868;&#x793A;&#x4EE5;$u$&#x4E3A;&#x6839;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#x4E2A;&#x6570;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = N * <span class="hljs-number">2</span>;
<span class="hljs-keyword">int</span> n;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;<span class="hljs-comment">//&#x5B58;&#x56FE;</span>
<span class="hljs-keyword">int</span> ans = <span class="hljs-number">0x3f3f3f3f</span>;<span class="hljs-comment">//&#x6700;&#x7EC8;&#x7684;&#x7B54;&#x6848;</span>
<span class="hljs-keyword">bool</span> st[N];<span class="hljs-comment">//&#x8868;&#x793A;&#x54EA;&#x4E9B;&#x70B9;&#x5DF2;&#x7ECF;&#x88AB;&#x904D;&#x5386;&#x8FC7;</span>
<span class="hljs-comment">//&#x52A0;&#x8FB9;&#x51FD;&#x6570;</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>{
    e[idx] = b, ne[idx] = h[a], h[a] = idx++;
}
<span class="hljs-comment">//dfs(u)&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4EE5;u&#x4E3A;&#x6839;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#x4E2A;&#x6570;</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    st[u] = <span class="hljs-literal">true</span>;<span class="hljs-comment">//u&#x8282;&#x70B9;&#x88AB;&#x8BBF;&#x95EE;&#x8FC7;</span>
    <span class="hljs-keyword">int</span> size = <span class="hljs-number">0</span>;<span class="hljs-comment">//size&#x5B58;&#x7684;&#x662F;&#x82E5;&#x5220;&#x9664;u&#x8282;&#x70B9;&#xFF0C;&#x5269;&#x4F59;&#x5404;&#x4E2A;&#x8FDE;&#x901A;&#x5757;&#x4E2D;&#x70B9;&#x6570;&#x7684;&#x6700;&#x5927;&#x503C;&#x7684;&#x6700;&#x5C0F;&#x662F;&#x591A;&#x5C11;&#x3002;</span>
    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">1</span>;<span class="hljs-comment">// sum&#x5B58;&#x7684;&#x662F;&#x4EE5;u&#x4E3A;&#x6839;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#x4E2A;&#x6570;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;dfs&#x51FD;&#x6570;&#x6700;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#xFF0C;&#x521D;&#x503C;&#x662F;1</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; i != <span class="hljs-number">-1</span>; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];<span class="hljs-comment">//j&#x662F;&#x5B50;&#x8282;&#x70B9;&#x7684;&#x7F16;&#x53F7;</span>
        <span class="hljs-keyword">if</span> (st[j]) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">//&#x53EA;&#x8BBF;&#x95EE;&#x6CA1;&#x6709;&#x8BBF;&#x95EE;&#x8FC7;&#x7684;&#x70B9;</span>
        <span class="hljs-keyword">int</span> s = dfs(j);<span class="hljs-comment">//&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#x4E2A;&#x6570;</span>
        size = max(size, s);<span class="hljs-comment">//&#x53D6;&#x4E00;&#x4E2A;max</span>
        sum += s;<span class="hljs-comment">//&#x4EE5;u&#x4E3A;&#x6839;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#x4E2A;&#x6570;&#x9700;&#x8981;&#x52A0;&#x4E0A;s</span>
    }
    size = max(size, n - sum);<span class="hljs-comment">//&#x4E0D;&#x8981;&#x5FD8;&#x4E86;&#x7236;&#x8282;&#x70B9;&#x4E5F;&#x6784;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x8054;&#x901A;&#x5757;</span>
    ans = min(ans, size);<span class="hljs-comment">//&#x66F4;&#x65B0;&#x7B54;&#x6848;</span>
    <span class="hljs-keyword">return</span> sum;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<span class="hljs-comment">//&#x522B;&#x5FD8;&#x4E86;&#x521D;&#x59CB;&#x5316;&#x56FE;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) {
        <span class="hljs-keyword">int</span> a, b;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);
        add(a, b), add(b, a);
    }
    dfs(<span class="hljs-number">1</span>);<span class="hljs-comment">//&#x4ECE;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x70B9;&#x641C;&#x90FD;&#x53EF;&#x4EE5;</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x62D3;&#x6251;&#x6392;&#x5E8F;">&#x62D3;&#x6251;&#x6392;&#x5E8F;</h2>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">100</span>, M = N;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx, din[N], n, m;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; v;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">topsort</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (din[i] == <span class="hljs-number">0</span>) q.push(i);
    }
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        v.push_back(t);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; ~i; i = ne[i]) {
            <span class="hljs-keyword">int</span> j = e[i];
            din[j]--;
            <span class="hljs-keyword">if</span> (din[j] == <span class="hljs-number">0</span>) q.push(j);
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(x, y);
        din[y] ++;
    }
    topsort();
    <span class="hljs-keyword">if</span> (v.size() != n) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; v.size(); i++) <span class="hljs-built_in">cout</span> &lt;&lt; v[i] &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;">&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;</h2>
<p>Kruskal&#x590D;&#x6742;&#x5EA6; $O(n*log(n))$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">1e5</span>+<span class="hljs-number">100</span>,M=<span class="hljs-number">2e5</span>+<span class="hljs-number">100</span>;
<span class="hljs-keyword">struct</span> node{
    <span class="hljs-keyword">int</span> x,y,w;
}edge[M];
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(node a,node b)</span>
</span>{
    <span class="hljs-keyword">return</span> a.w&lt;b.w;
}
<span class="hljs-keyword">int</span> n,m,p[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span>
</span>{
    <span class="hljs-keyword">if</span>(p[x]!=x) p[x]=find(p[x]);
    <span class="hljs-keyword">return</span> p[x];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    CLOSE;
    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) p[i]=i;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
    {
        <span class="hljs-built_in">cin</span>&gt;&gt;edge[i].x&gt;&gt;edge[i].y&gt;&gt;edge[i].w;
    }
    sort(edge+<span class="hljs-number">1</span>,edge+<span class="hljs-number">1</span>+m,cmp);<span class="hljs-comment">//&#x8FD9;&#x91CC;&#x6392;&#x5E8F;&#x522B;&#x6392;&#x9519;&#x4E86;</span>
    <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>,cnt=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
    {
        <span class="hljs-keyword">int</span> x=find(edge[i].x),y=find(edge[i].y),w=edge[i].w;
        <span class="hljs-keyword">if</span>(x!=y)
        {
            cnt++;
            sum+=w;
            p[x]=y;
        }
    } 
    <span class="hljs-keyword">if</span>(cnt==n<span class="hljs-number">-1</span>) <span class="hljs-built_in">cout</span>&lt;&lt;sum&lt;&lt;<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-string">&quot;impossible&quot;</span>&lt;&lt;<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811; </p>
<p>&#x4E25;&#x683C;&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF1A;&#x8FB9;&#x6743;&#x4E4B;&#x548C;&#x5FC5;&#x987B;&#x5C0F;&#x4E8E;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;</p>
<p>&#x975E;&#x4E25;&#x683C;&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF0C;&#x8FB9;&#x6743;&#x4E4B;&#x548C;&#x53EF;&#x4EE5;&#x4E0E;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#x76F8;&#x7B49;</p>
<pre><code class="lang-c++"><span class="hljs-comment">//&#x79BB;&#x8C31;&#xFF0C;&#x5361;vector&#xFF01;&#xFF01;&#xFF01;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">6e5</span> + <span class="hljs-number">100</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], w[M], idx;
<span class="hljs-keyword">int</span> f[N][<span class="hljs-number">18</span>], depth[N], d1[N][<span class="hljs-number">18</span>], d2[N][<span class="hljs-number">18</span>], p[N];
<span class="hljs-keyword">int</span> n, m;
ll sum;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>{
    e[idx] = y, w[idx] = z, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">if</span> (p[x] != x) p[x] = find(p[x]);
    <span class="hljs-keyword">return</span> p[x];
}
<span class="hljs-keyword">struct</span> node {
    <span class="hljs-keyword">int</span> x, y, w;
    <span class="hljs-keyword">bool</span> used;
} edge[M];
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(node a, node b)</span> </span>{
    <span class="hljs-keyword">return</span> a.w &lt; b.w;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(depth, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> depth);
    depth[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
    depth[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    q.push(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; ~i; i = ne[i]) {
            <span class="hljs-keyword">int</span> j = e[i];
            <span class="hljs-keyword">if</span> (depth[j] &gt; depth[t] + <span class="hljs-number">1</span>) {
                q.push(j);
                depth[j] = depth[t] + <span class="hljs-number">1</span>;
                f[j][<span class="hljs-number">0</span>] = t;
                d1[j][<span class="hljs-number">0</span>] = w[i], d2[j][<span class="hljs-number">0</span>] = -inf;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">17</span>; k++) {
                    <span class="hljs-keyword">int</span> anc = f[j][k - <span class="hljs-number">1</span>];
                    f[j][k] = f[anc][k - <span class="hljs-number">1</span>];
                    <span class="hljs-keyword">int</span> distance[<span class="hljs-number">4</span>] = {d1[j][k - <span class="hljs-number">1</span>], d1[anc][k - <span class="hljs-number">1</span>], d2[j][k - <span class="hljs-number">1</span>], d2[anc][k - <span class="hljs-number">1</span>]};
                    d1[j][k] = d2[j][k] = -inf;
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> s = <span class="hljs-number">0</span>; s &lt;= <span class="hljs-number">3</span>; s++) {
                        <span class="hljs-keyword">if</span> (distance[s] &gt; d1[j][k]) {
                            d2[j][k] = d1[j][k], d1[j][k] = distance[s];
                        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (distance[s] &lt; d1[j][k] &amp;&amp; distance[s] &gt; d2[j][k]) d2[j][k] = distance[s];
                    }
                }
            }
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> w)</span> </span>{
    <span class="hljs-keyword">int</span> distance[M];
    <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (depth[x] &lt; depth[y]) swap(x, y);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">17</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">if</span> (depth[f[x][i]] &gt;= depth[y]) {
            distance[cnt++] = d1[x][i];
            distance[cnt++] = d2[x][i];
            x = f[x][i];
        }
    }
    <span class="hljs-keyword">if</span> (x != y) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">17</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">if</span> (f[x][i] != f[y][i]) {
                distance[cnt++] = d1[x][i];
                distance[cnt++] = d2[x][i];
                distance[cnt++] = d1[y][i];
                distance[cnt++] = d2[y][i];
                x = f[x][i], y = f[y][i];
            }
        }
        distance[cnt++] = d1[x][<span class="hljs-number">0</span>];
        distance[cnt++] = d2[x][<span class="hljs-number">0</span>];
        distance[cnt++] = d1[y][<span class="hljs-number">0</span>];
        distance[cnt++] = d2[y][<span class="hljs-number">0</span>];
    }
    <span class="hljs-keyword">int</span> dist1 = -inf, dist2 = -inf;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cnt; i++) {
        <span class="hljs-keyword">int</span> it = distance[i];
        <span class="hljs-keyword">if</span> (it &gt; dist1) {
            dist2 = dist1, dist1 = it;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it &lt; dist1 &amp;&amp; it &gt; dist2) dist2 = it;
    }
    <span class="hljs-keyword">if</span> (w &gt; dist1) <span class="hljs-keyword">return</span> w - dist1;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (w &gt; dist2) <span class="hljs-keyword">return</span> w - dist2;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> inf;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) p[i] = i;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);
        edge[i] = {x, y, z, <span class="hljs-literal">false</span>};
    }
    sort(edge + <span class="hljs-number">1</span>, edge + <span class="hljs-number">1</span> + m, cmp);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> fx = find(edge[i].x), fy = find(edge[i].y), w = edge[i].w;
        <span class="hljs-keyword">if</span> (fx != fy) {
            p[fx] = fy;
            sum += w;
            edge[i].used = <span class="hljs-literal">true</span>;
            add(edge[i].x, edge[i].y, w);
            add(edge[i].y, edge[i].x, w);
        }
    }
    bfs();
    ll ans = <span class="hljs-number">1e18</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">if</span> (!edge[i].used) {
            <span class="hljs-keyword">int</span> x = edge[i].x, y = edge[i].y;
            ans = min(ans, sum + lca(x, y, edge[i].w));
        }
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, ans);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6700;&#x77ED;&#x8DEF;">&#x6700;&#x77ED;&#x8DEF;</h2>
<h3 id="dijkstra">Dijkstra</h3>
<p>&#x53EA;&#x80FD;&#x6B63;&#x6743;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2</span> * N;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], w[M], dist[N], idx;
<span class="hljs-keyword">bool</span> st[N];
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">struct</span> node{
    <span class="hljs-keyword">int</span> x, dist;
};
<span class="hljs-keyword">struct</span> cmp{
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(node a, node b)</span></span>{
        <span class="hljs-keyword">return</span> a.dist &gt; b.dist;
    }
};
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span></span>{
    e[idx] = y, w[idx] = z, ne[idx] = h[x], h[x] = idx ++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dij</span><span class="hljs-params">()</span></span>{
    priority_queue&lt;node, <span class="hljs-built_in">vector</span>&lt;node&gt;, cmp&gt; q;
    q.push({<span class="hljs-number">1</span>, <span class="hljs-number">0</span>});
    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(!q.empty()){
        node t = q.top();
        q.pop();
        <span class="hljs-keyword">if</span>(st[t.x]) <span class="hljs-keyword">continue</span>;
        st[t.x] = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[t.x]; ~ i; i = ne[i]){
            <span class="hljs-keyword">int</span> j = e[i];
            <span class="hljs-keyword">if</span>(dist[j] &gt; dist[t.x] + w[i]){
                dist[j] = dist[t.x] + w[i];
                q.push({j, dist[j]});
            }
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++){
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;
        add(x, y, z);
    }
    dij();
    <span class="hljs-built_in">cout</span> &lt;&lt; (dist[n] &gt; <span class="hljs-number">0x3f3f3f3f</span> / <span class="hljs-number">2</span> ? <span class="hljs-number">-1</span> : dist[n]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    
}
</code></pre>
<p>&#x6734;&#x7D20;&#x7248;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">600</span>;
<span class="hljs-keyword">int</span> a[N][N], bj[N], s[N];
<span class="hljs-keyword">int</span> n, m, x, y, z;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">f</span><span class="hljs-params">()</span> </span>{
    s[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> t = <span class="hljs-number">-1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) {
            <span class="hljs-keyword">if</span> (bj[j] == <span class="hljs-number">0</span> &amp;&amp; (t == <span class="hljs-number">-1</span> || s[j] &lt; s[t])) {
                t = j;
            }
        }
        bj[t] = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) {
            s[j] = min(s[j], s[t] + a[t][j]);
        }

    }
    <span class="hljs-keyword">if</span> (s[n] &gt; <span class="hljs-number">0x3f3f3f3f</span> / <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> s[n];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(a, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> a);
    <span class="hljs-built_in">memset</span>(s, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> s);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;
        a[x][y] = min(a[x][y], z);
    }
    <span class="hljs-keyword">int</span> t = f();
    <span class="hljs-built_in">cout</span> &lt;&lt; t;
}
</code></pre>
<h3 id="bellman-ford">Bellman-ford</h3>
<p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A; n &#x4E2A;&#x70B9; m &#x6761;&#x8FB9;&#x7684;&#x6709;&#x5411;&#x56FE;&#xFF0C;&#x56FE;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x91CD;&#x8FB9;&#x548C;&#x81EA;&#x73AF;&#xFF0C; &#x8FB9;&#x6743;&#x53EF;&#x80FD;&#x4E3A;&#x8D1F;&#x6570;&#x3002;</p>
<p>&#x8BF7;&#x4F60;&#x6C42;&#x51FA;&#x4ECE; 1 &#x53F7;&#x70B9;&#x5230; n &#x53F7;&#x70B9;&#x7684;&#x6700;&#x591A;&#x7ECF;&#x8FC7; k &#x6761;&#x8FB9;&#x7684;&#x6700;&#x77ED;&#x8DDD;&#x79BB;&#xFF0C;&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x4ECE; 1 &#x53F7;&#x70B9;&#x8D70;&#x5230; n &#x53F7;&#x70B9;&#xFF0C;&#x8F93;&#x51FA; impossible&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x56FE;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x8D1F;&#x6743;&#x56DE;&#x8DEF; &#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, M = <span class="hljs-number">10010</span>;
<span class="hljs-keyword">struct</span> Edge{
    <span class="hljs-keyword">int</span> a, b, c;
}edges[M];
<span class="hljs-keyword">int</span> n, m, k, dist[N], last[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bellman_ford</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);
    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i ++ ){
        <span class="hljs-built_in">memcpy</span>(last, dist, <span class="hljs-keyword">sizeof</span> dist);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ ){
            <span class="hljs-keyword">auto</span> e = edges[j];
            dist[e.b] = min(dist[e.b], last[e.a] + e.c);
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ){
        <span class="hljs-keyword">int</span> a, b, c;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);
        edges[i] = {a, b, c};
    }
    bellman_ford();
    <span class="hljs-keyword">if</span> (dist[n] &gt; <span class="hljs-number">0x3f3f3f3f</span> / <span class="hljs-number">2</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, dist[n]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="spfa">Spfa</h3>
<p>&#x8D1F;&#x6743;&#x53EF;&#x4EE5;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">100</span>, M = N;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], w[M], idx, n, m, st[N], dist[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>{
    e[idx] = y, w[idx] = z, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);
    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
    st[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
    q.push(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        st[t] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; ~i; i = ne[i]) {
            <span class="hljs-keyword">int</span> j = e[i];
            <span class="hljs-keyword">if</span> (dist[j] &gt; dist[t] + w[i]) {
                dist[j] = dist[t] + w[i];
                <span class="hljs-keyword">if</span> (!st[j]) {
                    st[j] = <span class="hljs-number">1</span>;
                    q.push(j);
                }
            }
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;
        add(x, y, z);
    }
    spfa();
    <span class="hljs-keyword">if</span> (dist[n] &gt;= <span class="hljs-number">0x3f3f3f3f</span> / <span class="hljs-number">2</span>) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;impossible&quot;</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; dist[n];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="floyd">Floyd</h3>
<p>Floyd&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x4E0D;&#x542B;&#x8D1F;&#x73AF;</p>
<p>1&#xFF1A;&#x6700;&#x77ED;&#x8DEF;</p>
<p>floyd&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E00;&#x79CD;dp&#xFF0C;d[k,i,j]&#x8868;&#x793A;&#x4ECE;i&#x51FA;&#x53D1;&#x5230;&#x8FBE;j&#xFF0C;&#x53EA;&#x7ECF;&#x8FC7;&#x8282;&#x70B9;&#x7F16;&#x53F7;<strong>&#x4E0D;&#x8D85;&#x8FC7;</strong>k&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x3002;</p>
<p>&#x5462;&#x4E48;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#xFF0C;&#x5305;&#x542B;&#x8282;&#x70B9;k&#x548C;&#x4E0D;&#x5305;&#x542B;&#x8282;&#x70B9;k&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x8D1F;&#x73AF;&#xFF0C;&#x6240;&#x4EE5;floyd&#x7B97;&#x7684;&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x4E2D;&#x4E00;&#x5B9A;<strong>&#x6CA1;&#x6709;&#x91CD;&#x590D;&#x70B9;</strong>&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x6709;&#x8D1F;&#x73AF;&#x3002;</p>
<p>&#x5462;&#x4E48;d[k,i,j]=min(d[k-1,i,j],d[k-1,i,k]+d[k-1,k,j];&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x53BB;&#x6389;&#x4E00;&#x7EF4;</p>
<p>d[i,j]=min(d[i,j],d[i,k]+d[k,j]);</p>
<p>&#x6CE8;&#x610F;floyd&#x4E2D;&#x6709;&#x65F6;&#x5019;&#x8981;&#x7528;&#x5230;&#x4E00;&#x4E2A;&#x51FD;&#x6570;memcpy(d,g,sizeof g);//d&#x662F;dist&#x6570;&#x7EC4;&#xFF0C;g&#x662F;&#x539F;&#x56FE;&#xFF0C;</p>
<p>&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x8DD1;&#x6700;&#x77ED;&#x8DEF;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x9762;&#x8DD1;&#xFF0C;&#x540E;&#x9762;&#x53EF;&#x80FD;&#x4F1A;&#x7528;&#x5230;&#x539F;&#x56FE;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-built_in">memset</span>(g,<span class="hljs-number">0x3f</span>,<span class="hljs-keyword">sizeof</span> g);<span class="hljs-comment">//&#x521D;&#x59CB;&#x5316;</span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) g[i][i]=<span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
{
    <span class="hljs-keyword">int</span> x,y,z;
    <span class="hljs-built_in">cin</span>&gt;&gt;x&gt;&gt;y&gt;&gt;z;
    g[x][y]=g[y][x]=min(g[x][y],z);<span class="hljs-comment">//&#x9632;&#x6B62;&#x6709;&#x91CD;&#x8FB9;</span>
}
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k=<span class="hljs-number">1</span>;k&lt;=n;k++)<span class="hljs-comment">//floyd</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;j++)
            <span class="hljs-keyword">if</span>(g[i][j]&gt;g[i][k]+g[k][j])
                g[i][j]=g[i][k]+g[k][j];
</code></pre>
<p>2&#xFF1A;&#x4F20;&#x9012;&#x80CC;&#x5305;&#xFF1A;&#x79BB;&#x6563;&#x6570;&#x5B66;i&#x53EF;&#x4EE5;&#x5230;k&#xFF0C;k&#x53EF;&#x4EE5;&#x5230;j&#xFF0C;&#x5462;&#x4E48;i&#x5C31;&#x53EF;&#x4EE5;&#x5230;j&#x3002;&#x521D;&#x59CB;&#x5316;&#x5316;&#x53EF;&#x4EE5;&#x5230;&#x8FBE;&#x7684;&#x70B9;&#x4E3A;1,&#x4E0D;&#x80FD;&#x5230;&#x8FBE;&#x7684;&#x70B9;&#x4E3A;0&#x3002;</p>
<p>3&#xFF1A;&#x6700;&#x5C0F;&#x73AF;</p>
<p>&#x6211;&#x4EEC;&#x628A;&#x73AF;&#x5206;&#x7C7B;&#xFF0C;&#x6309;&#x7167;&#x73AF;&#x4E2D;&#x6700;&#x5927;&#x8282;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x5206;&#x7C7B;&#x3002;
&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x679A;&#x4E3E;k&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5DF2;&#x7ECF;&#x6C42;&#x5F97;&#x4E86;&#x4EFB;&#x610F;&#x4E24;&#x70B9;&#x53EA;&#x7ECF;&#x8FC7;&#x7F16;&#x53F7;&#x4E3A;1~k-1&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#xFF0C;&#x8FD9;&#x6070;&#x597D;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x6C42;&#x73AF;&#x3002;
&#x73AF;&#x4E00;&#x5B9A;&#x662F;i-k-j&#x8FD9;&#x662F;&#x8FB9;&#xFF0C;&#x7136;&#x540E;j-&#x2026;-i&#xFF0C;&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x53EA;&#x80FD;&#x5305;&#x542B;1~k-1&#xFF0C;&#x5426;&#x5219;&#x73AF;&#x8FD8;&#x53EF;&#x4EE5;&#x66F4;&#x77ED;&#x3002;
&#x6240;&#x4EE5;&#x5F53;k&#x56FA;&#x5B9A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;<strong>&#x679A;&#x4E3E;i&#x548C;j</strong>&#xFF08;i&#x548C;j&#x5E94;&#x8BE5;&#x90FD;&#x5C0F;&#x4E8E;k&#xFF09;&#x3002;
pos[i,j]&#x8868;&#x793A;i&#x5230;j&#x9700;&#x8981;&#x7ECF;&#x8FC7;&#x7684;&#x4E2D;&#x95F4;&#x8282;&#x70B9;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">105</span>;
<span class="hljs-keyword">int</span> g[N][N], pos[N][N], d[N][N];
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; v;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_pos</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span><span class="hljs-comment">//&#x8F93;&#x51FA;x&#x5230;y&#x4E4B;&#x95F4;&#x4E0D;&#x5305;&#x62EC;x&#x548C;y&#x7684;&#x9053;&#x8DEF;</span>
</span>{
    <span class="hljs-keyword">if</span> (pos[x][y] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<span class="hljs-comment">//x&#x548C;y&#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x4E2D;&#x95F4;&#x70B9;</span>
    get_pos(x, pos[x][y]);
    v.push_back(pos[x][y]);
    get_pos(pos[x][y], y);
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-built_in">memset</span>(g, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> g);<span class="hljs-comment">//&#x521D;&#x59CB;&#x5316;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) g[i][i] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;
        g[x][y] = g[y][x] = min(g[x][y], z);
    }
    <span class="hljs-built_in">memcpy</span>(d, g, <span class="hljs-keyword">sizeof</span> g);<span class="hljs-comment">//&#x4E00;&#x4E2A;&#x5B58;&#x56FE;&#xFF0C;&#x4E00;&#x4E2A;&#x8DD1;&#x6700;&#x77ED;&#x8DEF;&#xFF01;&#xFF01;&#xFF01;</span>
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">1e9</span>;
    <span class="hljs-comment">//&#x5982;&#x679C;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x73AF;&#x7684;&#x8BDD;&#xFF0C;&#x5462;&#x4E48;&#x73AF;&#x4E0A;&#x7684;&#x70B9;&#x5FC5;&#x5B9A;&#x4E0D;&#x91CD;&#x590D;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k++) {
        <span class="hljs-comment">//&#x8FD9;&#x91CC;&#x5DF2;&#x7ECF;&#x6C42;&#x5F97;&#x4E86;&#x4ECE;i-&gt;j&#xFF0C;&#x6700;&#x5927;&#x70B9;&#x7F16;&#x53F7;&#x4E3A;k-1&#x7684;&#x6700;&#x77ED;&#x8DEF;</span>
        <span class="hljs-comment">//&#x6211;&#x4EEC;&#x628A;&#x73AF;&#x5206;&#x7C7B;&#xFF0C;&#x4EE5;&#x73AF;&#x4E2D;&#x6700;&#x5927;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x5206;&#x7C7B;,&#x5462;&#x4E48;&#x73AF;&#x4E00;&#x5B9A;&#x662F; i-k-j-...-i&#xFF0C;&#x6CE8;&#x610F;i-k-j&#x4E3A;&#x4E24;&#x4E2A;&#x8FB9;&#xFF0C;</span>
        <span class="hljs-comment">//&#x6211;&#x4EEC;&#x679A;&#x4E3E;i&#x5230;j&#x5C31;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x8981;i-j&#xFF08;&#x53EA;&#x7ECF;&#x8FC7;1~k-1&#x4E2A;&#x70B9;&#xFF09;&#x6700;&#x5C0F;&#x5C31;&#x884C;</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; k; i++)<span class="hljs-comment">//&#x6CE8;&#x610F;&#x8303;&#x56F4;</span>
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; k; j++)<span class="hljs-comment">//i&#x548C;j&#x4E0D;&#x76F8;&#x540C;</span>
            {
                <span class="hljs-keyword">if</span> (ans &gt; (<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>) d[i][j] + g[i][k] + g[k][j])<span class="hljs-comment">//&#x6709;&#x53EF;&#x80FD;0x3f3f3f3f&#x7D2F;&#x52A0;&#x7206;int</span>
                {
                    v.clear();
                    ans = d[i][j] + g[i][k] + g[k][j];
                    v.push_back(i);
                    v.push_back(k);
                    v.push_back(j);
                    get_pos(j, i);
                }
            }
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) {
                <span class="hljs-keyword">if</span> (d[i][j] &gt; d[i][k] + d[k][j]) {
                    d[i][j] = d[i][k] + d[k][j];
                    pos[i][j] = k;
                }
            }
        }
    }
    <span class="hljs-keyword">if</span> (ans == <span class="hljs-number">1e9</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No solution.&quot;</span>);
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> i: v) {
            <span class="hljs-built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>4&#xFF1A;&#x6070;&#x597D;&#x7ECF;&#x8FC7;k&#x6761;&#x8FB9;&#x7684;&#x6700;&#x77ED;&#x8DEF;</p>
<h2 id="&#x5224;&#x8D1F;&#x73AF;">&#x5224;&#x8D1F;&#x73AF;</h2>
<p>&#xFF08;1&#xFF09;&#x7531;&#x4E8E;&#x8D1F;&#x73AF;&#x53EF;&#x80FD;&#x5E76;&#x4E0D;&#x5305;&#x542B;1&#x53F7;&#x70B9;&#xFF0C;&#x6216;&#x8005;&#x56FE;&#x4E0D;&#x8FDE;&#x901A;&#x3002;&#x6240;&#x4EE5;&#x8981;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#xFF0C;&#x4ECE;&#x8FD9;&#x4E2A;&#x70B9;&#x5411;&#x5404;&#x4E2A;&#x70B9;&#x8FDE;&#x4E00;&#x6761;&#x8FB9;&#x6743;&#x662F;0&#x7684;&#x8FB9;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;Spfa&#x7684;&#x7B2C;&#x4E00;&#x6B21;&#x51FA;&#x961F;&#x66F4;&#x65B0;&#xFF0C;&#x8FD9;&#x7B49;&#x4EF7;&#x4E8E;&#x521D;&#x59CB;&#x5C31;&#x5C06;&#x6240;&#x6709;&#x70B9;&#x5165;&#x961F;&#x3002;</p>
<p><strong>&#xFF08;2&#xFF09;&#x6240;&#x4EE5;&#x5F53;&#x5B58;&#x5728;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6C42;&#x8D1F;&#x73AF;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x5C06;&#x6240;&#x6709;&#x70B9;&#x5168;&#x90E8;&#x5165;&#x961F;&#x4E86;&#x3002;</strong></p>
<p>&#xFF08;3&#xFF09;&#x6C42;&#x8D1F;&#x73AF;&#x6216;&#x8005;&#x6B63;&#x73AF;&#xFF0C;&#x4E0E;dist[i]&#x521D;&#x59CB;&#x503C;&#x65E0;&#x5173;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x8D1F;&#x73AF;dist&#x5C31;&#x4F1A;&#x88AB;&#x4E0D;&#x65AD;&#x66F4;&#x65B0;&#x4E3A;&#x8D1F;&#x65E0;&#x7A77;&#xFF0C;&#x53CD;&#x4E4B;&#x4E3A;&#x6B63;&#x65E0;&#x7A77;&#x3002;&#x4F46;&#x662F;&#x6C42;&#x6700;&#x77ED;&#x8DEF;&#x987A;&#x4FBF;&#x5224;&#x65AD;&#x8D1F;&#x73AF;&#x7684;&#x65F6;&#x5019;&#xFF0C;dist[i]&#x8BBE;&#x4E3A;&#x6B63;&#x65E0;&#x7A77;&#x3002;&#x6C42;&#x6700;&#x957F;&#x8DEF;&#x987A;&#x4FBF;&#x5224;&#x65AD;&#x6B63;&#x73AF;&#x7684;&#x65F6;&#x5019;&#xFF0C;dist[i]&#x8BBE;&#x4E3A;&#x8D1F;&#x65E0;&#x7A77;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">100</span>, M = N;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], w[M], idx, n, m, st[N], dist[N], cnt[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>{
    e[idx] = y, w[idx] = z, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        q.push(i);
        st[i] = <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        st[t] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; ~i; i = ne[i]) {
            <span class="hljs-keyword">int</span> j = e[i];
            <span class="hljs-keyword">if</span> (dist[j] &gt; dist[t] + w[i]) {
                dist[j] = dist[t] + w[i];
                cnt[j] = cnt[t] + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span> (cnt[j] &gt;= n) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">if</span> (!st[j]) {
                    st[j] = <span class="hljs-number">1</span>;
                    q.push(j);
                }
            }
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y, z;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; z;
        add(x, y, z);
    }
    <span class="hljs-keyword">if</span> (spfa()) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x5DEE;&#x5206;&#x7EA6;&#x675F;">&#x5DEE;&#x5206;&#x7EA6;&#x675F;</h2>
<p>&#x53EA;&#x8981;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x70B9;&#x53EF;&#x4EE5;&#x8D70;&#x5230;&#x6240;&#x6709;&#x70B9;&#xFF0C;&#x5462;&#x4E48;&#x4E00;&#x5B9A;&#x53EF;&#x4EE5;&#x8D70;&#x5230;&#x6240;&#x6709;&#x8FB9;&#x3002;</p>
<p>&#x5F53;&#x5EFA;&#x7ACB;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#x7684;&#x8FB9;&#x6743;&#x4E3A;0&#x65F6;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;&#x5C06;&#x6240;&#x6709;&#x70B9;&#x5165;&#x961F;&#x3002;&#x8FB9;&#x6743;&#x4E0D;&#x4E3A;0&#x8FD8;&#x662F;&#x5F97;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#x3002;</p>
<p>&#x6709;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#x4E86;&#xFF0C;&#x5224;&#x65AD;&#x8D1F;&#x73AF;&#x4E0D;&#x9700;&#x8981;&#x5C06;&#x6240;&#x6709;&#x70B9;&#x5165;&#x961F;&#xFF0C;&#x8FD9;&#x4E2A;&#x8D85;&#x7EA7;&#x6E90;&#x70B9;&#x53EF;&#x80FD;&#x662F;&#x9898;&#x76EE;&#x4E2D;&#x6709;&#xFF0C;&#x6216;&#x8005;&#x4F60;&#x81EA;&#x5DF1;&#x5EFA;&#x7ACB;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6240;&#x6709;&#x8FB9;&#x6743;&#x90FD;&#x662F;&gt;=0&#xFF0C;&#x5E76;&#x4E14;&#x8981;&#x6C42;&#x6700;&#x957F;&#x8DEF;&#xFF0C;&#x5462;&#x4E48;&#x53EF;&#x4EE5;&#x7528;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x89E3;&#x51B3;&#xFF0C;&#x6B63;&#x73AF;&#x7B49;&#x4EF7;&#x4E8E;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x4E0D;&#x5B58;&#x518D;&#x4E00;&#x6761;&gt;0&#x7684;&#x8FB9;</p>
<h2 id="&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148;">&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148;</h2>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2</span> * N, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx, root, n, m;
<span class="hljs-keyword">int</span> f[N][<span class="hljs-number">18</span>], depth[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx ++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> fa)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]){
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span>(j == fa) <span class="hljs-keyword">continue</span>;
        depth[j] = depth[u] + <span class="hljs-number">1</span>;
        f[j][<span class="hljs-number">0</span>] = u;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">17</span>; k ++){
            f[j][k] = f[f[j][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>];
        }
        dfs(j, u);
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>{
    <span class="hljs-keyword">if</span>(depth[x] &lt; depth[y]) swap(x, y);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">17</span>; k &gt;= <span class="hljs-number">0</span>; k --){
        <span class="hljs-keyword">if</span>(depth[f[x][k]] &gt;= depth[y]){
            x = f[x][k];
        }
    }
    <span class="hljs-keyword">if</span>(x == y) <span class="hljs-keyword">return</span> x;
    <span class="hljs-comment">//&#x6CA1;&#x6709;depth&#x4E86;</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">17</span>; k &gt;= <span class="hljs-number">0</span>; k --){
        <span class="hljs-keyword">if</span>(f[x][k] != f[y][k]){
            x = f[x][k];
            y = f[y][k];
        }
    }
    <span class="hljs-keyword">return</span> f[x][<span class="hljs-number">0</span>];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++){
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        <span class="hljs-keyword">if</span>(y == <span class="hljs-number">-1</span>) {
            root = x;
            <span class="hljs-keyword">continue</span>;
        }
        add(x, y), add(y, x);
    }
    depth[root] = <span class="hljs-number">1</span>;
    dfs(root, <span class="hljs-number">-1</span>);
    <span class="hljs-built_in">cin</span> &gt;&gt; m;
    <span class="hljs-keyword">while</span>(m --){
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        <span class="hljs-keyword">int</span> z = lca(x, y);
        <span class="hljs-keyword">if</span>(z == x) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(z == y) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6811;&#x4E0A;&#x5DEE;&#x5206;">&#x6811;&#x4E0A;&#x5DEE;&#x5206;</h2>
<p>&#x5C06;a&#x5230;b&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x8FB9;&#x5168;&#x90E8;+c&#xFF0C;&#x53EF;&#x4EE5;&#x5148;d[a]+=c&#xFF0C;d[b]+=c , d[lca(a,b)]-=2c;</p>
<p>&#x6700;&#x540E;&#x5728;&#x4E00;&#x904D;dfs&#x6C42;&#x51FA;&#x6700;&#x7EC8;&#x7684;&#x5404;&#x8FB9;&#x6743;&#x503C;</p>
<p>&#x4EE5;x&#x8282;&#x70B9;&#x4E3A;&#x6839;&#xFF0C;&#x5B50;&#x6811;&#x7684;&#x70B9;&#x6743;&#x503C;&#x4E4B;&#x548C;&#x5C31;&#x662F;x&#x8282;&#x70B9;&#x4E0E;&#x4E4B;&#x7236;&#x8282;&#x70B9;&#x7684;&#x8FB9;&#x6743;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">2</span> * N;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;
<span class="hljs-keyword">int</span> depth[N], d[N], f[N][<span class="hljs-number">18</span>];
<span class="hljs-keyword">int</span> n, m;
LL ans;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(depth, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> depth);
    depth[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>, depth[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;
    q.push(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">while</span> (!q.empty()) {
        <span class="hljs-keyword">int</span> t = q.front();
        q.pop();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; ~i; i = ne[i]) {
            <span class="hljs-keyword">int</span> j = e[i];
            <span class="hljs-keyword">if</span> (depth[j] &gt; depth[t] + <span class="hljs-number">1</span>) {
                depth[j] = depth[t] + <span class="hljs-number">1</span>;
                q.push(j);
                f[j][<span class="hljs-number">0</span>] = t;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">17</span>; k++) {
                    f[j][k] = f[f[j][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>];
                }
            }
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    <span class="hljs-keyword">if</span> (depth[x] &lt; depth[y]) swap(x, y);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">17</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">if</span> (depth[f[x][i]] &gt;= depth[y]) {
            x = f[x][i];
        }
    }
    <span class="hljs-keyword">if</span> (x == y) <span class="hljs-keyword">return</span> x;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">17</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
        <span class="hljs-keyword">if</span> (f[x][i] != f[y][i]) {
            x = f[x][i];
            y = f[y][i];
        }
    }
    <span class="hljs-keyword">return</span> f[x][<span class="hljs-number">0</span>];
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> fa)</span> </span>{
    LL res = d[x];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[x]; ~i; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (j != fa) {
            res += dfs(j, x);
        }
    }
    <span class="hljs-keyword">if</span> (x == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (res == <span class="hljs-number">0</span>) ans += m;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (res == <span class="hljs-number">1</span>) ans += <span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> res;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(x, y), add(y, x);
    }
    bfs();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        d[x]++, d[y]++, d[lca(x, y)] -= <span class="hljs-number">2</span>;
    }
    dfs(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;">&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;</h2>
<p>&#x6709;&#x5411;&#x56FE;</p>
<p>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x7EBF;&#x6027;</p>
<p>&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x4E00;&#x5B9A;&#x6709;&#x73AF;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x4E00;&#x5B9A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x73AF;</p>
<p>&#x73AF;&#x4E00;&#x5B9A;&#x662F;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;</p>
<pre><code class="lang-c++"><span class="hljs-comment">/*
1. &#x52A0;&#x65F6;&#x95F4;&#x6233;&#xFF1B;
2. &#x653E;&#x5165;&#x6808;&#x4E2D;&#xFF0C;&#x505A;&#x597D;&#x6807;&#x8BB0;&#xFF1B;
3. &#x904D;&#x5386;&#x90BB;&#x70B9;
    1&#xFF09;&#x5982;&#x679C;&#x6CA1;&#x904D;&#x5386;&#x8FC7;&#xFF0C;tarjan&#x4E00;&#x904D;&#xFF0C;&#x7528;low[j]&#x66F4;&#x65B0;&#x6700;&#x5C0F;&#x503C;low
    2) &#x5982;&#x679C;&#x5728;&#x6808;&#x4E2D;&#xFF0C;&#x7528;dfn[j]&#x66F4;&#x65B0;&#x6700;&#x5C0F;&#x503C;low
4.&#x627E;&#x5230;&#x6700;&#x9AD8;&#x70B9;
    1&#xFF09;scc&#x4E2A;&#x6570;++
    2&#xFF09;do-while&#x5FAA;&#x73AF;&#xFF1A;
        &#x4ECE;&#x6808;&#x4E2D;&#x53D6;&#x51FA;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF1B;&#x6807;&#x5FD7;&#x4E3A;&#x51FA;&#x6808;&#xFF1B;
        &#x5BF9;&#x5143;&#x7D20;&#x505A;&#x597D;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;scc&#xFF1B;&#x8BE5;scc&#x4E2D;&#x70B9;&#x7684;&#x6570;&#x91CF;++
*/</span>
<span class="hljs-comment">// tarjan &#x7B97;&#x6CD5;&#x6C42;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;</span>
<span class="hljs-comment">// &#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;O(n+ m)</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span>{
    <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x81EA;&#x5DF1;&#x7684;&#x65F6;&#x95F4;&#x6233;</span>
    dfn[u] = low[u] = ++ timestamp;
    <span class="hljs-comment">//&#x5C06;&#x8BE5;&#x70B9;&#x653E;&#x5165;&#x6808;&#x4E2D;</span>
    stk[++ top] = u, in_stk[u] = <span class="hljs-literal">true</span>;
    <span class="hljs-comment">// &#x904D;&#x5386;&#x548C;u&#x8FDE;&#x901A;&#x7684;&#x70B9;</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]){
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span>(!dfn[j]){
            tarjan(j);
            <span class="hljs-comment">// &#x66F4;&#x65B0;u&#x6240;&#x80FD;&#x904D;&#x5386;&#x5230;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x7684;&#x6700;&#x5C0F;&#x503C;</span>
            low[u] = min(low[u], low[j]);
        }
        <span class="hljs-comment">// &#x5982;&#x679C;&#x5F53;&#x524D;&#x70B9;&#x5728;&#x6808;&#x4E2D;</span>
        <span class="hljs-comment">//&#x6CE8;&#x610F;&#x6808;&#x4E2D;&#x5B58;&#x7684;&#x53EF;&#x80FD;&#x662F;&#x6811;&#x4E2D;&#x51E0;&#x4E2A;&#x4E0D;&#x540C;&#x5206;&#x652F;&#x7684;&#x70B9;,&#x56E0;&#x4E3A;&#x6709;&#x6A2A;&#x53C9;&#x8FB9;&#x5B58;&#x5728;</span>
        <span class="hljs-comment">// &#x6808;&#x4E2D;&#x5B58;&#x7684;&#x6240;&#x6709;&#x70B9;&#xFF0C;&#x662F;&#x8FD8;&#x6CA1;&#x641C;&#x5B8C;&#x7684;&#x70B9;&#xFF0C;&#x540C;&#x65F6;&#x90FD;&#x4E0D;&#x662F;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7684;&#x6700;&#x9AD8;&#x70B9;</span>
        <span class="hljs-comment">// &#x8FD9;&#x91CC;&#x8868;&#x793A;&#x5F53;&#x524D;&#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x8FD8;&#x6CA1;&#x6709;&#x904D;&#x5386;&#x5B8C;&#xFF0C;&#x5373;&#x6808;&#x4E2D;&#x6709;&#x503C;</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(in_stk[j])
            <span class="hljs-comment">//&#x66F4;&#x65B0;&#x4E00;&#x4E0B;u&#x70B9;&#x6240;&#x80FD;&#x5230;&#x7684;&#x6700;&#x5C0F;&#x7684;&#x65F6;&#x95F4;&#x6233;</span>
            <span class="hljs-comment">//&#x6B64;&#x65F6;j&#x8981;&#x4E48;&#x662F;u&#x7684;&#x7956;&#x5148;&#xFF0C;&#x8981;&#x4E48;&#x662F;&#x6A2A;&#x53C9;&#x8FB9;&#x7684;&#x70B9;&#xFF0C;&#x65F6;&#x95F4;&#x6233;&#x5C0F;&#x4E8E;u</span>
            low[u] = min(low[u], dfn[j]);
    }
    <span class="hljs-comment">// &#x627E;&#x5230;&#x8BE5;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7684;&#x6700;&#x9AD8;&#x70B9;</span>
    <span class="hljs-keyword">if</span>(dfn[u] == low[u]){
        <span class="hljs-keyword">int</span> y;
        ++ scc_cnt; <span class="hljs-comment">// &#x5F3A;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7684;&#x4E2A;&#x6570;++</span>
        <span class="hljs-keyword">do</span>{<span class="hljs-comment">// &#x53D6;&#x51FA;&#x6765;&#x8BE5;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7684;&#x6240;&#x6709;&#x70B9;</span>
            y = stk[top --];
            in_stk[y] = <span class="hljs-literal">false</span>;
            id[y] = scc_cnt; <span class="hljs-comment">// &#x6807;&#x8BB0;&#x70B9;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;&#x8FDE;&#x901A;&#x5206;&#x91CF;</span>
            size_scc[scc_cnt] ++;
        } <span class="hljs-keyword">while</span>(y != u);
    }
}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e4</span> + <span class="hljs-number">100</span>, M = <span class="hljs-number">5e4</span> + <span class="hljs-number">100</span>;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx, n, m;
<span class="hljs-keyword">int</span> timestamp, dfn[N], low[N], scc_size[N], id[N], scc_cnt, dout[N];
<span class="hljs-keyword">bool</span> in_stk[N];
<span class="hljs-built_in">stack</span>&lt;<span class="hljs-keyword">int</span>&gt; stk;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    dfn[u] = low[u] = ++timestamp;
    stk.push(u), in_stk[u] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (!dfn[j]) {
            tarjan(j);
            low[u] = min(low[j], low[u]);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (in_stk[j]) {
            low[u] = min(low[u], dfn[j]);
        }
    }
    <span class="hljs-keyword">if</span> (dfn[u] == low[u]) {
        <span class="hljs-keyword">int</span> y;
        scc_cnt++;
        <span class="hljs-keyword">do</span> {
            y = stk.top();
            stk.pop();
            in_stk[y] = <span class="hljs-literal">false</span>;
            id[y] = scc_cnt;
            scc_size[scc_cnt]++;
        } <span class="hljs-keyword">while</span> (y != u);
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(x, y);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (!dfn[i]) tarjan(i);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = h[i]; ~j; j = ne[j]) {
            <span class="hljs-keyword">int</span> x = id[i], y = id[e[j]];
            <span class="hljs-keyword">if</span> (x != y) {
                dout[x]++;
            }
        }
    }
    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>, nb;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= scc_cnt; i++) {
        <span class="hljs-keyword">if</span> (!dout[i]) {
            sum++;
            nb = i;
        }
    }
    <span class="hljs-keyword">if</span> (sum == <span class="hljs-number">1</span>) <span class="hljs-built_in">cout</span> &lt;&lt; scc_size[nb];
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x7F29;&#x70B9;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e4</span> + <span class="hljs-number">100</span>, M = <span class="hljs-number">2e5</span> + <span class="hljs-number">100</span>;<span class="hljs-comment">//&#x8BB0;&#x5F97;&#x8FB9;&#x6570;&#x7FFB;&#x4E24;&#x500D;</span>
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx, n, m;
<span class="hljs-keyword">int</span> hh[N];
<span class="hljs-keyword">int</span> dfn[N], low[N], in_stk[N], timestamp, scc_cnt, scc_value[N], a[N], f[N], id[N];
<span class="hljs-built_in">stack</span>&lt;<span class="hljs-keyword">int</span>&gt; s;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> h[], <span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    dfn[u] = low[u] = ++timestamp;
    s.push(u);
    in_stk[u] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (!dfn[j]) {
            tarjan(j);
            low[u] = min(low[u], low[j]);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (in_stk[j]) {
            low[u] = min(low[u], dfn[j]);
        }
    }
    <span class="hljs-keyword">if</span> (dfn[u] == low[u]) {
        <span class="hljs-keyword">int</span> y;
        scc_cnt++;
        <span class="hljs-keyword">do</span> {
            y = s.top();
            s.pop();
            in_stk[y] = <span class="hljs-number">0</span>;
            id[y] = scc_cnt;
            scc_value[scc_cnt] += a[y];
        } <span class="hljs-keyword">while</span> (y != u);
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">memset</span>(hh, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> hh);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(h, x, y);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (!dfn[i]) tarjan(i);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = h[i]; ~j; j = ne[j]) {
            <span class="hljs-keyword">int</span> x = i, y = e[j];
            <span class="hljs-keyword">if</span> (id[x] != id[y]) {
                add(hh, id[x], id[y]);
            }
        }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= scc_cnt; i++) {
        f[i] = scc_value[i];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = scc_cnt; i &gt;= <span class="hljs-number">1</span>; i--) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = hh[i]; ~j; j = ne[j]) {
            <span class="hljs-keyword">int</span> k = e[j];
            f[k] = max(f[k], f[i] + scc_value[k]);
        }
    }
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">-0x3f3f3f3f</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= scc_cnt; i++) {
        ans = max(ans, f[i]);
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x53CC;&#x8054;&#x901A;&#x5206;&#x91CF;">&#x53CC;&#x8054;&#x901A;&#x5206;&#x91CF;</h2>
<p>&#x65E0;&#x5411;&#x56FE;</p>
<p>&#x5272;&#x8FB9;&#xFF08;&#x6865;&#xFF09;</p>
<p>&#x8FB9;&#x7684;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF; &#xFF1A; &#x6781;&#x5927;&#x7684;&#x4E0D;&#x5305;&#x542B;&#x6865;&#x7684;&#x8FDE;&#x901A;&#x5757;</p>
<p>&#x8FB9;&#x7684;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF; &lt;=&gt; &#x4EFB;&#x4F55;&#x4E24;&#x4E2A;&#x70B9;&#x4E4B;&#x95F4;&#x81F3;&#x5C11;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x4E0D;&#x76F8;&#x4EA4;&#x8DEF;&#x5F84;</p>
<p>x&#x548C;y&#x4E4B;&#x95F4;&#x662F;&#x6865; &lt;=&gt; low[y] &gt;dfn[x]   y&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x5F80;&#x4E0A;&#x8D70;&#x4E0D;&#x5230;x </p>
<p>&#x5C06;&#x4E00;&#x4E2A;&#x56FE;&#x53D8;&#x4E3A;&#x8FB9;&#x7684;&#x53CC;&#x8054;&#x901A;&#x5206;&#x91CF;&#x6700;&#x5C11;&#x8981;&#x6DFB;&#x52A0;&#x51E0;&#x6761;&#x8FB9;&#xFF1A;&#x7F29;&#x70B9;&#x540E;&#xFF0C;&#xFF08;&#x5EA6;&#x4E3A;1&#x7684;&#x70B9;&#x7684;&#x4E2A;&#x6570;+1&#xFF09;/2&#x5411;&#x4E0B;&#x53D6;&#x6574;</p>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> from)</span>
</span>{
    dfn[u] = low[u] = ++ timestamp;
    stk[ ++ top] = u;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; i!=<span class="hljs-number">-1</span>; i = ne[i])
    {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (!dfn[j])<span class="hljs-comment">//j&#x672A;&#x904D;&#x5386;&#x8FC7;</span>
        {
            tarjan(j, i);<span class="hljs-comment">//dfs(j)</span>
            low[u] = min(low[u], low[j]);<span class="hljs-comment">//&#x7528;j&#x66F4;&#x65B0;u</span>
            <span class="hljs-keyword">if</span> (dfn[u] &lt; low[j])<span class="hljs-comment">//j&#x5230;&#x4E0D;&#x4E86;u</span>
                <span class="hljs-comment">// &#x5219;x-y&#x7684;&#x8FB9;&#x4E3A;&#x6865;,</span>
                <span class="hljs-comment">//&#x6B63;&#x5411;&#x8FB9;is_bridge[i] &#x53CD;&#x5411;&#x8FB9;is_bridge[i ^ 1]&#x90FD;&#x662F;&#x6865;</span>
                is_bridge[i] = is_bridge[i ^ <span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;
                <span class="hljs-comment">// &#x8FD9;&#x91CC;i==idx &#x5982;&#x679C;idx==&#x5947;&#x6570; &#x5219;&#x53CD;&#x5411;&#x8FB9;=idx-1 = idx^1</span>
                <span class="hljs-comment">//            &#x5982;&#x679C;idx==&#x5076;&#x6570; &#x5219;&#x53CD;&#x5411;&#x8FB9;=idx+1 = idx^1</span>
        }
        <span class="hljs-comment">// j&#x904D;&#x5386;&#x8FC7; &#x4E14;i&#x4E0D;&#x662F;&#x53CD;&#x5411;&#x8FB9;(&#x5373;i&#x4E0D;&#x662F;&#x6307;&#x5411;u&#x7684;&#x7236;&#x8282;&#x70B9;&#x7684;&#x8FB9;)</span>
        <span class="hljs-comment">// &#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x7528;u&#x7684;&#x7236;&#x8282;&#x70B9;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x66F4;&#x65B0;u</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i != (from ^ <span class="hljs-number">1</span>))<span class="hljs-comment">//&#x4E0D;&#x80FD;&#x5F80;&#x56DE;</span>
            low[u] = min(low[u], dfn[j]);
    }
    <span class="hljs-keyword">if</span> (dfn[u] == low[u])
    {
        ++ dcc_cnt;
        <span class="hljs-keyword">int</span> y;
        <span class="hljs-keyword">do</span> {
            y = stk[top -- ];
            id[y] = dcc_cnt;
        } <span class="hljs-keyword">while</span> (y != u);
    }
}
</code></pre>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5010</span>, M = <span class="hljs-number">20010</span>;
<span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx, n, m;
<span class="hljs-keyword">int</span> dfn[N], low[N], id[N], dcc_cnt, timestamp;
<span class="hljs-built_in">stack</span>&lt;<span class="hljs-keyword">int</span>&gt; stk;
<span class="hljs-keyword">bool</span> is_bridge[M];
<span class="hljs-keyword">int</span> d[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> from)</span><span class="hljs-comment">//from&#x8868;&#x793A;&#x4ECE;&#x54EA;&#x4E2A;&#x8FB9;&#x6765;&#x7684;</span>
</span>{
    dfn[u] = low[u] = ++timestamp;
    stk.push(u);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (!dfn[j]) {
            tarjan(j, i);
            low[u] = min(low[u], low[j]);
            <span class="hljs-keyword">if</span> (low[j] &gt; dfn[u]) is_bridge[i] = is_bridge[i ^ <span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<span class="hljs-comment">//j&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x4E5F;&#x8D70;&#x4E0D;&#x5230;u&#xFF0C;&#x8BF4;&#x660E;&#x53EA;&#x6709;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#xFF0C;&#x662F;&#x5272;&#x8FB9;&#xFF08;&#x6865;&#xFF09;</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i != (from ^ <span class="hljs-number">1</span>))<span class="hljs-comment">//&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x5F80;&#x56DE;&#x66F4;&#x65B0;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x53EA;&#x80FD;&#x5F80;&#x4E0B;</span>
        {
            low[u] = min(low[u], dfn[j]);
        }
    }
    <span class="hljs-keyword">if</span> (low[u] == dfn[u]) {
        <span class="hljs-keyword">int</span> y;
        dcc_cnt++;
        <span class="hljs-keyword">do</span> {
            y = stk.top();
            stk.pop();
            id[y] = dcc_cnt;
        } <span class="hljs-keyword">while</span> (y != u);
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) {
        <span class="hljs-keyword">int</span> x, y;
        <span class="hljs-built_in">cin</span> &gt;&gt; x &gt;&gt; y;
        add(x, y), add(y, x);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (!dfn[i]) tarjan(i, <span class="hljs-number">-1</span>);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; idx; i += <span class="hljs-number">2</span>)<span class="hljs-comment">//&#x7F29;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x5FC5;&#x8981;&#x771F;&#x7684;&#x7F29;&#x70B9;&#xFF0C;i+=2&#x9632;&#x6B62;&#x91CD;&#x590D;&#x8BA1;&#x7B97;</span>
    {
        <span class="hljs-keyword">if</span> (is_bridge[i])<span class="hljs-comment">//i&#x662F;&#x6865;&#x7684;&#x8BDD;</span>
        {
            d[id[e[i]]]++;
            d[id[e[i ^ <span class="hljs-number">1</span>]]]++;
        }
    }
    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= dcc_cnt; i++) {
        <span class="hljs-keyword">if</span> (d[i] == <span class="hljs-number">1</span>) sum++;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; (sum + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-built_in">endl</span>;<span class="hljs-comment">//&#x7ED3;&#x8BBA;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x4E8C;&#x5206;&#x56FE;">&#x4E8C;&#x5206;&#x56FE;</h2>
<h3 id="&#x5224;&#x65AD;">&#x5224;&#x65AD;</h3>
<p>&#x4E8C;&#x5206;&#x56FE;&#x5B58;&#x5728;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#x662F;&#x6CA1;&#x6709;&#x5947;&#x6570;&#x8FB9;&#x7684;&#x73AF;&#xFF0C;&#x4E8C;&#x5206;&#x56FE;&#x4E00;&#x822C;&#x6307;&#x7684;&#x90FD;&#x662F;&#x65E0;&#x5411;&#x56FE;</p>
<p>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#xFF1A;$O(n+m)$</p>
<p>&#x68CB;&#x76D8;&#x95EE;&#x9898;&#xFF0C;&#x5F88;&#x591A;&#x90FD;&#x662F;&#x4E8C;&#x5206;&#x56FE;&#xFF0C;$(i+j)$&#x4E3A;&#x5076;&#x6570;&#x67D3;&#x6210;1&#xFF0C;&#x4E3A;&#x5947;&#x6570;&#x67D3;&#x6210;2</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>;
<span class="hljs-keyword">int</span> h[N], e[N], ne[N], col[N], idx, n, m, x, y;<span class="hljs-comment">//col&#x4E2D;&#xFF0C;0&#x8868;&#x793A;&#x672A;&#x67D3;&#x8272;&#xFF0C;1,2&#x8868;&#x793A;&#x4E24;&#x79CD;&#x989C;&#x8272;</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y;
    ne[idx] = h[x];
    h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> q)</span><span class="hljs-comment">//x&#x8868;&#x793A;&#x6B63;&#x5728;&#x641C;&#x7D22;&#x54EA;&#x4E2A;&#x70B9;&#xFF0C;q&#x8868;&#x793A;&#x8981;&#x67D3;&#x8272;&#x7684;&#x989C;&#x8272;</span>
</span>{

    col[x] = q;<span class="hljs-comment">//&#x67D3;&#x8272;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[x]; i != <span class="hljs-number">-1</span>; i = ne[i]) {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (col[j] == <span class="hljs-number">0</span>)<span class="hljs-comment">//&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x70B9;&#x6CA1;&#x88AB;&#x67D3;&#x8FC7;&#x8272;&#x7684;&#x8BDD;</span>
        {
            <span class="hljs-keyword">if</span> (dfs(j, <span class="hljs-number">3</span> - q) == <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//&#x5BF9;&#x8FD9;&#x4E2A;&#x70B9;&#x67D3;&#x8272;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;false</span>
        }<span class="hljs-comment">//3-q&#x53EF;&#x4EE5;&#x8BA9;1&#x548C;2&#x76F8;&#x4E92;&#x8F6C;&#x5316;</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (col[j] == q) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//&#x8FD9;&#x4E2A;&#x70B9;&#x5DF2;&#x7ECF;&#x88AB;&#x67D3;&#x8FC7;&#x4E86;&#xFF0C;&#x5E76;&#x4E14;&#x989C;&#x8272;&#x548C;&#x7236;&#x8282;&#x70B9;&#x76F8;&#x540C;</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//&#x4E0D;&#x77DB;&#x76FE;&#xFF0C;&#x67D3;&#x8272;&#x6210;&#x529F;</span>
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);
        add(x, y), add(y, x);
    }
    <span class="hljs-keyword">int</span> flag = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (col[i] == <span class="hljs-number">0</span>)<span class="hljs-comment">//&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x70B9;&#x6CA1;&#x88AB;&#x67D3;&#x8FC7;&#x8272;&#x7684;&#x8BDD;&#xFF0C;&#x76F4;&#x63A5;&#x67D3;&#x8272;</span>
        {
            <span class="hljs-keyword">if</span> (dfs(i, <span class="hljs-number">1</span>) == <span class="hljs-literal">false</span>)<span class="hljs-comment">//&#x6709;&#x4E00;&#x4E2A;&#x70B9;&#x67D3;&#x8272;&#x5931;&#x8D25;&#xFF08;&#x53D1;&#x751F;&#x77DB;&#x76FE;&#xFF09;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;break</span>
            {
                flag = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;
            }
        }
    }
    <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">0</span>) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
}
</code></pre>
<h3 id="&#x6700;&#x5927;&#x5339;&#x914D;">&#x6700;&#x5927;&#x5339;&#x914D;</h3>
<p>&#x589E;&#x5E7F;&#x8DEF;&#x5F84;&#xFF0C;&#x4ECE;&#x4E00;&#x4E2A;&#x975E;&#x5339;&#x914D;&#x70B9;&#x51FA;&#x53D1;&#xFF0C;&#x4F9D;&#x6B21;&#x8D70;&#x975E;&#x5339;&#x914D;&#x8FB9;&#x3001;&#x5339;&#x914D;&#x8FB9;&#x3001;&#x975E;&#x5339;&#x914D;&#x8FB9;&#x3001;&#x5339;&#x914D;&#x8FB9;&#xFF0C;&#x6700;&#x540E;&#x8D70;&#x5230;&#x4E00;&#x4EFD;&#x975E;&#x5339;&#x914D;&#x8FB9;&#x7684;&#x7B97;&#x6CD5;</p>
<p>&#x4E8C;&#x5206;&#x56FE;&#x7684;&#x6700;&#x5927;&#x5339;&#x914D;&#x7B49;&#x4EF7;&#x4E8E;&#x4E0D;&#x5B58;&#x5728;&#x589E;&#x5E7F;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x5B9E;&#x9645;&#x590D;&#x6742;&#x7684;$O(n<em>m)$,&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x590D;&#x6742;&#x5EA6;&#x8FDC;&#x5C0F;&#x4E8E;$O(n</em>m)$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<span class="hljs-comment">//match&#x653E;&#x7684;&#x662F;&#x5973;&#x670B;&#x53CB;&#x5BF9;&#x5E94;&#x7684;&#x7537;&#x670B;&#x53CB;&#x662F;&#x8C01;&#xFF0C;bj&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x7537;&#x751F;&#x91CD;&#x590D;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x4EBA;</span>
<span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx, bj[N], match[N], n1, n2, m, x, y, ans;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>{
    e[idx] = y, ne[idx] = h[x], h[x] = idx++;
}
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[x]; i != <span class="hljs-number">-1</span>; i = ne[i])<span class="hljs-comment">//&#x904D;&#x5386;&#x4E0E;&#x8FD9;&#x540D;&#x7537;&#x751F;&#x76F8;&#x8054;&#x7CFB;&#x7684;&#x5973;&#x751F;</span>
    {
        <span class="hljs-keyword">int</span> j = e[i];
        <span class="hljs-keyword">if</span> (bj[j] == <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">//&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x5973;&#x751F;&#x5DF2;&#x7ECF;&#x5339;&#x914D;&#x8FC7;&#x4E86;&#xFF0C;&#x5C31;&#x4E0D;&#x5728;&#x5339;&#x914D;&#x4E86;</span>
        bj[j] = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (match[j] == <span class="hljs-number">0</span> || find(match[j]) == <span class="hljs-literal">true</span>)<span class="hljs-comment">//&#x5982;&#x679C;&#x5973;&#x751F;&#x6CA1;&#x6709;&#x5BF9;&#x8C61;&#xFF0C;&#x6216;&#x8005;&#x5973;&#x751F;&#x7684;&#x5BF9;&#x8C61;&#x8FD8;&#x53EF;&#x4EE5;&#x5339;&#x914D;&#x53E6;&#x4E00;&#x4E2A;&#x5973;&#x751F;</span>
        {
            match[j] = x;<span class="hljs-comment">//&#x4EE5;&#x8FD9;&#x4F4D;&#x5973;&#x751F;&#x5EFA;&#x7ACB;&#x5173;&#x7CFB;</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//&#x6210;&#x529F;&#x5339;&#x914D;&#xFF0C;&#x8FD4;&#x56DE;true</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD4;&#x56DE;false</span>
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n1 &gt;&gt; n2 &gt;&gt; m;
    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);
    <span class="hljs-keyword">while</span> (m--) {
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);
        add(x, y);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n1; i++) {
        <span class="hljs-built_in">memset</span>(bj, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> bj);<span class="hljs-comment">//&#x6BCF;&#x4E00;&#x6B21;&#x5339;&#x914D;&#x90FD;&#x8981;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E0B;</span>
        <span class="hljs-keyword">if</span> (find(i) == <span class="hljs-literal">true</span>) ans++;<span class="hljs-comment">//&#x6210;&#x529F;&#x5339;&#x914D;&#x7B54;&#x6848;&#x5C31;&#x52A0;1</span>
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; ans;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x4E8C;&#x5206;&#x56FE;&#x4E2D;&#xFF1A;</p>
<p>&#x6700;&#x5C0F;&#x70B9;&#x8986;&#x76D6;&#x5B9A;&#x4E49;&#xFF1A; &#x4E8C;&#x5206;&#x56FE;&#x4E2D;&#xFF0C;&#x9009;&#x51FA;&#x6700;&#x5C11;&#x7684;&#x70B9;&#xFF0C;&#x4F7F;&#x6BCF;&#x4E00;&#x6761;&#x8FB9;&#x7684;&#x4E24;&#x4E2A;&#x7AEF;&#x70B9;&#xFF0C;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x9009;&#x4E2D;&#x3002;</p>
<p>&#x6700;&#x5927;&#x72EC;&#x7ACB;&#x96C6;&#xFF1A;&#x4E8C;&#x5206;&#x56FE;&#x4E2D;&#xFF0C;&#x9009;&#x51FA;&#x6700;&#x591A;&#x7684;&#x70B9;&#xFF0C;&#x4F7F;&#x5F97;&#x9009;&#x51FA;&#x7684;&#x70B9;&#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x8FB9;</p>
<p>&#x6700;&#x5C11;&#x8DEF;&#x5F84;&#x8986;&#x76D6;&#xFF1A;&#x7528;&#x6700;&#x5C11;&#x7684;&#x4E92;&#x4E0D;&#x76F8;&#x4EA4;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x5C06;&#x6240;&#x6709;&#x70B9;&#x90FD;&#x8986;&#x76D6;&#x4F4F;&#x3002;</p>
<p>&#x6700;&#x5C11;&#x8DEF;&#x5F84;&#x91CD;&#x590D;&#x7684;&#x8986;&#x76D6;&#xFF1A;</p>
<h2 id="&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x56DE;&#x8DEF;&#xFF09;">&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF08;&#x56DE;&#x8DEF;&#xFF09;</h2>
<p>&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#xFF1A;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4E00;&#x79CD;&#x8DEF;&#x5F84;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x6240;&#x6709;&#x7684;&#x8FB9;&#x6070;&#x597D;&#x8D70;&#x4E00;&#x6B21;&#xFF1B;</p>
<p>&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#xFF1A;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4E00;&#x79CD;&#x56DE;&#x8DEF;&#xFF0C;&#x662F;&#x6240;&#x6709;&#x8FB9;&#x6070;&#x597D;&#x8D70;&#x4E00;&#x6B21;&#x5E76;&#x4E14;&#x56DE;&#x5230;&#x539F;&#x70B9;</p>
<p>&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#x4E5F;&#x5C31;&#x662F;&#x4E00;&#x7B14;&#x753B;&#x95EE;&#x9898;&#xFF0C;&#x8D77;&#x70B9;&#x7684;&#x5EA6;&#x5FC5;&#x7136;&#x662F;&#x5947;&#x6570;&#xFF0C;&#x7EC8;&#x70B9;&#x7684;&#x5EA6;&#x4E5F;&#x662F;&#x5947;&#x6570;&#xFF0C;&#x5176;&#x4ED6;&#x70B9;&#x7684;&#x5EA6;&#x5FC5;&#x987B;&#x662F;&#x5076;&#x6570;</p>
<p>&#x5B58;&#x5728;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#x548C;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x7684;&#x524D;&#x63D0;&#x662F;&#x6240;&#x6709;&#x8FB9;&#x8054;&#x901A;&#xFF01;&#xFF01;&#xFF01;</p>
<p>&#x65E0;&#x5411;&#x56FE;&#x5B58;&#x5728;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#xFF1A;&#x5EA6;&#x6570;&#x4E3A;&#x5947;&#x6570;&#x7684;&#x70B9;&#x53EA;&#x80FD;&#x4E3A;2&#x4E2A;&#x6216;&#x8005;0&#x4E2A;&#xFF08;&#x8D77;&#x70B9;=&#x7EC8;&#x70B9;&#xFF09;&#xFF1B;</p>
<p>&#x65E0;&#x5411;&#x56FE;&#x5B58;&#x5728;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#xFF1A;&#x5EA6;&#x6570;&#x4E3A;&#x5947;&#x6570;&#x7684;&#x70B9;&#x53EA;&#x80FD;&#x4E3A;0&#x4E2A;&#xFF1B;</p>
<p>&#x6709;&#x5411;&#x56FE;&#x5B58;&#x5728;&#x6B27;&#x62C9;&#x8DEF;&#x5F84;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#xFF1A;&#x8981;&#x4E48;&#x6240;&#x6709;&#x70B9;&#x7684;&#x5165;&#x5EA6;&#x90FD;&#x7B49;&#x4E8E;&#x51FA;&#x5EA6;&#xFF08;&#x8D77;&#x70B9;=&#x7EC8;&#x70B9;&#xFF09;&#xFF1B;&#x8981;&#x4E48;&#x9664;&#x4E86;&#x4E24;&#x4E2A;&#x70B9;&#x5916;&#x5176;&#x4F59;&#x7684;&#x6240;&#x6709;&#x70B9;&#xFF0C;&#x5165;&#x5EA6;&#x7B49;&#x4E8E;&#x51FA;&#x5EA6;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x70B9;&#xFF0C;&#x4E00;&#x4E2A;&#x51FA;&#x5EA6;&#x6BD4;&#x5165;&#x5EA6;&#x591A;1&#xFF08;&#x8D77;&#x70B9;&#xFF09;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5165;&#x5EA6;&#x6BD4;&#x51FA;&#x5EA6;&#x591A;1&#xFF08;&#x7EC8;&#x70B9;&#xFF09;&#xFF1B;</p>
<p>&#x6709;&#x5411;&#x56FE;&#x5B58;&#x5728;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#xFF1A;&#x6240;&#x6709;&#x70B9;&#x7684;&#x5165;&#x5EA6;&#x90FD;&#x7B49;&#x4E8E;&#x51FA;&#x5EA6;&#xFF1B;</p>
<h1 id="&#x6570;&#x8BBA;">&#x6570;&#x8BBA;</h1>
<p>&#x8D28;&#x6570;&#x5B9A;&#x7406;&#xFF1A;1~n&#x4E2D;&#x8D28;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x4E3A;$n/ln(n)$</p>
<p>$1~n$&#x4E2D;&#x80FD;&#x88AB;$x$&#x6574;&#x9664;&#x7684;&#x4E2A;&#x6570;&#x4E3A;$\lfloor$n/x$\rfloor$$&#x4E0B;&#x53D6;&#x6574;</p>
<h2 id="&#x8D28;&#x6570;">&#x8D28;&#x6570;</h2>
<h3 id="&#x8BD5;&#x9664;&#x6CD5;&#x5224;&#x5B9A;&#x8D28;&#x6570;">&#x8BD5;&#x9664;&#x6CD5;&#x5224;&#x5B9A;&#x8D28;&#x6570;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">if</span> (x &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= x / i; i++) {
        <span class="hljs-keyword">if</span> (x % i == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        <span class="hljs-keyword">if</span> (f(x)) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x57C3;&#x6C0F;&#x7B5B;">&#x57C3;&#x6C0F;&#x7B5B;</h3>
<pre><code class="lang-c++"><span class="hljs-keyword">bool</span> st[N];
<span class="hljs-keyword">int</span> primes[N], cnt;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
    st[<span class="hljs-number">0</span>] = st[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span> (!st[i]) {
            primes[cnt++] = i;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + i; j &lt;= n; j += i) st[j] = <span class="hljs-literal">true</span>;
        }
    }
}
</code></pre>
<h3 id="&#x7EBF;&#x6027;&#x7B5B;&#x6CD5;">&#x7EBF;&#x6027;&#x7B5B;&#x6CD5;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> endl <span class="hljs-string">&quot;\n&quot;</span></span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e8</span> + <span class="hljs-number">10</span>, M = N, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> primes[N], cnt;
<span class="hljs-keyword">bool</span> st[N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
    st[<span class="hljs-number">0</span>] = st[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++){
        <span class="hljs-keyword">if</span>(!st[i]) primes[++ cnt] = i;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cnt &amp;&amp; i * primes[j] &lt;= n; j ++){
            st[i * primes[j]] = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span>(i % primes[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> n, q;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; q;
    init(n);
    <span class="hljs-keyword">while</span>(q --){
        <span class="hljs-keyword">int</span> k;
        <span class="hljs-built_in">cin</span> &gt;&gt; k;
        <span class="hljs-built_in">cout</span> &lt;&lt; primes[k] &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x8D28;&#x56E0;&#x6570;&#x548C;&#x7EA6;&#x6570;">&#x8D28;&#x56E0;&#x6570;&#x548C;&#x7EA6;&#x6570;</h2>
<h3 id="&#x8D28;&#x56E0;&#x6570;">&#x8D28;&#x56E0;&#x6570;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n / i; i++) {
        <span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">int</span> s = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>) {
                n = n / i;
                s ++;
            }
            <span class="hljs-built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-built_in">endl</span>;
        }
    }
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) <span class="hljs-built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        f(x);
        <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
    }
}
</code></pre>
<h3 id="&#x7EA6;&#x6570;">&#x7EA6;&#x6570;</h3>
<p>&#x8BD5;&#x9664;&#x6CD5;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; v;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= x / i; i++) {
        <span class="hljs-keyword">if</span> (x % i == <span class="hljs-number">0</span>) {
            v.push_back(i);
            <span class="hljs-keyword">if</span> (i != x / i) v.push_back(x / i);
        }
    }
    sort(v.begin(), v.end());
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> it : v) <span class="hljs-built_in">cout</span> &lt;&lt; it &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        f(x);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x6C42;&#x7EA6;&#x6570;&#x4E2A;&#x6570;</p>
<p>$N=p_1^{\alpha_1}<em>p_1^{\alpha_2}</em>\cdots*p_1^{\alpha_k}$</p>
<p>$cnt=(\alpha_1+1)<em>(\alpha_2+1)</em>\cdots*(\alpha_k+1)$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; mp;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n / i; i++) {
        <span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>) {
            n /= i;
            mp[i]++;
        }
    }
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) mp[n]++;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> T;
    <span class="hljs-built_in">cin</span> &gt;&gt; T;
    <span class="hljs-keyword">while</span> (T--) {
        <span class="hljs-keyword">int</span> n;
        <span class="hljs-built_in">cin</span> &gt;&gt; n;
        solve(n);
    }
    LL sum = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it: mp) {
        sum = sum * (it.second + <span class="hljs-number">1</span>) % mod;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; sum &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x7EA6;&#x6570;&#x4E4B;&#x548C;</p>
<p>$N=p_1^{\alpha_1}<em>p_1^{\alpha_2}</em>\cdots*p_1^{\alpha_k}$</p>
<p>$sum=(p_1^0+p_1^1+\cdots+p_1^{\alpha_1})<em>\cdots</em>(p_2^0+p_2^1+\cdots+p_2^{\alpha_2})<em>\cdots</em>(p_k^0+p_k^1+\cdots +p_k^{\alpha_k}) $</p>
<p>&#x5982;&#x4F55;&#x6C42;&#x51FA;$p_k^0+p_k^1+\cdots +p_k^{\alpha_k}$,&#x5F53;&#x6210;$p$&#x8FDB;&#x5236;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#xFF0C;&#x6BCF;&#x4E00;&#x4F4D;&#x90FD;&#x662F;$1*&#x6743;&#x91CD;$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; mp;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n / i; i++) {
        <span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>) {
            n /= i;
            mp[i]++;
        }
    }
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) mp[n]++;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> T;
    <span class="hljs-built_in">cin</span> &gt;&gt; T;
    <span class="hljs-keyword">while</span> (T--) {
        <span class="hljs-keyword">int</span> n;
        <span class="hljs-built_in">cin</span> &gt;&gt; n;
        solve(n);
    }
    LL sum = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it: mp) {
        LL x = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = it.second; i &gt;= <span class="hljs-number">0</span>; i--)<span class="hljs-comment">//&#x7C7B;&#x4F3C;&#x4E8E;&#x8FDB;&#x5236;&#x8F6C;&#x5316;</span>
        {
            x = (x * it.first + <span class="hljs-number">1</span>) % mod;
        }
        sum = sum * x % mod;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; sum &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6700;&#x5927;&#x516C;&#x7EA6;&#x6570;">&#x6700;&#x5927;&#x516C;&#x7EA6;&#x6570;</h2>
<p>&#x6B27;&#x51E0;&#x91CC;&#x5F97;&#x7B97;&#x6CD5;: $gcd(a,b)=gcd(b,a%b)$</p>
<p>&#x6027;&#x8D28;&#xFF1A;$ d|a$&#xFF0C;$d|b$&#x5219; $d|&#xFF08;a+b&#xFF09;$  d&#x80FD;&#x6574;&#x9664;a,d&#x80FD;&#x6574;&#x9664;b&#xFF0C;&#x5219;d&#x80FD;&#x6574;&#x9664;&#xFF08;a+b&#xFF09;&#x5F88;&#x597D;&#x8BC1;&#x660E;&#xFF0C;&#x76F4;&#x63A5;&#x8BBE;&#x5C31;&#x884C; </p>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>{
    <span class="hljs-keyword">return</span> b ? gcd(b, a % b) : a;
}
</code></pre>
<p>&#x6269;&#x5C55;&#x6B27;&#x51E0;&#x91CC;&#x5F97;&#xFF1A;&#x6C42;$ax+by=gcd(a,b)$&#x7684;&#x4E00;&#x7EC4;&#x89E3;</p>
<p>&#x901A;&#x89E3;$x=x_0-b/d*k$   $k$&#x662F;&#x6574;&#x6570;</p>
<p>&#x200B;       $y=y_0+a/d*k$</p>
<p>x&#x6700;&#x5C0F;&#x975E;&#x8D1F;&#x6570;&#x662F;&#x591A;&#x5C11;&#xFF1F;&#x53E6;$t=b/d$  &#x5219; $x=x_0-t*k$</p>
<p>$x_{min}=(x_0\%t+t)\%t$</p>
<p>&#x5982;&#x4F55;&#x6C42;$ax+by=d$&#x7684;&#x89E3;&#xFF1F;</p>
<p>&#x6709;&#x89E3;&#x7684;&#x5145;&#x5206;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#x662F;$gcd(a,b)|d$</p>
<p>&#x6269;&#x5C55;&#x6B27;&#x51E0;&#x91CC;&#x5F97;&#x6C42;&#x51FA;$ax+by=gcd(a,b)$&#x7684;&#x4E00;&#x7EC4;&#x89E3;&#xFF0C;&#x4E58;&#x4E0A;&#x7CFB;&#x6570;&#x5373;&#x53EF;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span> </span>{
    <span class="hljs-keyword">if</span> (b == <span class="hljs-number">0</span>) {
        x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> a;
    }
    <span class="hljs-keyword">int</span> d = exgcd(b, a % b, y, x);<span class="hljs-comment">//&#x4EA4;&#x6362;&#x4E00;&#x4E0B;&#x987A;&#x5E8F;</span>
    y = y - a / b * x;
    <span class="hljs-keyword">return</span> d;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);
    <span class="hljs-keyword">while</span> (n--) {
        <span class="hljs-keyword">int</span> a, b, x, y;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);
        <span class="hljs-keyword">int</span> d = exgcd(a, b, x, y);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, x, y);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6B27;&#x62C9;&#x51FD;&#x6570;">&#x6B27;&#x62C9;&#x51FD;&#x6570;</h2>
<p>$\phi(n)$&#x4E3A;$1$~$n$&#x76F4;&#x63A5;&#x4E2D;&#x4E0E;$n$&#x4E92;&#x8D28;&#x6570;&#x7684;&#x4E2A;&#x6570;</p>
<pre><code class="lang-c++">

</code></pre>
<h2 id="&#x5FEB;&#x901F;&#x5E42;">&#x5FEB;&#x901F;&#x5E42;</h2>
<p>&#x5FEB;&#x901F;&#x5E42;&#x6C42;&#x9006;&#x5143;&#xFF0C;&#x8981;&#x6C42;&#x9006;&#x5143;&#x5B58;&#x5728;&#xFF08;a&#x548C;p&#x4E92;&#x8D28;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;p&#x662F;&#x8D28;&#x6570;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-function">LL <span class="hljs-title">qpow</span><span class="hljs-params">(LL a, LL b, LL p)</span> </span>{
    LL ans = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (b) {
        <span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>) ans = ans * a % p;
        b &gt;&gt;= <span class="hljs-number">1</span>;
        a = a * a % p;<span class="hljs-comment">//&#x8FD9;&#x91CC;&#x522B;&#x5FD8;&#x4E86;mod</span>
    }
    <span class="hljs-keyword">return</span> ans;
}
</code></pre>
<p>&#x77E9;&#x9635;&#x5FEB;&#x901F;&#x5E42;</p>
<pre><code class="lang-c++">#include &lt;bits/stdc++.h&gt;
#define CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)
#define endl &quot;\n&quot;
typedef long long LL;
const int N = 1e5 + 10, M = N, mod = 1e9 + 7;
using namespace std;
struct Mat{
    LL a[105][105];
    int r, c;
    Mat(int _r, int _c){
        r = _r, c = _c;
        memset(a, 0, sizeof a);
    }
    //&#x5355;&#x4F4D;&#x77E9;&#x9635;
    void unit(){
        memset(a, 0, sizeof a);
        for(int i = 1; i &lt;= r; i ++){
            a[i][i] = 1;
        }
    }
    Mat operator+(const Mat t) const{
        Mat ans = *this;
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                ans.a[i][j] += t.a[i][j];
            }
        }
        return ans;
    }
    Mat operator-(const Mat t) const{
        Mat ans = *this;
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                ans.a[i][j] -= t.a[i][j];
            }
        }
        return ans;
    }
    Mat operator*(const Mat t) const{
        Mat ans(r, t.c);
        int n = r, m = t.c;
        for(int i = 1; i &lt;= n; i ++){
            for(int j = 1; j &lt;= m; j ++){
                for(int k = 1; k &lt;= c; k ++){
                    ans.a[i][j] += a[i][k] * t.a[k][j];
                    ans.a[i][j] %= mod;
                }
            }
        }
        return ans;
    }
    Mat pow(LL b){
        Mat ans(r, c), _a = *this;
        ans.unit();
        while(b){
            if(b &amp; 1) ans = ans * _a;
            _a = _a * _a;
            b &gt;&gt;= 1;
        }
        return ans;
    }
    void output(){
        for(int i = 1; i &lt;= r; i ++){
            for(int j = 1; j &lt;= c; j ++){
                cout &lt;&lt; a[i][j] &lt;&lt; &quot; &quot;;
            }
            cout &lt;&lt; endl;
        }
    }
};
int main()
{
    LL n;
    cin &gt;&gt; n;
    Mat a(2, 2), temp(1, 2);
    temp.a[1][1] = temp.a[1][2] = 1,
    a.a[1][1] = 0, a.a[1][2] = a.a[2][1] = a.a[2][2] = 1;
    Mat ans = temp * a.pow(n - 2);
    cout &lt;&lt; ans.a[1][2];
    return 0;
}
</code></pre>
<h2 id="&#x9F9F;&#x901F;&#x4E58;">&#x9F9F;&#x901F;&#x4E58;</h2>
<p>&#x548C;&#x5FEB;&#x901F;&#x5E42;&#x601D;&#x60F3;&#x4E00;&#x6837;&#xFF0C;&#x5FEB;&#x901F;&#x5E42;&#x662F;&#x628A;&#x4E58;&#x6CD5;&#x53D8;&#x6210;&#x4E58;&#x6CD5;&#xFF0C;&#x9F9F;&#x901F;&#x4E58;&#x662F;&#x628A;&#x4E58;&#x6CD5;&#x53D8;&#x6210;&#x52A0;&#x6CD5;&#xFF0C;&#x901F;&#x5EA6;&#x53D8;&#x6162;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x4F1A;&#x7206;long long</p>
<pre><code class="lang-c++"><span class="hljs-function">LL <span class="hljs-title">qadd</span><span class="hljs-params">(LL a, LL b, LL p)</span> </span>{
    LL ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (b) {
        <span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>) ans = (ans + a) % p;
        b &gt;&gt;= <span class="hljs-number">1</span>;
        a = (a + a) % p;
    }
    <span class="hljs-keyword">return</span> ans;
}
</code></pre>
<h2 id="&#x7EC4;&#x5408;&#x6570;">&#x7EC4;&#x5408;&#x6570;</h2>
<p>$C_n^m$ $=$ $n<em>(n-1)</em>(n-2)<em>\cdot\cdot\cdot</em>(n-m+1) \over m<em>(m-1)</em>\cdot\cdot*1$</p>
<p>$C_a^b=$$a!\over b!*(a-b)!$</p>
<p>C[a,b]=C[a-1,b]+C[a-1,b-1];</p>
<p>&#x9884;&#x5904;&#x7406;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#xFF1A;$O(N^2)$</p>
<pre><code class="lang-c++"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">2005</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
<span class="hljs-keyword">int</span> c[N][N];
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) {
            <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span>) c[i][j] = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">else</span> c[i][j] = (c[i - <span class="hljs-number">1</span>][j] + c[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]) % mod;
        }
    }
}
</code></pre>
<p>&#x9884;&#x5904;&#x7406;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(N*log(N))$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> LL N = <span class="hljs-number">1e5</span> + <span class="hljs-number">8</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
LL fact[N], infact[N];
<span class="hljs-function">LL <span class="hljs-title">qmi</span><span class="hljs-params">(LL a, LL k, LL p)</span> </span>{
    LL ans = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (k != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) ans = ans * a % p;
        k = k &gt;&gt; <span class="hljs-number">1</span>;
        a = a * a % p;
    }
    <span class="hljs-keyword">return</span> ans;
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>{
    fact[<span class="hljs-number">0</span>] = infact[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<span class="hljs-comment">//0&#x7684;&#x9636;&#x4E58;&#x4E3A;1&#xFF0C;&#x9664;0&#x7684;&#x9636;&#x4E58;&#x4E5F;&#x4E3A;1</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; N; i++) {
        fact[i] = fact[i - <span class="hljs-number">1</span>] * i % mod;
        infact[i] = infact[i - <span class="hljs-number">1</span>] * qmi(i, mod - <span class="hljs-number">2</span>, mod) % mod;
    }
}
LL n, a, b;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    init();
    <span class="hljs-keyword">while</span> (n--) {
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>, &amp;a, &amp;b);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, fact[a] * infact[b] % mod * infact[a - b] % mod);<span class="hljs-comment">//&#x8981;&#x53CA;&#x65F6;&#x53D6;&#x6A21;</span>
    }
}
</code></pre>
<p>$1&lt;=b&lt;=a&lt;=1e18$</p>
<p>lucas</p>
<pre><code class="lang-c++">#include &lt;bits/stdc++.h&gt;
using namespace std;
typedef long long LL;
int n;
LL qmi(LL a, LL k, LL p) {
    LL ans = 1;
    while (k) {
        if (k &amp; 1) ans = ans * a % p;
        k = k &gt;&gt; 1;
        a = a * a % p;
    }
    return ans;
}
LL p;
LL c(LL a, LL b) {
    if (a &lt; b) return 0;//&#x4F7F;&#x7528;lucas&#x5B9A;&#x7406;&#x6709;&#x53EF;&#x80FD;a&lt;b
    LL ans = 1;
    LL sum = 1;
    for (int i = 1, j = a; i &lt;= b; i++, j--)//&#x5C31;&#x662F;&#x9AD8;&#x4E2D;&#x6C42;&#x7EC4;&#x5408;&#x6570;&#x7684;&#x65B9;&#x6CD5;
    {
        ans = ans * j % p;
        sum = sum * i % p;
    }
    return ans * qmi(sum, p - 2, p) % p;//&#x4E3A;&#x4EC0;&#x4E48;&#x53EF;&#x4EE5;&#x7528;&#x5FEB;&#x901F;&#x5E42;&#x6C42;&#x9006;&#x5143;&#xFF0C;&#x56E0;&#x4E3A;sum&#x548C;p&#x4E00;&#x5B9A;&#x4E92;&#x8D28;&#xFF0C;&#x4E14;p&#x4E3A;&#x8D28;&#x6570;
    //&#x7531;&#x6B64;&#x53EF;&#x89C1;&#xFF0C;p&#x4E3A;&#x7D20;&#x6570;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x4E00;&#x5B9A;&#x5B58;&#x5728;&#x9006;&#x5143;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x4E00;&#x5B9A;&#x4E92;&#x8D28;
}
LL lucas(LL a, LL b) {
    if (a &lt; p &amp;&amp; b &lt; p) {
        return c(a, b);//&#x76F4;&#x63A5;&#x7528;&#x5B9A;&#x4E49;&#x6C42;&#xFF0C;&#x4E5F;&#x662F;&#x9012;&#x5F52;&#x7684;&#x7EC8;&#x70B9;
    }
    return c(a % p, b % p) * lucas(a / p, b / p) % p;//&#x4E00;&#x5B9A;&#x6CE8;&#x610F;&#x8981;&#x7EE7;&#x7EED;&#x9012;&#x5F52;&#xFF0C;&#x56E0;&#x4E3A;a/p&#x53EF;&#x80FD;&#x5F88;&#x5927;
    //a/p&#x8981;&#x662F;&#x5927;&#x4E8E;p&#x7684;&#x8BDD;&#x4F1A;&#x51FA;&#x73B0;&#x5927;&#x9EBB;&#x70E6;&#xFF0C;&#x56E0;&#x4E3A;&#x9636;&#x4E58;&#x8981;mod p
    //a/p=6&#xFF0C;p=2&#x7684;&#x8BDD; a/p%p==0&#xFF0C;&#x9636;&#x4E58;&#x600E;&#x4E48;&#x53EF;&#x80FD;&#x4E3A;0
}
int main() {
    cin &gt;&gt; n;
    while (n--) {
        LL a, b;
        cin &gt;&gt; a &gt;&gt; b &gt;&gt; p;
        cout &lt;&lt; lucas(a, b) &lt;&lt; endl;
    }
}
</code></pre>
<h2 id="&#x5BB9;&#x65A5;&#x539F;&#x7406;">&#x5BB9;&#x65A5;&#x539F;&#x7406;</h2>
<p>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(2^n)$</p>
<p>&#x5206;&#x6790;&#xFF0C;&#x6709;$C_n^1+C_n^3+C_n^2+\cdot\cdot\cdot+C_n^n$&#xFF0C;&#x53EF;&#x4EE5;&#x8865;&#x4E0A;&#x4E00;&#x4E2A;$C_n^0$&#xFF0C;&#x6240;&#x4EE5;&#x6709;$2^n-1$&#x9879;</p>
<p><img src="https://cdn.acwing.com/media/article/image/2020/08/07/42785_24af47f6d8-QQ%E6%B5%8F%E8%A7%88%E5%99%A8%E6%88%AA%E5%9B%BE20200807160444.png" alt="QQ&#x6D4F;&#x89C8;&#x5668;&#x622A;&#x56FE;20200807160444.png"></p>
<pre><code class="lang-c++"><span class="hljs-comment">/*&#x5BB9;&#x65A5;&#x539F;&#x7406;&#x7684;&#x5E94;&#x7528;
&#x80FD;&#x88AB;p1,p2,&#x2026;,pm &#x4E2D;&#x7684;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x6570;&#x6574;&#x9664;&#x7684;&#x6574;&#x6570;&#x6570;&#x91CF;
&#x5C31;&#x662F;p1&#x222A;p2&#x222A;p3---&#x222A;pm&#xFF0C;&#x53EF;&#x4EE5;&#x7531;&#x5BB9;&#x65A5;&#x539F;&#x7406;&#x7B97;&#x51FA;&#xFF1B;
[1,n]&#x4E2D;&#x80FD;&#x88AB;x&#x6574;&#x9664;&#x7684;&#x6570;&#x6709;[n/x]&#x4E2A;&#xFF1B;
&#x5176;&#x4E2D;&#x56E0;&#x4E3A;p&#x662F;&#x7D20;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x65E2;&#x80FD;&#x88AB;p1&#x6574;&#x9664;&#x53C8;&#x80FD;&#x88AB;p2&#x6574;&#x9664;&#x7684;&#x8BDD;&#xFF0C;
&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x88AB;p1*p2&#x6574;&#x9664;&#xFF0C;&#x5982;&#x4F55;&#x679A;&#x4E3E;&#x5462;&#xFF1F;
&#x91C7;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x679A;&#x4E3E;&#x6CD5;&#xFF0C;&#x9700;&#x8981;&#x679A;&#x4E3E;m&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;&#x6240;&#x4EE5;&#x4ECE;1&#x679A;&#x4E3E;&#x5230;pow(2,m-1);&#x4E0D;&#x80FD;&#x662F;&#x4ECE;0&#x5F00;&#x59CB;&#x679A;&#x4E3E;&#xFF0C;&#x56E0;&#x4E3A;
&#x5168;&#x662F;0&#x8868;&#x793A;&#x90FD;&#x6CA1;&#x9009;&#xFF0C;&#x4E0D;&#x7B26;&#x5408;&#x9898;&#x610F;
*/</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">20</span>;
<span class="hljs-keyword">int</span> a[N];
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<span class="hljs-comment">//&#x4ECE;0&#x5F00;&#x59CB;&#x5B58;&#x7684;&#x8BDD;&#x65B9;&#x4FBF;&#x540E;&#x9762;&#x4E8C;&#x8FDB;&#x5236;&#x679A;&#x4E3E;</span>
    {
        <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    }
    LL ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, m) - <span class="hljs-number">1</span>; i++)<span class="hljs-comment">//&#x679A;&#x4E3E;&#x6240;&#x6709;&#x7684;&#x65B9;&#x6848;</span>
    {
        LL sum = <span class="hljs-number">0</span>, t = <span class="hljs-number">1</span>;<span class="hljs-comment">//sum&#x4E3A;&#x5947;&#x6570;&#x7B26;&#x53F7;&#x4E3A;+&#xFF0C;sum&#x4E3A;&#x5076;&#x6570;&#x7B26;&#x53F7;&#x4E3A;-</span>
        <span class="hljs-keyword">int</span> flag = <span class="hljs-number">0</span>;<span class="hljs-comment">//&#x6709;&#x53EF;&#x80FD;&#x679A;&#x4E3E;&#x7684;&#x6570;&#x7684;&#x4E58;&#x79EF;&gt;n,&#x8FD9;&#x6837;&#x4E0D;&#x5408;&#x6CD5;,&#x4F46;&#x662F;&#x6700;&#x7EC8;&#x7B54;&#x6848;&#x662F;&#x5BF9;&#x7684;&#xFF1B;</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j++) {
            <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>) {
                sum++;
                <span class="hljs-keyword">if</span> (t * a[j] &gt; n) {
                    flag = <span class="hljs-number">1</span>;
                    <span class="hljs-keyword">break</span>;
                }
                t = t * a[j];
            }

        }
        <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (sum % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) ans += n / t;
            <span class="hljs-keyword">else</span> ans -= n / t;
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="hljs-built_in">endl</span>;
}
</code></pre>
<h1 id="dp">DP</h1>
<h2 id="&#x80CC;&#x5305;&#x95EE;&#x9898;">&#x80CC;&#x5305;&#x95EE;&#x9898;</h2>
<h3 id="01&#x80CC;&#x5305;">01&#x80CC;&#x5305;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> dp[N][N], v[N], w[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];<span class="hljs-comment">//&#x8F93;&#x5165;&#x7269;&#x54C1;&#x7684;&#x4F53;&#x79EF;&#x548C;&#x4EF7;&#x503C;</span>
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j++){
            <span class="hljs-keyword">if</span>(j &lt; v[i]) dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];<span class="hljs-comment">//&#x80CC;&#x5305;&#x5BB9;&#x91CF;&#x4E0D;&#x591F;&#xFF0C;&#x9009;&#x4E0D;&#x4E86;</span>
            <span class="hljs-keyword">else</span> dp[i][j] = max(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - v[i]] + w[i]);<span class="hljs-comment">//&#x51B3;&#x7B56;&#x9009;&#x8FD8;&#x662F;&#x4E0D;&#x9009;</span>
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; dp[n][m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x7A7A;&#x95F4;&#x4F18;&#x5316;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> dp[N], v[N], w[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= v[i]; j --){<span class="hljs-comment">//&#x4ECE;&#x5927;&#x5230;&#x5C0F;&#x679A;&#x4E3E;&#xFF0C;&#x6CE8;&#x610F;j &gt;= v[i]&#xFF0C;&#x5E76;&#x4E14;&#x662F;j --</span>
            dp[j] = max(dp[j], dp[j - v[i]] + w[i]);
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; dp[m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x6C42;&#x65B9;&#x6848;&#x6570;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CLOSE ios::sync_with_stdio(false);cin.tie(0);cout.tie(0)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">110</span>;
<span class="hljs-keyword">int</span> f[N][<span class="hljs-number">10010</span>];<span class="hljs-comment">//&#x4ECE;&#x524D;i&#x4E2A;&#x91CC;&#x9762;&#x9009;&#xFF0C;&#x6070;&#x597D;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x51FA;&#x6765;j</span>
<span class="hljs-keyword">int</span> a[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> n,m;
    <span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">cin</span>&gt;&gt;a[i];
    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
    {
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;=m;j++)
        {
            <span class="hljs-keyword">if</span>(a[i]&gt;j)  f[i][j]=f[i<span class="hljs-number">-1</span>][j];
            <span class="hljs-keyword">else</span> f[i][j]=f[i<span class="hljs-number">-1</span>][j]+f[i<span class="hljs-number">-1</span>][j-a[i]];
        }
    }
    <span class="hljs-built_in">cout</span>&lt;&lt;f[n][m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x5B8C;&#x5168;&#x80CC;&#x5305;">&#x5B8C;&#x5168;&#x80CC;&#x5305;</h3>
<p>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(n^2)$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> dp[N][N], v[N], w[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];<span class="hljs-comment">//&#x8F93;&#x5165;&#x7269;&#x54C1;&#x7684;&#x4F53;&#x79EF;&#x548C;&#x4EF7;&#x503C;</span>
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j++){
            <span class="hljs-keyword">if</span>(j &lt; v[i]) dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];<span class="hljs-comment">//&#x80CC;&#x5305;&#x5BB9;&#x91CF;&#x4E0D;&#x591F;&#xFF0C;&#x4E00;&#x4E2A;&#x90FD;&#x9009;&#x4E0D;&#x4E86;</span>
            <span class="hljs-keyword">else</span> dp[i][j] = max(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - v[i]] + w[i]);
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; dp[n][m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x4F18;&#x5316;&#x7248;&#x672C;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> dp[N], v[N], w[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++){
        <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = v[i]; j &lt;= m; j ++){<span class="hljs-comment">//&#x6CE8;&#x610F;j&#x4ECE;v[i]&#x5F00;&#x59CB;&#x679A;&#x4E3E;</span>
            dp[j] = max(dp[j], dp[j - v[i]] + w[i]);
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; dp[m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x6C42;&#x65B9;&#x6848;&#x6570;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1005</span>;
<span class="hljs-keyword">int</span> f[<span class="hljs-number">2</span>][N], w[N], v[N], n, m;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j++) {
            <span class="hljs-keyword">if</span> (j &lt; v[i]) f[i &amp; <span class="hljs-number">1</span>][j] = f[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][j];
            <span class="hljs-keyword">else</span> f[i &amp; <span class="hljs-number">1</span>][j] = max(f[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][j], f[i &amp; <span class="hljs-number">1</span>][j - v[i]] + w[i]);
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[n &amp; <span class="hljs-number">1</span>][m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x591A;&#x91CD;&#x80CC;&#x5305;">&#x591A;&#x91CD;&#x80CC;&#x5305;</h3>
<p>&#x66B4;&#x529B;&#x5199;&#x6CD5;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(n^3)$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> v[N], w[N], s[N], f[N][N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) {
        <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; s[i];
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j ++ ){
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= s[i] &amp;&amp; k * v[i] &lt;= j; k ++ ){
                f[i][j] = max(f[i][j], f[i - <span class="hljs-number">1</span>][j - v[i] * k] + w[i] * k);
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[n][m] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x4E8C;&#x8FDB;&#x5236;&#x4F18;&#x5316;&#x5199;&#x6CD5;  &#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(n^2*log(s))$</p>
<p>&#x5EFA;&#x8BAE;&#x6570;&#x7EC4;&#x5F00;$10*n$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">12010</span>, M = <span class="hljs-number">2010</span>;<span class="hljs-comment">//&#x5EFA;&#x8BAE;N = 10 * n</span>
<span class="hljs-keyword">int</span> n, m, cnt;<span class="hljs-comment">//cnt&#x662F;&#x6253;&#x5305;&#x540E;&#x7684;&#x7269;&#x54C1;&#x6570;&#x91CF;</span>
<span class="hljs-keyword">int</span> v[N], w[N], f[M];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-keyword">int</span> a, b, s;
        <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; s;
        <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">while</span> (k &lt;= s){
            cnt ++;
            <span class="hljs-comment">//k&#x4E2A;&#x7269;&#x54C1;&#x8FDB;&#x884C;&#x6253;&#x5305;&#xFF0C;&#x4F53;&#x79EF;&#x662F;k*a, &#x4EF7;&#x503C;&#x662F;k*b</span>
            v[cnt] = a * k;
            w[cnt] = b * k;
            s -= k;
            k *= <span class="hljs-number">2</span>;
        }
        <span class="hljs-comment">//&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x81EA;&#x5DF1;&#x6253;&#x5305;&#x6210;&#x4E00;&#x4EFD;</span>
        <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>){
            cnt ++;
            v[cnt] = a * s;
            w[cnt] = b * s;
        }
    }
    n = cnt;<span class="hljs-comment">//&#x65B0;&#x7269;&#x54C1;&#x7684;&#x6570;&#x91CF;&#x662F;cnt</span>
    <span class="hljs-comment">//&#x8FD9;&#x6837;&#x5C31;&#x505A;01&#x80CC;&#x5305;&#x5C31;&#x884C;</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= v[i]; j -- ){
            f[j] = max(f[j], f[j - v[i]] + w[i]);
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}



<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">2010</span>;
<span class="hljs-keyword">int</span> n, m, f[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i&lt;= n; i ++){
        <span class="hljs-keyword">int</span> a, b, s;
        <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; s;
        <span class="hljs-comment">//&#x5F00;&#x59CB;&#x6253;&#x5305;</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= s; k *= <span class="hljs-number">2</span>){
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = m; j &gt;= k * a; j --){
                f[j] = max(f[j], f[j - k * a] + k * b);
            }
            s -= k;
        }
        <span class="hljs-comment">//&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x81EA;&#x5DF1;&#x6253;&#x5305;&#x6210;&#x4E00;&#x4EFD;</span>
        <span class="hljs-keyword">if</span>(s){
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = m; j &gt;= s * a; j --){
                f[j] = max(f[j], f[j - s * a] + s * b);
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x5206;&#x7EC4;&#x80CC;&#x5305;">&#x5206;&#x7EC4;&#x80CC;&#x5305;</h3>
<p>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;$O(n^3)$</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> v[N][N], w[N][N], s[N];
<span class="hljs-keyword">int</span> f[N][N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-built_in">cin</span> &gt;&gt; s[i];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; s[i]; j ++ ){
            <span class="hljs-built_in">cin</span> &gt;&gt; v[i][j] &gt;&gt; w[i][j];
        }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= <span class="hljs-number">0</span>; j -- ){
            f[i][j] = f[i - <span class="hljs-number">1</span>][j];<span class="hljs-comment">//&#x7B2C;i&#x7EC4;&#x4E00;&#x4E2A;&#x90FD;&#x4E0D;&#x9009;</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; s[i]; k ++ ){
                <span class="hljs-keyword">if</span> (v[i][k] &lt;= j){
                    f[i][j] = max(f[i][j], f[i - <span class="hljs-number">1</span>][j - v[i][k]] + w[i][k]);
                }
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[n][m] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x4F18;&#x5316;&#x7A7A;&#x95F4;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> v[N][N], w[N][N], s[N];
<span class="hljs-keyword">int</span> f[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-built_in">cin</span> &gt;&gt; s[i];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; s[i]; j ++ ){
            <span class="hljs-built_in">cin</span> &gt;&gt; v[i][j] &gt;&gt; w[i][j];
        }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= <span class="hljs-number">0</span>; j -- ){
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; s[i]; k ++ ){
                <span class="hljs-keyword">if</span> (v[i][k] &lt;= j){
                    f[j] = max(f[j], f[j - v[i][k]] + w[i][k]);
                }
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x6DF7;&#x5408;&#x80CC;&#x5305;">&#x6DF7;&#x5408;&#x80CC;&#x5305;</h3>
<p>&#x6DF7;&#x5408;&#x80CC;&#x5305;&#x5C31;&#x662F;&#x5C06;&#x524D;&#x9762;&#x4E09;&#x79CD;&#x7684;&#x80CC;&#x5305;&#x95EE;&#x9898;&#x6DF7;&#x5408;&#x8D77;&#x6765;&#xFF0C;&#x6709;&#x7684;&#x53EA;&#x80FD;&#x53D6;&#x4E00;&#x6B21;&#xFF0C;&#x6709;&#x7684;&#x80FD;&#x53D6;&#x65E0;&#x9650;&#x6B21;&#xFF0C;&#x6709;&#x7684;&#x53EA;&#x80FD;&#x53D6;$k$&#x6B21;&#x3002;</p>
<p>&#x5148;&#x5C06;01&#x80CC;&#x5305;&#x548C;&#x5B8C;&#x5168;&#x80CC;&#x5305;&#x8F6C;&#x5316;&#x6210;&#x591A;&#x91CD;&#x80CC;&#x5305;&#x3002;</p>
<ul>
<li>01&#x80CC;&#x5305;&#xFF0C;&#x7269;&#x54C1;&#x6570;&#x91CF;&#x4E3A;1&#x7684;&#x591A;&#x91CD;&#x80CC;&#x5305;&#xFF0C;</li>
<li>&#x5B8C;&#x5168;&#x80CC;&#x5305;&#xFF0C;&#x7269;&#x54C1;&#x6570;&#x91CF;&#x4E3A;$V_{&#x80CC;&#x5305;&#x4F53;&#x79EF;}/v_i$&#x7684;&#x591A;&#x91CD;&#x80CC;&#x5305;&#xFF0C;&#x867D;&#x7136;&#x7269;&#x54C1;&#x6570;&#x91CF;&#x662F;&#x65E0;&#x9650;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x80CC;&#x5305;&#x5BB9;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;&#x3002;</li>
</ul>
<p>&#x518D;&#x6309;&#x7167;&#x591A;&#x91CD;&#x80CC;&#x5305;&#x6765;&#x505A;&#x5373;&#x53EF;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1005</span> * <span class="hljs-number">20</span>;
<span class="hljs-keyword">int</span> f[N], w[N], v[N], n, m;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++)
    {
        <span class="hljs-keyword">int</span> a, b, s;
        <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; s;
        <span class="hljs-keyword">if</span> (s == <span class="hljs-number">0</span>) s = m / a;<span class="hljs-comment">//&#x5982;&#x679C;&#x662F;&#x5B8C;&#x5168;&#x80CC;&#x5305;&#xFF0C;&#x5219;&#x770B;&#x6210;&#x591A;&#x91CD;&#x80CC;&#x5305;&#x505A;</span>
        <span class="hljs-keyword">if</span> (s == <span class="hljs-number">-1</span>)<span class="hljs-comment">//01&#x80CC;&#x5305;</span>
        {
            cnt ++;
            v[cnt] = a, w[cnt] = b;
        }
        <span class="hljs-keyword">else</span><span class="hljs-comment">//&#x591A;&#x91CD;&#x80CC;&#x5305;&#x4E8C;&#x8FDB;&#x5236;&#x62C6;&#x5206;</span>
        {
            <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">while</span> (k &lt;= s)
            {
                cnt ++;
                v[cnt] = k * a;
                w[cnt] = k * b;
                s -= k;
                k *= <span class="hljs-number">2</span>;
            }
            <span class="hljs-keyword">if</span> (s)
            {
                cnt ++;
                v[cnt] = s * a;
                w[cnt] = s * b;
            }
        }
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt; i ++)
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= v[i]; j --)
            f[j] = max(f[j], f[j - v[i]] + w[i]);

    <span class="hljs-built_in">cout</span> &lt;&lt; f[m];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x601D;&#x8DEF;&#x548C;&#x4EE3;&#x7801;2</p>
<p>01&#x80CC;&#x5305;&#x5F53;&#x6210;&#x6570;&#x91CF;&#x4E3A;1&#x7684;&#x591A;&#x91CD;&#x80CC;&#x5305;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x4E8C;&#x8FDB;&#x5236;&#x4F18;&#x5316;&#x3002;</p>
<p>&#x5B8C;&#x5168;&#x80CC;&#x5305;&#x7684;&#x6C42;&#x6CD5;&#x4E0E;01&#x80CC;&#x5305;&#x4E0D;&#x540C;&#xFF0C;&#x6240;&#x4EE5;&#x5355;&#x72EC;&#x7B97;&#x5B8C;&#x5168;&#x80CC;&#x5305;&#x90E8;&#x5206;&#x3002;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;
<span class="hljs-keyword">int</span> n, m;
<span class="hljs-keyword">int</span> f[N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; m;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++)
    {
        <span class="hljs-keyword">int</span> v, w, s;
        <span class="hljs-built_in">cin</span> &gt;&gt; v &gt;&gt; w &gt;&gt; s;
        <span class="hljs-keyword">if</span> (!s)<span class="hljs-comment">//&#x5B8C;&#x5168;&#x80CC;&#x5305;</span>
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = v; j &lt;= m; j ++)
                f[j] = max(f[j], f[j - v] + w);
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-keyword">if</span> (s == <span class="hljs-number">-1</span>) s = <span class="hljs-number">1</span>;<span class="hljs-comment">//01&#x80CC;&#x5305;&#x5F53;&#x6210;&#x6570;&#x91CF;&#x4E3A;1&#x7684;&#x591A;&#x91CD;&#x80CC;&#x5305;</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= s; k *= <span class="hljs-number">2</span>)
            {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= k * v; j --)
                    f[j] = max(f[j], f[j - k * v] + k * w);
                s -= k;
            }
            <span class="hljs-keyword">if</span> (s)
            {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= s * v; j --)
                    f[j] = max(f[j], f[j - s * v] + s * w);
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="&#x4E8C;&#x7EF4;&#x8D39;&#x7528;&#x80CC;&#x5305;">&#x4E8C;&#x7EF4;&#x8D39;&#x7528;&#x80CC;&#x5305;</h3>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>, K = <span class="hljs-number">110</span>;
<span class="hljs-keyword">int</span> n, V, M;
<span class="hljs-keyword">int</span> v[N], m[N], w[N];
<span class="hljs-keyword">int</span> f[K][K];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; V &gt;&gt; M;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++ i)
        <span class="hljs-built_in">cin</span> &gt;&gt; v[i] &gt;&gt; m[i] &gt;&gt; w[i];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++ i)
    {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = V; j &gt;= v[i]; -- j)
        {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = M; k &gt;= m[i]; -- k)
            {
                f[j][k] = max(f[j][k], f[j - v[i]][k - m[i]] + w[i]);
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[V][M] &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x533A;&#x95F4;dp">&#x533A;&#x95F4;dp</h2>
<p>&#x6309;&#x7167;&#x533A;&#x95F4;&#x957F;&#x5EA6;&#x9012;&#x589E;&#x679A;&#x4E3E;&#xFF0C;&#x624D;&#x53EF;&#x4EE5;dp</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">505</span>;
<span class="hljs-keyword">int</span> s[N], f[N][N];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        s[i] = s[i - <span class="hljs-number">1</span>] + x;
    }
    <span class="hljs-comment">//&#x957F;&#x5EA6;&#x4E3A;1&#x90FD;&#x662F;0</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> len = <span class="hljs-number">2</span>; len &lt;= n; len++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + len - <span class="hljs-number">1</span> &lt;= n; i++)<span class="hljs-comment">//&#x679A;&#x4E3E;&#x5DE6;&#x7AEF;&#x70B9;</span>
        {
            <span class="hljs-keyword">int</span> l = i, r = i + len - <span class="hljs-number">1</span>;
            f[l][r] = <span class="hljs-number">0x3f3f3f3f</span>;<span class="hljs-comment">//&#x521D;&#x59CB;&#x5316;</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = l; k &lt; r; k++)<span class="hljs-comment">//&#x5206;&#x5272;&#x7EBF;</span>
            {
                f[l][r] = min(f[l][r], f[l][k] + f[k + <span class="hljs-number">1</span>][r] + s[r] - s[l - <span class="hljs-number">1</span>]);
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[<span class="hljs-number">1</span>][n];
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x6570;&#x4F4D;dp">&#x6570;&#x4F4D;dp</h2>
<p><a href="https://www.acwing.com/blog/content/7944/" target="_blank">&#x6570;&#x4F4D;DP&#x7B14;&#x8BB0;(DFS&#x505A;&#x6CD5;) - AcWing</a></p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e6</span>;
<span class="hljs-keyword">int</span> a[<span class="hljs-number">30</span>];
<span class="hljs-keyword">int</span> f[<span class="hljs-number">30</span>][<span class="hljs-number">15</span>];
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pos, <span class="hljs-keyword">int</span> pre, <span class="hljs-keyword">int</span> limit, <span class="hljs-keyword">int</span> lead)</span> </span>{
    <span class="hljs-keyword">if</span> (!pos) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//&#x9012;&#x5F52;&#x7EC8;&#x70B9;</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!limit &amp;&amp; !lead &amp;&amp; f[pos][pre] != <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> f[pos][pre];<span class="hljs-comment">//&#x8BB0;&#x5FC6;&#x5316;&#xFF0C;&#x53EA;&#x6709;&#x65E0;&#x9650;&#x5236;&#x3001;&#x65E0;&#x524D;&#x5BFC;&#x96F6;&#x624D;&#x7B97;&#xFF0C;&#x4E0D;&#x7136;&#x90FD;&#x662F;&#x672A;&#x641C;&#x7D22;&#x5B8C;&#x7684;&#x60C5;&#x51B5;&#x3002;</span>
    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>, up = limit ? a[pos] : <span class="hljs-number">9</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= up; i++) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(i - pre) &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (lead &amp;&amp; !i) res += dfs(pos - <span class="hljs-number">1</span>, <span class="hljs-number">-5</span>, limit &amp;&amp; i == up, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">else</span> res += dfs(pos - <span class="hljs-number">1</span>, i, limit &amp;&amp; i == up, <span class="hljs-number">0</span>);
    }
    <span class="hljs-keyword">if</span> (!limit &amp;&amp; !lead) f[pos][pre] = res;
    <span class="hljs-keyword">return</span> res;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">calc</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> f);
    <span class="hljs-keyword">int</span> len = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (x) {
        a[++len] = x % <span class="hljs-number">10</span>;
        x /= <span class="hljs-number">10</span>;
    }
    <span class="hljs-keyword">return</span> dfs(len, <span class="hljs-number">-5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> a, b;
    <span class="hljs-built_in">cin</span> &gt;&gt; a &gt;&gt; b;
    <span class="hljs-built_in">cout</span> &lt;&lt; calc(b) - calc(a - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="&#x72B6;&#x6001;&#x538B;&#x7F29;dp">&#x72B6;&#x6001;&#x538B;&#x7F29;DP</h2>
<p>&#x4E00;&#x822C;&#x8981;&#x7528;long long</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; PII;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">12</span>;
ll n, s, k, f[N][<span class="hljs-number">105</span>][<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">10</span>];<span class="hljs-comment">//&#x7B2C;&#x4E00;&#x5C42;&#x4E3A;&#x679A;&#x4E3E;&#x5230;&#x4E86;&#x7B2C;i&#x5C42;&#xFF0C;&#x7B2C;&#x4E8C;&#x5C42;&#x4E3A;&#x6070;&#x597D;&#x62DC;&#x8BBF;&#x56FD;&#x738B;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x7B2C;&#x4E09;&#x5C42;&#x4E3A;&#x5F53;&#x524D;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x6700;&#x574F;&#x6709;pow(2,10)</span>
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; state;<span class="hljs-comment">//&#x5408;&#x6CD5;&#x7684;&#x72B6;&#x6001;</span>
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; h[<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">10</span>];<span class="hljs-comment">//&#x5F53;&#x524D;&#x72B6;&#x6001;&#x53EF;&#x4EE5;&#x8F6C;&#x79FB;&#x5230;&#x54EA;&#x4E9B;&#x72B6;&#x6001;</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        <span class="hljs-keyword">if</span> ((x &gt;&gt; i) &amp; <span class="hljs-number">1</span> &amp;&amp; (x &gt;&gt; (i + <span class="hljs-number">1</span>)) &amp; <span class="hljs-number">1</span>)<span class="hljs-comment">//&#x76F8;&#x90BB;&#x7684;1</span>
        {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">count</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) res += (x &gt;&gt; i) &amp; <span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> res;
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">cin</span> &gt;&gt; n &gt;&gt; k;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-number">1</span> &lt;&lt; n); i++) {
        <span class="hljs-keyword">if</span> (check(i)) state.push_back(i);
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; state.size(); i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; state.size(); j++) {
            <span class="hljs-keyword">if</span> ((state[i] &amp; state[j]) == <span class="hljs-number">0</span> &amp;&amp; check(state[i] | state[j])) {
                h[i].push_back(j);
            }
        }
    }
    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n + <span class="hljs-number">1</span>; i++)<span class="hljs-comment">//&#x4E3A;&#x4EC0;&#x4E48;&#x679A;&#x4E3E;&#x5230;n+1&#x5462;&#xFF0C;&#x6700;&#x540E;&#x7B97;&#x7B54;&#x6848;&#x7684;&#x65F6;&#x5019;&#x8981;&#x679A;&#x4E3E;&#x72B6;&#x6001;</span>
    {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= k; j++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> a = <span class="hljs-number">0</span>; a &lt; state.size(); a++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> b: h[a]) {
                    <span class="hljs-keyword">int</span> cnt = count(state[b]);
                    <span class="hljs-keyword">if</span> (cnt &gt; j) f[i][j][b] = f[i - <span class="hljs-number">1</span>][j][b];<span class="hljs-comment">//&#x7C7B;&#x4F3C;&#x4E8E;01&#x80CC;&#x5305;&#xFF0C;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x9009;&#x4E0D;&#x9009;</span>
                    <span class="hljs-keyword">else</span> f[i][j][b] += f[i - <span class="hljs-number">1</span>][j - cnt][a];
                }
            }
        }
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; f[n + <span class="hljs-number">1</span>][k][<span class="hljs-number">0</span>];<span class="hljs-comment">//n+1&#x884C;&#xFF0C;&#x6700;&#x591A;&#x662F;k&#x4E2A;&#xFF0C;&#x7B2C;n+1&#x884C;&#x4E00;&#x4E2A;&#x90FD;&#x4E0D;&#x9009;&#x5C31;&#x662F;&#x6700;&#x7EC8;&#x7684;&#x7B54;&#x6848;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h1 id="&#x535A;&#x5F08;&#x8BBA;">&#x535A;&#x5F08;&#x8BBA;</h1>
<p>&#x5148;&#x624B;&#x5FC5;&#x80DC;&#x72B6;&#x6001;&#xFF1A;&#x5B58;&#x5728;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x8BA9;&#x5BF9;&#x624B;&#x53D8;&#x6210;&#x5148;&#x624B;&#x5FC5;&#x8D25;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x5148;&#x624B;&#x5FC5;&#x8D25;&#x72B6;&#x6001;&#xFF1A;&#x65E0;&#x8BBA;&#x91C7;&#x53D6;&#x54EA;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x7559;&#x7ED9;&#x5BF9;&#x624B;&#x7684;&#x90FD;&#x662F;&#x5148;&#x624B;&#x5FC5;&#x80DC;&#x72B6;&#x6001;&#x3002;</p>
<h2 id="nim&#x6E38;&#x620F;">Nim&#x6E38;&#x620F;</h2>
<p>&#x5148;&#x624B;&#x5FC5;&#x80DC;&#xFF1A;$a_1\bigoplus a_2 \bigoplus \cdots  \bigoplus a_n \neq 0$</p>
<p>&#x5148;&#x624B;&#x5FC5;&#x8D25;&#xFF1A;$a_1\bigoplus a_2 \bigoplus \cdots  \bigoplus a_n=0$</p>
<p>&#x8BC1;&#x660E;&#xFF1A;<a href="https://www.acwing.com/solution/content/14269/" target="_blank">https://www.acwing.com/solution/content/14269/</a></p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> n;
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        ans = ans ^ x;
    }
    <span class="hljs-keyword">if</span> (ans) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span>;
}
</code></pre>
<h2 id="&#x53F0;&#x9636;-nim&#x6E38;&#x620F;">&#x53F0;&#x9636;-Nim&#x6E38;&#x620F;</h2>
<p>&#x5148;&#x624B;&#x5FC5;&#x80DC;&#xFF1A;$a<em>1\bigoplus a_3 \bigoplus \cdots  \bigoplus a</em>{2n+1} \neq 0$</p>
<p>&#x5148;&#x624B;&#x5FC5;&#x8D25;&#xFF1A;$a<em>2\bigoplus a_4 \bigoplus \cdots  \bigoplus a</em>{2n}=0$</p>
<p>&#x8BC1;&#x660E;&#xFF1A;&#x548C;NIm&#x6E38;&#x620F;&#x7C7B;&#x4F3C;&#xFF0C;&#x82E5;&#x5947;&#x6570;&#x53F0;&#x9636;&#x5F02;&#x6216;&#x4E0D;&#x4E3A;0&#xFF0C;&#x6211;&#x4E00;&#x5B9A;&#x53EF;&#x4EE5;&#x64CD;&#x4F5C;&#x8BA9;&#x5947;&#x6570;&#x53F0;&#x9636;&#x5F02;&#x6216;&#x53D8;&#x4E3A;0&#xFF0C;&#x4E4B;&#x540E;&#x82E5;&#x5BF9;&#x624B;&#x62FF;&#x5947;&#x6570;&#x53F0;&#x9636;&#xFF0C;&#x5462;&#x4E48;&#x7559;&#x7ED9;&#x6211;&#x7684;&#x5FC5;&#x7136;&#x662F;&#x5F02;&#x6216;&#x4E0D;&#x4E3A;0&#xFF0C;&#x82E5;&#x5BF9;&#x624B;&#x62FF;&#x5076;&#x6570;&#x53F0;&#x9636;&#xFF0C;&#x6211;&#x628A;&#x4ED6;&#x5F80;&#x4E0B;&#x62FF;&#x7684;&#xFF0C;&#x5728;&#x5F80;&#x4E0B;&#x62FF;&#xFF0C;&#x8FD9;&#x6837;&#x5C40;&#x9762;&#x4E0D;&#x6539;&#x53D8;&#x3002;&#x4E00;&#x76F4;&#x8FDB;&#x884C;&#x4E0B;&#x53BB;&#xFF0C;&#x5FC5;&#x7136;&#x662F;&#x5BF9;&#x624B;&#x5148;&#x9047;&#x5230;&#x5947;&#x6570;&#x53F0;&#x9636;&#x4E3A;0&#xFF0C;&#x4E4B;&#x540E;&#x5BF9;&#x624B;&#x600E;&#x4E48;&#x62FF;&#x77F3;&#x5B50;&#x4E0B;&#x53BB;&#xFF0C;&#x6211;&#x628A;&#x4ED6;&#x7684;&#x77F3;&#x5B50;&#x5F80;&#x4E0B;&#x62FF;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x5FC5;&#x80DC;&#x3002;</p>
<h2 id="sg&#x51FD;&#x6570;">SG&#x51FD;&#x6570;</h2>
<p>$mex$&#x8FD0;&#x7B97;&#xFF1A;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x91CC;&#x9762;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6700;&#x5C0F;&#x7684;&#x81EA;&#x7136;&#x6570;&#xFF0C;&#x6BD4;&#x5982;$mex{1,2,3}=0$</p>
<p>$sg(x)=k$,&#x5219;&#x7531;&#x5B9A;&#x4E49;&#x5730;$x$&#x53EF;&#x4EE5;&#x8D70;&#x5230;&#x7684;&#x70B9;&#x7684;$sg$&#x4E00;&#x5B9A;&#x5305;&#x542B;$[0,k-1]$&#x91CC;&#x9762;&#x7684;&#x4EFB;&#x4F55;&#x6570;</p>
<p>$sg$&#x51FD;&#x6570;&#x6027;&#x8D28;&#xFF1A;&#x591A;&#x4E2A;&#x72EC;&#x7ACB;&#x5C40;&#x9762;&#x7684;$sg$&#x503C;&#xFF0C;&#x7B49;&#x4E8E;&#x8FD9;&#x4E9B;&#x5C40;&#x9762;$sg$&#x503C;&#x7684;&#x5F02;&#x6216;&#x548C;</p>
<p><strong>$sg=0$&#x662F;&#x5148;&#x624B;&#x5FC5;&#x8D25;&#x72B6;&#x6001;</strong>&#xFF0C;&#x5B83;&#x53EA;&#x80FD;&#x8D70;&#x4E0B;$sg$&#x4E0D;&#x4E3A;0&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p><strong>$sg$&#x4E0D;&#x7B49;&#x4E8E;0&#xFF0C;&#x662F;&#x5148;&#x624B;&#x5FC5;&#x80DC;&#x72B6;&#x6001;</strong>&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x8D70;&#x5411;&#x4E00;&#x4E2A;$sg$&#x4E3A;0&#xFF08;&#x5FC5;&#x8D25;&#x72B6;&#x6001;&#xFF09;</p>
<pre><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> a[<span class="hljs-number">105</span>], f[<span class="hljs-number">10005</span>];
<span class="hljs-keyword">int</span> k, n;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sg</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
    <span class="hljs-keyword">if</span> (~f[x]) <span class="hljs-keyword">return</span> f[x];
    <span class="hljs-built_in">unordered_set</span>&lt;<span class="hljs-keyword">int</span>&gt; s;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i++) {
        <span class="hljs-keyword">if</span> (x - a[i] &gt;= <span class="hljs-number">0</span>) s.insert(sg(x - a[i]));
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;; i++) {
        <span class="hljs-keyword">if</span> (!s.count(i)) <span class="hljs-keyword">return</span> f[x] = i;
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> f);
    <span class="hljs-built_in">cin</span> &gt;&gt; k;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i++) <span class="hljs-built_in">cin</span> &gt;&gt; a[i];
    <span class="hljs-built_in">cin</span> &gt;&gt; n;
    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">int</span> x;
        <span class="hljs-built_in">cin</span> &gt;&gt; x;
        res ^= sg(x);
    }
    <span class="hljs-keyword">if</span> (res) <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;No&quot;</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 面试有关">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="算法题.html" class="navigation navigation-next " aria-label="Next page: 面试算法题">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"算法模板","level":"1.5.1","depth":2,"next":{"title":"面试算法题","level":"1.5.2","depth":2,"path":"Chapter4/算法题.md","ref":"Chapter4/算法题.md","articles":[]},"previous":{"title":"面试有关","level":"1.5","depth":1,"path":"Chapter4/README.md","ref":"Chapter4/README.md","articles":[{"title":"算法模板","level":"1.5.1","depth":2,"path":"Chapter4/算法学习.md","ref":"Chapter4/算法学习.md","articles":[]},{"title":"面试算法题","level":"1.5.2","depth":2,"path":"Chapter4/算法题.md","ref":"Chapter4/算法题.md","articles":[]},{"title":"面试题","level":"1.5.3","depth":2,"path":"Chapter4/面试题.md","ref":"Chapter4/面试题.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"Chapter4/算法学习.md","mtime":"2025-02-22T10:26:10.374Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-02-26T13:15:27.705Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

